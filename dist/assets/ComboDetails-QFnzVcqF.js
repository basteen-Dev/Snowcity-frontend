import{r as Pe,j as e,C as mt,A as ft,h as xt,R as u,u as Te,t as ht,q as gt,k as W,i as re,D as y,z as ie,L as pt,E as yt,F as bt}from"./index-CmreT6x1.js";import{E as Q}from"./ErrorState-BjR9QgSt.js";import{G as He}from"./GalleryViewer-tr_P0bKb.js";import{i as O}from"./media-DcknJ8BL.js";import{f as w}from"./formatters-CmiLqhJj.js";import{g as jt,a as _t,d as Nt,c as Le,b as vt}from"./pricing-Df4qX4St.js";import{X as wt}from"./x-uvzjoDwd.js";import"./createLucideIcon-CgZNF2TE.js";function Mt({items:t=[],className:n=""}){const[c,o]=Pe.useState(!1),[d,x]=Pe.useState(0),m=g=>{x(g),o(!0)},j=()=>{o(!1)};return t.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 ${n}`,children:t.map((g,b)=>{const _=String(g.media_type||"").toLowerCase()==="video",C=_?O(g.media_url||g.url||g):O(g.image_url||g.url||g),N=O(g.thumbnail||g.poster_url||null);return C?e.jsx("div",{className:"group relative overflow-hidden rounded-lg cursor-pointer",onClick:()=>m(b),children:e.jsxs("div",{className:"aspect-square relative",children:[_?e.jsxs(e.Fragment,{children:[e.jsx("video",{className:"w-full h-full object-cover",src:C,poster:N||void 0,muted:!0,preload:"metadata"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-white/90 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-800 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]}):e.jsx("img",{src:C,alt:g.title||"Gallery item",className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-black/50 text-white text-xs flex items-center justify-center font-medium",children:b+1}),g.title&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:e.jsx("div",{className:"text-white text-xs font-medium truncate",children:g.title})})]})},g.gallery_item_id||g.id||b):null})}),c&&e.jsx(He,{items:t,initialIndex:d,onClose:j})]}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:"No gallery items available."})}const be="https://picsum.photos/seed/combo-hero/1920/800",Oe="https://picsum.photos/seed/combo-hero/800/600",kt=be,ze=(t,n=!1)=>n?`https://picsum.photos/seed/${t}/1920/800`:`https://picsum.photos/seed/${t}/640/400`,Yt=t=>y(t).format("YYYY-MM-DD"),Ct=t=>(t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.attraction_id)??null,Re=t=>{if(!t)return"";const[n="0",c="0"]=String(t).split(":"),o=Number(n),d=Number(c);if(!Number.isFinite(o)||!Number.isFinite(d))return"";const x=o>=12?"PM":"AM",m=o%12||12,j=d.toString().padStart(2,"0");return`${m}:${j} ${x}`},Ge=t=>t?String(t).slice(0,5):"",he=t=>{const n=Re(t==null?void 0:t.start_time),c=Re(t==null?void 0:t.end_time);if(n&&c)return`${n} → ${c}`;const o=Ge(t==null?void 0:t.start_time),d=Ge(t==null?void 0:t.end_time);return o&&d?`${o} → ${d}`:""},ge=t=>{if(!t||typeof t!="string")return null;const[n="0",c="0"]=t.split(":"),o=Number(n),d=Number(c);return!Number.isFinite(o)||!Number.isFinite(d)?null:o*60+d},Dt=(t={},n)=>{if(!t.day_type)return!0;const c=y(n).day(),o=String(t.day_type).toLowerCase();return o==="weekday"?c>=1&&c<=5:o==="weekend"?c===0||c===6:o==="custom"&&Array.isArray(t.specific_days)?t.specific_days.map(Number).includes(c):!0},Ve=t=>String(t||"").toLowerCase(),Ke=(t,n)=>t==null||n==null?!1:String(t)===String(n),St=t=>{if(typeof t=="boolean")return t;if(t==null)return!1;if(typeof t=="number")return t!==0;const n=String(t).trim().toLowerCase();return n?["true","1","yes","y"].includes(n)?!0:["false","0","no","n"].includes(n)?!1:!!t:!1},It=(t={},n=null)=>{if(!n)return!(t.slot_id!=null||Array.isArray(t.slot_ids)&&t.slot_ids.length||t.specific_time||t.time_from&&t.time_to);const c=[];if(t.slot_id!=null&&c.push(t.slot_id),Array.isArray(t.slot_ids)&&c.push(...t.slot_ids),t.target_slot_id!=null&&c.push(t.target_slot_id),c.length){const d=[n.slot_id,n.id,n._id,n.combo_slot_id].filter(m=>m!=null);if(!c.some(m=>d.some(j=>Ke(m,j))))return!1}const o=n.start_time||n.time||n.startTime||null;if(t.specific_time&&o&&o.slice(0,5)!==String(t.specific_time).slice(0,5))return!1;if(t.time_from&&t.time_to&&o){const d=ge(o),x=ge(t.time_from),m=ge(t.time_to);if(d==null||x==null||m==null||d<x||d>m)return!1}return!0},At=(t,{targetType:n,targetId:c,date:o,slot:d})=>{if(!t||!n||!c)return!1;const x=y(o).format("YYYY-MM-DD"),m=Ve(t.target_type),j=Ve(n);if(m&&j&&m!==j)return!1;if(!St(t.applies_to_all)){const b=[];if(t.target_id!=null&&b.push(t.target_id),Array.isArray(t.target_ids)&&b.push(...t.target_ids),!b.length||!b.some(_=>Ke(_,c)))return!1}return!(t.specific_date&&x!==t.specific_date||Array.isArray(t.specific_dates)&&t.specific_dates.length&&!t.specific_dates.some(b=>y(b).format("YYYY-MM-DD")===x)||t.date_from&&x<t.date_from||t.date_to&&x>t.date_to||!Dt(t,x)||!It(t,d))},Et=(t={},n=null,c=0)=>{const o=Number(c);if(!o||o<=0)return 0;let d=(n==null?void 0:n.rule_discount_type)||t.discount_type||(t.discount_percent?"percent":null),x=(n==null?void 0:n.rule_discount_value)??t.discount_value??t.discount_percent??0;if(!d||!x)return 0;d=String(d).toLowerCase();let m=d==="amount"?Number(x):Number(x)/100*o;return Number.isFinite(Number(t.max_discount))&&(m=Math.min(m,Number(t.max_discount))),m=Math.min(m,o),Math.max(0,m)},Ft=(t=[],{targetType:n,targetId:c,date:o,slot:d,basePrice:x})=>{if(!Array.isArray(t)||!t.length||!x||!c)return null;let m=null;return t.forEach(j=>{(Array.isArray(j.rules)&&j.rules.length?j.rules:[null]).forEach(b=>{if(b&&!At(b,{targetType:n,targetId:c,date:o,slot:d}))return;const _=Et(j,b,x);if(!_)return;const C=Math.max(0,x-_);(!m||C<m.price)&&(m={offer:j,rule:b,price:C,discount:_})})}),m},pe=(t,n,c)=>{if(!t||typeof t!="object")return{title:n,image_url:ze(c),slug:null,price:0,attraction_id:null};const o=t.title||t.name||n,d=t.desktop_image_url??t.hero_desktop_image??t.hero_image??t.image_media_id??t.media_id??t.cover_media_id??t.banner_media_id??t.url_path??t.image_url??t.cover_image??t.web_image??t.mobile_image??t.image??null,x=O(d,ze(c)),m=t.slug||t.id||t.attraction_id||null,j=Number(t.base_price||t.price||t.amount||0),g=t.attraction_id??t.id??m;return{title:o,image_url:x,slug:m,price:j,attraction_id:g}};function $t(t,n,c,o=!1){if(n!=null&&n.image_url)return n.image_url;const x=(t==null?void 0:t.banner_media_id)??(t==null?void 0:t.image_media_id)??(t==null?void 0:t.cover_media_id)??(t==null?void 0:t.banner_image)??(t==null?void 0:t.hero_image)??(t==null?void 0:t.image_web)??(t==null?void 0:t.image_url)??(t==null?void 0:t.image)??null,m=O(x,o?be:Oe);return m||(n==null?void 0:n.image_url)||(c==null?void 0:c.image_url)||(o?be:Oe)}const ye=(t,n)=>{if(!t)return!1;const c=y().format("YYYY-MM-DD");if(n===c){const o=y(),d=t.start_time||t.time||null;if(!d)return!0;const[x,m]=d.split(":").map(Number),j=(x||0)*60+(m||0),g=o.hour()*60+o.minute();return j>=g+60}return!0},ne=t=>t?String(t.combo_slot_id??t.id??t._id??t.slot_id??`${t.start_time||""}-${t.end_time||""}`):"";function Ht(){var Ee,Fe,$e,Be;const t=mt(),n=(t==null?void 0:t.slug)??(t==null?void 0:t.id)??(t==null?void 0:t.comboId)??(t==null?void 0:t.combo_id)??null,c=ft(),o=xt(),d=u.useMemo(()=>{if(!n||n==="undefined"||n==="null")return null;let s=n;return String(s).startsWith("combo-")&&(s=String(s).substring(6)),s},[n]),{items:x=[],status:m}=Te(s=>s.combos||{items:[],status:"idle"}),{items:j=[],status:g}=Te(s=>s.attractions||{items:[],status:"idle"});u.useEffect(()=>{m==="idle"&&o(ht({active:!0,limit:100})),g==="idle"&&o(gt({active:!0,limit:200}))},[g,m,o]);const b=u.useMemo(()=>{if(!d)return null;const s=Number(d);return Number.isFinite(s)?s:null},[d]),_=u.useMemo(()=>!d||!x.length?null:x.find(s=>String((s==null?void 0:s.combo_id)??(s==null?void 0:s.id)??"")===d)||x.find(s=>d&&(s==null?void 0:s.slug)&&String(s.slug)===d)||null,[x,d]),C=u.useMemo(()=>b??(_!=null&&_.combo_id?Number(_.combo_id):_!=null&&_.id?Number(_.id):null),[_,b]),[N,L]=u.useState({status:"idle",data:null,error:null}),[k,le]=u.useState({status:"idle",items:[],error:null}),[je,oe]=u.useState(null),[_e,X]=u.useState({status:"idle",items:[],error:null}),[Ue,qe]=u.useState(typeof window<"u"?window.innerWidth>=1024:!1);u.useEffect(()=>{if(typeof window>"u")return;const s=()=>qe(window.innerWidth>=1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),u.useEffect(()=>{d?C==null&&(b==null&&(m==="loading"||m==="idle")?L(s=>s.status==="loading"?s:{status:"loading",data:null,error:null}):b==null&&m==="failed"&&L({status:"failed",data:null,error:"Combo not found"})):L({status:"failed",data:null,error:"Combo not found"})},[d,C,b,m]),u.useEffect(()=>{let s=!0;const i=new AbortController;return d?(L({status:"loading",data:null,error:null}),(async()=>{var l;try{const r=b!=null?W.combos.byId(C):W.combos.bySlug(d),f=await re.get(r,{signal:i.signal});if(!s)return;L({status:"succeeded",data:f,error:null}),document.title=(f==null?void 0:f.meta_title)||(f==null?void 0:f.title)||(f==null?void 0:f.name)||"Combo Details"}catch(r){if(r!=null&&r.canceled||!s)return;if((r==null?void 0:r.status)===404||((l=r==null?void 0:r.response)==null?void 0:l.status)===404){c("/404",{replace:!0});return}L({status:"failed",data:null,error:(r==null?void 0:r.message)||"Failed to load combo"})}})()):L({status:"failed",data:null,error:"Combo not found"}),()=>{s=!1,i.abort()}},[d]);const[h,We]=u.useState(y().format("YYYY-MM-DD")),[S,de]=u.useState(1),[z,Qe]=u.useState([]),[Ne,J]=u.useState(!1),[Xe,Je]=u.useState(null),H=u.useMemo(()=>null,[Xe,Ne]),[Z,ce]=u.useState(0),$=u.useCallback(s=>{We(s),K(i=>({...i,selectedKey:""}))},[]),Ze=u.useCallback(()=>{$(y().format("YYYY-MM-DD"))},[$]),et=u.useCallback(()=>{$(y().add(1,"day").format("YYYY-MM-DD"))},[$]);u.useCallback(()=>{$("")},[$]);const tt=u.useCallback(s=>{s.preventDefault(),s.stopPropagation(),Je(s.currentTarget),J(!0)},[]),st=u.useCallback(s=>{$(s),J(!1)},[$]);u.useMemo(()=>{const s=y().format("YYYY-MM-DD"),i=y().add(1,"day").format("YYYY-MM-DD");return l=>!l||l===s||l===i?"All Days":y(l).format("D MMM")},[]);const[I,K]=u.useState({status:"idle",selectedKey:""}),[ve,we]=u.useState(""),Me=u.useCallback(async()=>{var s;if((s=N.data)!=null&&s.combo_id)try{K(f=>({...f,status:"loading"})),we("");const i=await re.get(W.combos.slots(N.data.combo_id),{params:h?{date:h}:{}}),l=Array.isArray(i)?i:Array.isArray(i==null?void 0:i.data)?i.data:[];Qe(l);const r=l.find(f=>ye(f,h))||l[0]||null;K({status:"loaded",selectedKey:r?ne(r):""})}catch(i){we((i==null?void 0:i.message)||"Failed to load slots"),K(l=>({...l,status:"failed",selectedKey:""}))}},[(Ee=N.data)==null?void 0:Ee.combo_id,h]);u.useEffect(()=>{var s;(s=N.data)!=null&&s.combo_id&&h&&Me()},[(Fe=N.data)==null?void 0:Fe.combo_id,h,Me]),u.useEffect(()=>{var i;if(!((i=N.data)!=null&&i.combo_id))return X({status:"idle",items:[],error:null}),()=>{};let s=!1;return X(l=>({...l,status:"loading",error:null})),(async()=>{var l;try{const r=await re.get(W.offers.list(),{params:{active:!0,target_type:"combo",target_id:(l=N.data)==null?void 0:l.combo_id}});if(s)return;const f=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];X({status:"succeeded",items:f,error:null})}catch(r){if(s)return;X({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load offers"})}})(),()=>{s=!0}},[($e=N.data)==null?void 0:$e.combo_id]),u.useEffect(()=>{var i;if(!((i=N.data)!=null&&i.combo_id))return;let s=!1;return le(l=>({...l,status:"loading",error:null})),(async()=>{var l;try{const r=await re.get(W.gallery.list(),{params:{active:!0,target_type:"combo",target_ref_id:N.data.combo_id,limit:12}});if(s)return;const f=((l=r==null?void 0:r.data)==null?void 0:l.data)||(Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[]);le({status:"succeeded",items:f,error:null})}catch(r){if(s)return;le({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load gallery"})}})(),()=>{s=!0}},[(Be=N.data)==null?void 0:Be.combo_id]);const a=N.data||_,ke=u.useMemo(()=>{if(!a)return[];const s=[a.attraction_1||{title:a==null?void 0:a.attraction_1_title,image_url:a==null?void 0:a.attraction_1_image,slug:a==null?void 0:a.attraction_1_slug,base_price:a==null?void 0:a.attraction_1_price,attraction_id:a==null?void 0:a.attraction_1_id},a.attraction_2||{title:a==null?void 0:a.attraction_2_title,image_url:a==null?void 0:a.attraction_2_image,slug:a==null?void 0:a.attraction_2_slug,base_price:a==null?void 0:a.attraction_2_price,attraction_id:a==null?void 0:a.attraction_2_id}];return Array.isArray(s)?s.filter(Boolean):[]},[a]),D=u.useMemo(()=>{if(!a)return[];if(Array.isArray(a==null?void 0:a.attractions)&&a.attractions.length)return a.attractions.map((i,l)=>pe(i,`Experience ${l+1}`,`combo-${l}`));const s=Array.isArray(a==null?void 0:a.attraction_ids)?a.attraction_ids.filter(Boolean):[];return s.length&&j.length?s.map((i,l)=>{const r=j.find(f=>String(Ct(f))===String(i));return pe(r||{title:`Experience ${l+1}`},`combo-${l}`)}).filter(Boolean):ke.map((i,l)=>pe(i,`Experience ${l+1}`,`combo-${l}`)).filter(Boolean)},[a,j,ke]),[at,rt]=[D[0],D[1]],it=N.status==="loading"&&!a,B=(a==null?void 0:a.combo_id)||(a==null?void 0:a.id)||C||null,ee=(a==null?void 0:a.name)||(a==null?void 0:a.title)||"Combo Deal",Ye=(a==null?void 0:a.short_description)||(a==null?void 0:a.subtitle)||"",Ce=(a==null?void 0:a.description)||(a==null?void 0:a.long_description)||"",te=$t(a,at,rt,Ue),M=u.useMemo(()=>{const s=[];return te&&s.push({src:te,alt:"Snow City Banner",isBanner:!0}),k.items.forEach((i,l)=>{const r=i.image_url||i.url||"";r&&s.push({src:r,alt:i.title||`Gallery ${l+1}`,isBanner:!1,item:i,index:l})}),s},[te,k.items]),ue=u.useCallback(()=>{ce(s=>(s+1)%M.length)},[M.length]),nt=u.useCallback(()=>{ce(s=>(s-1+M.length)%M.length)},[M.length]);u.useEffect(()=>{if(M.length<=1)return;const s=setInterval(ue,5e3);return()=>clearInterval(s)},[ue,M.length]);const De=(D.length?D:[{title:ee,image_url:kt}]).slice(0,Math.max(2,Math.min(3,D.length||2))).map(s=>s.title).join(" + "),Se=jt(a),Y=Se>0?Se:Number((a==null?void 0:a.combo_price)||(a==null?void 0:a.total_price)||0),me=_t(a),P=me||D.reduce((s,i)=>s+Number((i==null?void 0:i.price)||0),0),fe=P>0,lt=fe&&Y>0?P-Y:0,se=fe&&Y>0&&Y<P?Math.max(0,Math.round(Nt(a)||(P-Y)/P*100)):Number((a==null?void 0:a.discount_percent)||0),ae=u.useCallback(s=>{const i=Number(Y||0),l=Number(me||P||i),r=Le(s,i),f=vt(s,l),A=r||f||0,F=B?Ft(_e.items,{targetType:"combo",targetId:B,date:h,slot:s,basePrice:A}):null,v=F?F.price:r,T=f>v?f-v:0;return{finalPrice:v,originalPrice:f,savings:T,bestOffer:F}},[Y,me,P,_e.items,B,h]),E=z.find(s=>ne(s)===I.selectedKey)||null,p=E?ae(E):null,Ie=Math.max(1,Number(S)||1),R=(p==null?void 0:p.finalPrice)||0,G=(p==null?void 0:p.originalPrice)||Y||0,U=G>0&&R>0&&R<G,ot=U?Math.round((G-R)/G*100):0,dt=Number(R||0)*Ie,Ae=E&&R?R*Ie:null;if(it)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white",children:e.jsx(ie,{})});if(N.status==="failed")return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(Q,{message:N.error||"Combo not found"})})});if(!a)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(Q,{message:"Combo not found"})})});const xe=(s,i)=>{var v,T,q,V;const l=Math.max(1,Number(S)||1),r=i||ae(s),f=(r==null?void 0:r.finalPrice)??Le(s,Y),A=(s==null?void 0:s.combo_slot_id)??(s==null?void 0:s.id)??(s==null?void 0:s._id)??null;if(!A)return;o(yt({itemType:"combo",comboId:Number(B)||B,combo:a,date:h,booking_date:Yt(h),booking_time:(s==null?void 0:s.start_time)||(s==null?void 0:s.startTime)||(s==null?void 0:s.slot_start_time)||null,comboSlotId:A,slot:s,qty:l,unitPrice:f,title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||(a==null?void 0:a.combo_name)||`Combo #${B}`,slotLabel:he(s),dateLabel:y(h).format("DD MMM YYYY"),meta:{title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||(a==null?void 0:a.combo_name)||`Combo #${B}`,start_time:s==null?void 0:s.start_time,end_time:s==null?void 0:s.end_time,capacity:s==null?void 0:s.capacity,available:s==null?void 0:s.available},offer_id:(T=(v=r==null?void 0:r.bestOffer)==null?void 0:v.offer)==null?void 0:T.offer_id,offer_rule_id:(V=(q=r==null?void 0:r.bestOffer)==null?void 0:q.rule)==null?void 0:V.rule_id})),o(bt(1));const F=new URLSearchParams({type:"combo",combo_id:String(B),date:h,slot:ne(s),qty:String(l)});c(`/booking?${F.toString()}`)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#e0f2fe] via-[#bae6fd] to-white font-sans",children:[e.jsxs("section",{className:"mt-0 bg-transparent",children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-6 space-y-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",style:{fontFamily:"Inter, sans-serif"},children:ee}),e.jsx("div",{className:"overflow-hidden shadow-lg bg-gray-100 relative",children:M.length>0?e.jsxs("div",{className:"relative h-[420px] w-full overflow-hidden",children:[e.jsxs("button",{type:"button",className:"relative w-full h-full group",onClick:()=>{const s=M[Z];s.isBanner?k.items.length>0&&oe(0):oe(s.index)},children:[e.jsx("img",{src:M[Z].src,alt:M[Z].alt,className:"w-full h-full object-cover transition-opacity duration-500 brightness-[0.95]",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-x-0 top-0 h-32 bg-gradient-to-b from-black/50 via-black/10 to-transparent pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:ee})})]}),M.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:nt,className:"absolute left-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors","aria-label":"Previous image",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{type:"button",onClick:ue,className:"absolute right-4 top-1/2 -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white p-2 rounded-full transition-colors","aria-label":"Next image",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),M.length>1&&e.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex space-x-2",children:M.map((s,i)=>e.jsx("button",{type:"button",onClick:()=>ce(i),className:`w-2 h-2 rounded-full transition-colors ${i===Z?"bg-white":"bg-white/50"}`,"aria-label":`Go to image ${i+1}`},i))})]}):e.jsx("div",{className:"h-[420px] w-full bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"No images available"})})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),e.jsx("div",{className:"absolute bottom-6 left-0 right-0 px-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur px-3 py-1 rounded-full text-xs uppercase tracking-wide text-gray-100 mb-2",children:[e.jsx("span",{children:"Combo Deal"}),se>0?e.jsxs("span",{children:["Save ",se,"%"]}):null]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-white drop-shadow",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:ee}),Ye?e.jsx("p",{className:"text-gray-200 text-sm md:text-base max-w-2xl mt-2",style:{fontFamily:"Inter, sans-serif"},children:Ye}):null,!te&&De?e.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-gray-200 mt-3 line-clamp-2",children:De}):null]})})]}),k.items.length>0?e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"Photo Gallery"}),k.status==="loading"?e.jsx("div",{className:"py-8 text-center",children:e.jsx(ie,{})}):k.status==="failed"?e.jsx("div",{className:"py-8 text-center",children:e.jsx(Q,{message:k.error})}):e.jsx(Mt,{items:k.items})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif"},children:"Gallery Preview"}),e.jsx("div",{className:"space-y-3",children:k.items.slice(0,3).map((s,i)=>{const l=String(s.media_type||"").toLowerCase()==="video",r=l?O(s.media_url||s.url||s):O(s.image_url||s.url||s);return e.jsxs("div",{className:"relative group",children:[l?e.jsx("video",{className:"w-full h-32 object-cover rounded-lg",src:r,muted:!0,preload:"metadata"}):e.jsx("img",{src:r,alt:s.title||"Gallery item",className:"w-full h-32 object-cover rounded-lg transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-medium",children:["+",k.items.length-3," more"]})})]},s.gallery_item_id||s.id||i)})})]})})]})}):null,e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8 md:py-12",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10 md:gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[D.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:D.map((s,i)=>e.jsxs("figure",{className:"relative rounded-2xl overflow-hidden shadow-sm bg-white",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-60 md:h-64 object-cover",loading:"lazy"}),e.jsxs("figcaption",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/75 to-transparent p-4 text-white",children:[e.jsxs("p",{className:"text-[11px] uppercase tracking-wide text-gray-300",children:["Experience ",i+1]}),e.jsx("h2",{className:"text-lg font-semibold line-clamp-2",style:{fontFamily:"Inter, sans-serif"},children:s.title}),s.price?e.jsxs("p",{className:"text-xs text-gray-200 mt-1",children:["Base price: ",w(s.price)]}):null]})]},`included-${i}`))}),Ce?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"About this combo"}),e.jsx("div",{className:"prose prose-sm md:prose max-w-none text-gray-700 leading-relaxed",style:{textAlign:"left",fontFamily:"Inter, sans-serif"},dangerouslySetInnerHTML:{__html:Ce}})]}):null,e.jsxs("div",{id:"availability",className:"rounded-2xl border shadow-sm p-4 md:p-5 bg-white",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-3",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"All time slots"}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:e.jsxs("span",{children:[y(h).format("DD MMM YYYY")," • ",S," ticket",S>1?"s":""]})})]}),I.status==="loading"?e.jsx("div",{className:"py-3",children:e.jsx(ie,{size:"sm"})}):null,I.status==="failed"?e.jsx("div",{className:"py-3",children:e.jsx(Q,{message:ve||"Failed to load slots"})}):null,I.status==="loaded"&&e.jsx(e.Fragment,{children:z.length?e.jsx("div",{className:"space-y-2",children:z.filter(s=>ye(s,h)).map(s=>{const i=he(s),l=ae(s),r=l.finalPrice,f=l.originalPrice,A=f>0&&r>=0&&r<f,F=A&&f?Math.max(0,Math.round((f-r)/f*100)):null,v=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0;return e.jsxs("div",{className:`flex items-center justify-between rounded-xl border px-4 py-3 shadow-sm ${v?"opacity-50 bg-gray-100 border-gray-200":"bg-white border-gray-200 hover:border-blue-300 hover:shadow-md transition-all"}`,children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"font-semibold text-base text-gray-900",children:i||"Time slot"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Capacity: ",s.capacity," •"," ",s.available?"Available":"Unavailable"]}),A?e.jsxs("span",{className:"text-sm text-emerald-600 font-medium mt-1",children:[w(r)," ",e.jsx("span",{className:"line-through text-gray-400 ml-1",children:w(f)})]}):e.jsx("span",{className:"text-sm text-gray-700 mt-1",children:w(r)}),A&&e.jsxs("span",{className:"text-[11px] font-semibold text-emerald-600 mt-0.5",children:["Save ",F,"%"]})]}),e.jsx("button",{type:"button",disabled:v,onClick:()=>xe(s,l),className:`px-4 py-2 rounded-full border text-sm font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${v?"opacity-50 cursor-not-allowed bg-gray-100 border-gray-200 text-gray-400":"bg-[#003de6] text-white border-[#003de6] hover:bg-[#002db3]"}`,children:"Book this slot"})]},s.combo_slot_id||`${s.combo_id}-${s.start_time}-${s.end_time}`)})}):e.jsxs("div",{className:"text-sm text-gray-500",children:["No slots available for"," ",y(h).format("DD MMM YYYY"),"."]})})]})]}),e.jsx("aside",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 sticky top-24 space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Combo price"}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:w(Y)}),e.jsx("span",{className:"text-sm text-gray-500",children:"per combo"})]}),fe&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"line-through mr-2",children:w(P)}),se>0?e.jsxs("span",{className:"text-emerald-600 font-medium",children:["Save ",se,"% (",w(lt),")"]}):e.jsxs("span",{children:["Special pricing across"," ",D.length||2," experiences"]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:Ze,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${h===y().format("YYYY-MM-DD")?"bg-[#003de6] text-white border-[#003de6]":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:et,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${h===y().add(1,"day").format("YYYY-MM-DD")?"bg-[#003de6] text-white border-[#003de6]":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:tt,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${h&&h!==""&&h!==y().format("YYYY-MM-DD")&&h!==y().add(1,"day").format("YYYY-MM-DD")?"bg-[#003de6] text-white border-[#003de6]":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:h&&h!==""&&h!==y().format("YYYY-MM-DD")&&h!==y().add(1,"day").format("YYYY-MM-DD")?y(h).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),I.status==="loading"?e.jsx("div",{className:"py-2",children:e.jsx(ie,{size:"sm"})}):I.status==="failed"?e.jsx(Q,{message:ve||"Failed to load slots"}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:I.selectedKey,onChange:s=>K(i=>({...i,selectedKey:s.target.value})),disabled:!z.length,style:{fontFamily:"Inter, sans-serif"},children:z.length?e.jsxs(e.Fragment,{children:[!I.selectedKey&&e.jsx("option",{value:"",children:"Select slot"}),z.filter(s=>ye(s,h)).map(s=>{const i=ne(s),l=ae(s),r=he(s)||"Slot",f=(l==null?void 0:l.finalPrice)!=null?` • ${w(l.finalPrice)}`:"";return e.jsxs("option",{value:i,children:[r,f]},i)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>de(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:S,onChange:s=>de(Math.max(1,Number(s.target.value)||1)),className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>de(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[S," × ",w((p==null?void 0:p.finalPrice)||Y||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:w(((p==null?void 0:p.finalPrice)||Y||0)*S)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-[#003de6] text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-[#002db3] disabled:opacity-60 disabled:cursor-not-allowed",disabled:!E||I.status==="loading",onClick:()=>{E&&xe(E,p)},style:{fontFamily:"Inter, sans-serif"},children:p!=null&&p.finalPrice?`Book Now • ${w(p.finalPrice*S)}`:"Book Now"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:["Includes admission for"," ",D.length||2," attraction(s). Book together to lock in bundled savings."]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:D.map((s,i)=>e.jsx("li",{children:s.title},`sidebar-attr-${i}`))})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("a",{href:"#availability",className:"inline-flex items-center justify-center rounded-full bg-[#003de6] text-white px-6 py-3 text-sm font-medium hover:bg-[#002db3]",children:"View all time slots"}),e.jsx(pt,{to:"/combos",className:"inline-flex items-center justify-center rounded-full border border-blue-100 text-blue-600 px-6 py-3 text-sm font-medium hover:bg-blue-50",children:"Explore other combos"})]})]})})]})}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-[70] border-t border-gray-200 bg-white/95 backdrop-blur",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3 pb-[calc(env(safe-area-inset-bottom)+12px)]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",children:U?"Offer price":"Base price"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 rupee",children:w(U?(p==null?void 0:p.finalPrice)||0:G||(p==null?void 0:p.finalPrice)||0)}),U?e.jsx("div",{className:"text-sm text-gray-400 line-through rupee",children:w(G||0)}):null,U?e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",ot,"%"]}):null]}),e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[S," ticket",S>1?"s":""," • Total"," ",e.jsx("span",{className:"rupee font-semibold text-gray-800",children:w(dt||0)})]})]}),e.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-[#003de6] text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-[#002db3] disabled:opacity-60 disabled:cursor-not-allowed",disabled:!E||I.status==="loading",onClick:()=>{E&&xe(E,p)},children:Ae?e.jsxs(e.Fragment,{children:["Book •"," ",e.jsx("span",{className:"ml-1 rupee",children:w(Ae)})]}):"Book Now"})]})})}),Ne&&e.jsxs("div",{className:"fixed inset-0 z-[80] flex",onClick:()=>J(!1),children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"absolute bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 w-80 max-h-[70vh] overflow-y-auto",style:{top:H?`${H.top}px`:"50%",left:H?`${H.left-160}px`:"50%",transform:H?"none":"translate(-50%, -50%)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Select Date"}),e.jsx("button",{type:"button",onClick:()=>J(!1),className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors",children:e.jsx(wt,{size:18})})]}),e.jsx("div",{className:"space-y-3",children:[0,1,2].map(s=>{const i=y().add(s,"month"),l=i.startOf("month"),r=i.endOf("month"),f=l.day(),A=r.date(),F=y();return e.jsxs("div",{className:"border border-gray-100 rounded-xl p-3 bg-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:i.format("MMMM YYYY")})}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-gray-500 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(v=>e.jsx("div",{className:"py-1 font-medium",children:v},v))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-sm",children:[Array.from({length:f}).map((v,T)=>e.jsx("div",{},`pad-${T}`)),Array.from({length:A}).map((v,T)=>{const q=T+1,V=l.date(q).format("YYYY-MM-DD"),ct=!1,ut=F.format("YYYY-MM-DD")===V;return e.jsx("button",{type:"button",onClick:()=>{st(V)},disabled:ct,className:`w-full h-8 rounded-lg flex items-center justify-center transition-colors ${ut?"bg-sky-100 text-sky-700 font-semibold":"hover:bg-gray-100"}`,children:q},V)})]})]},s)})})]})]}),je!==null&&k.items.length>0?e.jsx(He,{items:k.items,initialIndex:je,onClose:()=>oe(null)}):null]})}export{Ht as default};
