import{r as Ie,j as e,C as lt,B as dt,h as ot,u as Fe,R as m,t as ct,p as ut,i as Z,k as ee,D as j,A as te,L as mt,E as ft,F as xt}from"./index-D_x0VcQ4.js";import{E as q}from"./ErrorState-DHcBIx00.js";import{G as Oe}from"./GalleryViewer-YHF7dM0M.js";import{i as P}from"./media-DZA-bGGk.js";import{f as w}from"./formatters-CmiLqhJj.js";import{g as ht,a as gt,b as pt,d as $e,c as yt}from"./pricing-CIeFTiJd.js";import{X as bt}from"./x-C3wzXSpj.js";import"./createLucideIcon-CDLCmtzs.js";function jt({items:t=[],className:n=""}){const[d,l]=Ie.useState(!1),[o,h]=Ie.useState(0),u=c=>{h(c),l(!0)},g=()=>{l(!1)};return t.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 ${n}`,children:t.map((c,f)=>{const M=String(c.media_type||"").toLowerCase()==="video",N=M?P(c.media_url||c.url||c):P(c.image_url||c.url||c),y=P(c.thumbnail||c.poster_url||null);return N?e.jsx("div",{className:"group relative overflow-hidden rounded-lg cursor-pointer",onClick:()=>u(f),children:e.jsxs("div",{className:"aspect-square relative",children:[M?e.jsxs(e.Fragment,{children:[e.jsx("video",{className:"w-full h-full object-cover",src:N,poster:y||void 0,muted:!0,preload:"metadata"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-white/90 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-gray-800 ml-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})})})]}):e.jsx("img",{src:N,alt:c.title||"Gallery item",className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 rounded-full bg-black/50 text-white text-xs flex items-center justify-center font-medium",children:f+1}),c.title&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:e.jsx("div",{className:"text-white text-xs font-medium truncate",children:c.title})})]})},c.gallery_item_id||c.id||f):null})}),d&&e.jsx(Oe,{items:t,initialIndex:o,onClose:g})]}):e.jsx("div",{className:"py-8 text-center text-gray-500",children:"No gallery items available."})}const fe="https://picsum.photos/seed/combo-hero/1920/800",Te="https://picsum.photos/seed/combo-hero/800/600",_t=fe,Be=(t,n=!1)=>n?`https://picsum.photos/seed/${t}/1920/800`:`https://picsum.photos/seed/${t}/640/400`,Nt=t=>j(t).format("YYYY-MM-DD"),vt=t=>(t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.attraction_id)??null,Pe=t=>{if(!t)return"";const[n="0",d="0"]=String(t).split(":"),l=Number(n),o=Number(d);if(!Number.isFinite(l)||!Number.isFinite(o))return"";const h=l>=12?"PM":"AM",u=l%12||12,g=o.toString().padStart(2,"0");return`${u}:${g} ${h}`},Le=t=>t?String(t).slice(0,5):"",oe=t=>{const n=Pe(t==null?void 0:t.start_time),d=Pe(t==null?void 0:t.end_time);if(n&&d)return`${n} → ${d}`;const l=Le(t==null?void 0:t.start_time),o=Le(t==null?void 0:t.end_time);return l&&o?`${l} → ${o}`:""},ce=t=>{if(!t||typeof t!="string")return null;const[n="0",d="0"]=t.split(":"),l=Number(n),o=Number(d);return!Number.isFinite(l)||!Number.isFinite(o)?null:l*60+o},wt=(t={},n)=>{if(!t.day_type)return!0;const d=j(n).day(),l=String(t.day_type).toLowerCase();return l==="weekday"?d>=1&&d<=5:l==="weekend"?d===0||d===6:l==="custom"&&Array.isArray(t.specific_days)?t.specific_days.map(Number).includes(d):!0},ze=t=>String(t||"").toLowerCase(),Re=(t,n)=>t==null||n==null?!1:String(t)===String(n),Mt=t=>{if(typeof t=="boolean")return t;if(t==null)return!1;if(typeof t=="number")return t!==0;const n=String(t).trim().toLowerCase();return n?["true","1","yes","y"].includes(n)?!0:["false","0","no","n"].includes(n)?!1:!!t:!1},Yt=(t={},n=null)=>{if(!n)return!(t.slot_id!=null||Array.isArray(t.slot_ids)&&t.slot_ids.length||t.specific_time||t.time_from&&t.time_to);const d=[];if(t.slot_id!=null&&d.push(t.slot_id),Array.isArray(t.slot_ids)&&d.push(...t.slot_ids),t.target_slot_id!=null&&d.push(t.target_slot_id),d.length){const o=[n.slot_id,n.id,n._id,n.combo_slot_id].filter(u=>u!=null);if(!d.some(u=>o.some(g=>Re(u,g))))return!1}const l=n.start_time||n.time||n.startTime||null;if(t.specific_time&&l&&l.slice(0,5)!==String(t.specific_time).slice(0,5))return!1;if(t.time_from&&t.time_to&&l){const o=ce(l),h=ce(t.time_from),u=ce(t.time_to);if(o==null||h==null||u==null||o<h||o>u)return!1}return!0},kt=(t,{targetType:n,targetId:d,date:l,slot:o})=>{if(!t||!n||!d)return!1;const h=j(l).format("YYYY-MM-DD"),u=ze(t.target_type),g=ze(n);if(u&&g&&u!==g)return!1;if(!Mt(t.applies_to_all)){const f=[];if(t.target_id!=null&&f.push(t.target_id),Array.isArray(t.target_ids)&&f.push(...t.target_ids),!f.length||!f.some(M=>Re(M,d)))return!1}return!(t.specific_date&&h!==t.specific_date||Array.isArray(t.specific_dates)&&t.specific_dates.length&&!t.specific_dates.some(f=>j(f).format("YYYY-MM-DD")===h)||t.date_from&&h<t.date_from||t.date_to&&h>t.date_to||!wt(t,h)||!Yt(t,o))},Dt=(t={},n=null,d=0)=>{const l=Number(d);if(!l||l<=0)return 0;let o=(n==null?void 0:n.rule_discount_type)||t.discount_type||(t.discount_percent?"percent":null),h=(n==null?void 0:n.rule_discount_value)??t.discount_value??t.discount_percent??0;if(!o||!h)return 0;o=String(o).toLowerCase();let u=o==="amount"?Number(h):Number(h)/100*l;return Number.isFinite(Number(t.max_discount))&&(u=Math.min(u,Number(t.max_discount))),u=Math.min(u,l),Math.max(0,u)},Ct=(t=[],{targetType:n,targetId:d,date:l,slot:o,basePrice:h})=>{if(!Array.isArray(t)||!t.length||!h||!d)return null;let u=null;return t.forEach(g=>{(Array.isArray(g.rules)&&g.rules.length?g.rules:[null]).forEach(f=>{if(f&&!kt(f,{targetType:n,targetId:d,date:l,slot:o}))return;const M=Dt(g,f,h);if(!M)return;const N=Math.max(0,h-M);(!u||N<u.price)&&(u={offer:g,rule:f,price:N,discount:M})})}),u},ue=(t,n,d)=>{if(!t||typeof t!="object")return{title:n,image_url:Be(d),slug:null,price:0,attraction_id:null};const l=t.title||t.name||n,o=t.desktop_image_url??t.hero_desktop_image??t.hero_image??t.image_media_id??t.media_id??t.cover_media_id??t.banner_media_id??t.url_path??t.image_url??t.cover_image??t.web_image??t.mobile_image??t.image??null,h=P(o,Be(d)),u=t.slug||t.id||t.attraction_id||null,g=Number(t.base_price||t.price||t.amount||0),c=t.attraction_id??t.id??u;return{title:l,image_url:h,slug:u,price:g,attraction_id:c}};function St(t,n,d,l=!1){if(n!=null&&n.image_url)return n.image_url;const h=(t==null?void 0:t.banner_media_id)??(t==null?void 0:t.image_media_id)??(t==null?void 0:t.cover_media_id)??(t==null?void 0:t.banner_image)??(t==null?void 0:t.hero_image)??(t==null?void 0:t.image_web)??(t==null?void 0:t.image_url)??(t==null?void 0:t.image)??null,u=P(h,l?fe:Te);return u||(n==null?void 0:n.image_url)||(d==null?void 0:d.image_url)||(l?fe:Te)}const me=(t,n)=>{if(!t)return!1;const d=j().format("YYYY-MM-DD");if(n===d){const l=j(),o=t.start_time||t.time||null;if(!o)return!0;const[h,u]=o.split(":").map(Number),g=(h||0)*60+(u||0),c=l.hour()*60+l.minute();return g>=c+60}return!0},se=t=>t?String(t.combo_slot_id??t.id??t._id??t.slot_id??`${t.start_time||""}-${t.end_time||""}`):"";function zt(){var ke,De,Ce,Se,Ae,Ee;const{id:t}=lt(),n=dt(),d=ot(),{items:l=[],status:o}=Fe(s=>s.combos||{items:[],status:"idle"}),{items:h=[],status:u}=Fe(s=>s.attractions||{items:[],status:"idle"});m.useEffect(()=>{o==="idle"&&d(ct({active:!0,limit:100})),u==="idle"&&d(ut({active:!0,limit:200}))},[u,o,d]);const g=m.useMemo(()=>{if(!t)return null;const s=Number(t);return Number.isFinite(s)?s:null},[t]),c=m.useMemo(()=>!t||!l.length?null:l.find(s=>String((s==null?void 0:s.combo_id)??(s==null?void 0:s.id)??"")===t)||l.find(s=>t&&(s==null?void 0:s.slug)&&String(s.slug)===t)||null,[l,t]),f=m.useMemo(()=>g??(c!=null&&c.combo_id?Number(c.combo_id):c!=null&&c.id?Number(c.id):null),[c,g]),[M,N]=m.useState({status:"idle",data:null,error:null}),[y,ae]=m.useState({status:"idle",items:[],error:null}),[xe,V]=m.useState(null),[he,W]=m.useState({status:"idle",items:[],error:null}),[Ve,Ge]=m.useState(typeof window<"u"?window.innerWidth>=1024:!1);m.useEffect(()=>{if(typeof window>"u")return;const s=()=>Ge(window.innerWidth>=1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),m.useEffect(()=>{t?f==null&&(g==null&&(o==="loading"||o==="idle")?N(s=>s.status==="loading"?s:{status:"loading",data:null,error:null}):g==null&&o==="failed"&&N({status:"failed",data:null,error:"Combo not found"})):N({status:"failed",data:null,error:"Combo not found"})},[t,f,g,o]),m.useEffect(()=>{let s=!0;const r=new AbortController;return t?f==null?g==null&&(o==="loading"||o==="idle")?N(i=>i.status==="loading"?i:{status:"loading",data:null,error:null}):g==null&&o==="failed"&&N({status:"failed",data:null,error:"Combo not found"}):(N({status:"loading",data:null,error:null}),(async()=>{try{const i=await Z.get(ee.combos.byId(f),{signal:r.signal});if(!s)return;N({status:"succeeded",data:i,error:null})}catch(i){if(i!=null&&i.canceled||!s)return;N(c?{status:"succeeded",data:c,error:null}:{status:"failed",data:null,error:(i==null?void 0:i.message)||"Failed to load combo"})}})()):N({status:"failed",data:null,error:"Combo not found"}),()=>{s=!1,r.abort()}},[t,f,g,o,c]);const[p,He]=m.useState(j().format("YYYY-MM-DD")),[D,re]=m.useState(1),[L,Ke]=m.useState([]),[ge,Q]=m.useState(!1),[Ue,qe]=m.useState(null),G=m.useMemo(()=>null,[Ue,ge]),I=m.useCallback(s=>{He(s),H(r=>({...r,selectedKey:""}))},[]),We=m.useCallback(()=>{I(j().format("YYYY-MM-DD"))},[I]),Qe=m.useCallback(()=>{I(j().add(1,"day").format("YYYY-MM-DD"))},[I]);m.useCallback(()=>{I("")},[I]);const Xe=m.useCallback(s=>{s.preventDefault(),s.stopPropagation(),qe(s.currentTarget),Q(!0)},[]),Je=m.useCallback(s=>{I(s),Q(!1)},[I]);m.useMemo(()=>{const s=j().format("YYYY-MM-DD"),r=j().add(1,"day").format("YYYY-MM-DD");return i=>!i||i===s||i===r?"All Days":j(i).format("D MMM")},[]);const[C,H]=m.useState({status:"idle",selectedKey:""}),[pe,ye]=m.useState(""),be=m.useCallback(async()=>{if(f)try{H(x=>({...x,status:"loading"})),ye("");const s=await Z.get(ee.combos.slots(f),{params:p?{date:p}:{}}),r=Array.isArray(s)?s:Array.isArray(s==null?void 0:s.data)?s.data:[];Ke(r);const i=r.find(x=>me(x,p))||r[0]||null;H({status:"loaded",selectedKey:i?se(i):""})}catch(s){ye((s==null?void 0:s.message)||"Failed to load slots"),H(r=>({...r,status:"failed",selectedKey:""}))}},[f,p]);m.useEffect(()=>{f&&p&&be()},[f,p,be]),m.useEffect(()=>{if(!f)return W({status:"idle",items:[],error:null}),()=>{};let s=!1;return W(r=>({...r,status:"loading",error:null})),(async()=>{try{const r=await Z.get(ee.offers.list(),{params:{active:!0,target_type:"combo",target_id:f}});if(s)return;const i=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];W({status:"succeeded",items:i,error:null})}catch(r){if(s)return;W({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load offers"})}})(),()=>{s=!0}},[f]),m.useEffect(()=>{if(!f)return;let s=!1;return ae(r=>({...r,status:"loading",error:null})),(async()=>{var r;try{const i=await Z.get(ee.gallery.list(),{params:{active:!0,target_type:"combo",target_ref_id:f,limit:12}});if(s)return;const x=((r=i==null?void 0:i.data)==null?void 0:r.data)||(Array.isArray(i==null?void 0:i.data)?i.data:Array.isArray(i)?i:[]);ae({status:"succeeded",items:x,error:null})}catch(i){if(s)return;ae({status:"failed",items:[],error:(i==null?void 0:i.message)||"Failed to load gallery"})}})(),()=>{s=!0}},[f]);const a=M.data||c,je=m.useMemo(()=>{if(!a)return[];const s=[a.attraction_1||{title:a==null?void 0:a.attraction_1_title,image_url:a==null?void 0:a.attraction_1_image,slug:a==null?void 0:a.attraction_1_slug,base_price:a==null?void 0:a.attraction_1_price,attraction_id:a==null?void 0:a.attraction_1_id},a.attraction_2||{title:a==null?void 0:a.attraction_2_title,image_url:a==null?void 0:a.attraction_2_image,slug:a==null?void 0:a.attraction_2_slug,base_price:a==null?void 0:a.attraction_2_price,attraction_id:a==null?void 0:a.attraction_2_id}];return Array.isArray(s)?s.filter(Boolean):[]},[a]),k=m.useMemo(()=>{if(!a)return[];if(Array.isArray(a==null?void 0:a.attractions)&&a.attractions.length)return a.attractions.map((r,i)=>ue(r,`Experience ${i+1}`,`combo-${i}`));const s=Array.isArray(a==null?void 0:a.attraction_ids)?a.attraction_ids.filter(Boolean):[];return s.length&&h.length?s.map((r,i)=>{const x=h.find(_=>String(vt(_))===String(r));return ue(x||{title:`Experience ${i+1}`},`combo-${i}`)}).filter(Boolean):je.map((r,i)=>ue(r,`Experience ${i+1}`,`combo-${i}`)).filter(Boolean)},[a,h,je]),[Ze,et]=[k[0],k[1]],tt=M.status==="loading"&&!a,F=(a==null?void 0:a.combo_id)||(a==null?void 0:a.id)||f||null,B=(a==null?void 0:a.name)||(a==null?void 0:a.title)||"Combo Deal",_e=(a==null?void 0:a.short_description)||(a==null?void 0:a.subtitle)||"",Ne=(a==null?void 0:a.description)||(a==null?void 0:a.long_description)||"",ie=St(a,Ze,et,Ve),ve=(k.length?k:[{title:B,image_url:_t}]).slice(0,Math.max(2,Math.min(3,k.length||2))).map(s=>s.title).join(" + "),we=ht(a),Y=we>0?we:Number((a==null?void 0:a.combo_price)||(a==null?void 0:a.total_price)||0),ne=gt(a),$=ne||k.reduce((s,r)=>s+Number((r==null?void 0:r.price)||0),0),le=$>0,st=le&&Y>0?$-Y:0,X=le&&Y>0&&Y<$?Math.max(0,Math.round(pt(a)||($-Y)/$*100)):Number((a==null?void 0:a.discount_percent)||0),J=m.useCallback(s=>{const r=Number(Y||0),i=Number(ne||$||r),x=$e(s,r),_=yt(s,i),S=x||_||0,E=F?Ct(he.items,{targetType:"combo",targetId:F,date:p,slot:s,basePrice:S}):null,v=E?E.price:x,T=_>v?_-v:0;return{finalPrice:v,originalPrice:_,savings:T,bestOffer:E}},[Y,ne,$,he.items,F,p]),A=L.find(s=>se(s)===C.selectedKey)||null,b=A?J(A):null,Me=Math.max(1,Number(D)||1),z=(b==null?void 0:b.finalPrice)||0,O=(b==null?void 0:b.originalPrice)||Y||0,K=O>0&&z>0&&z<O,at=K?Math.round((O-z)/O*100):0,rt=Number(z||0)*Me,Ye=A&&z?z*Me:null;if(tt)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white",children:e.jsx(te,{})});if(M.status==="failed")return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(q,{message:M.error||"Combo not found"})})});if(!a)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(q,{message:"Combo not found"})})});const de=(s,r)=>{var v,T,U,R;const i=Math.max(1,Number(D)||1),x=r||J(s),_=(x==null?void 0:x.finalPrice)??$e(s,Y),S=(s==null?void 0:s.combo_slot_id)??(s==null?void 0:s.id)??(s==null?void 0:s._id)??null;if(!S)return;d(ft({itemType:"combo",comboId:Number(F)||F,combo:a,date:p,booking_date:Nt(p),booking_time:(s==null?void 0:s.start_time)||(s==null?void 0:s.startTime)||(s==null?void 0:s.slot_start_time)||null,comboSlotId:S,slot:s,qty:i,unitPrice:_,title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||(a==null?void 0:a.combo_name)||`Combo #${F}`,slotLabel:oe(s),dateLabel:j(p).format("DD MMM YYYY"),meta:{title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||(a==null?void 0:a.combo_name)||`Combo #${F}`,start_time:s==null?void 0:s.start_time,end_time:s==null?void 0:s.end_time,capacity:s==null?void 0:s.capacity,available:s==null?void 0:s.available},offer_id:(T=(v=x==null?void 0:x.bestOffer)==null?void 0:v.offer)==null?void 0:T.offer_id,offer_rule_id:(R=(U=x==null?void 0:x.bestOffer)==null?void 0:U.rule)==null?void 0:R.rule_id})),d(xt(1));const E=new URLSearchParams({type:"combo",combo_id:String(F),date:p,slot:se(s),qty:String(i)});n(`/booking?${E.toString()}`)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#e0f2fe] via-[#bae6fd] to-white font-sans",children:[e.jsxs("section",{className:"mt-0 bg-transparent",children:[e.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-6 space-y-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",style:{fontFamily:"Inter, sans-serif"},children:B}),e.jsx("div",{className:"overflow-hidden shadow-lg bg-gray-100",children:y.items.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr] gap-[2px] bg-white",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>y.items.length&&V(0),children:e.jsxs("div",{className:"md:h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:ie,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:"Snow City"})})]})}),e.jsxs("div",{className:"hidden md:grid grid-rows-2 gap-[2px] h-[420px]",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>y.items.length>0&&V(0),children:e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:((ke=y.items[0])==null?void 0:ke.image_url)||((De=y.items[0])==null?void 0:De.url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"})})}),e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>y.items.length>1&&V(1),children:e.jsxs("div",{className:"w-full h-full overflow-hidden",children:[e.jsx("img",{src:((Ce=y.items[1])==null?void 0:Ce.image_url)||((Se=y.items[1])==null?void 0:Se.url)||((Ae=y.items[0])==null?void 0:Ae.image_url)||((Ee=y.items[0])==null?void 0:Ee.url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full",children:y.items.length>1?e.jsxs(e.Fragment,{children:["1 / ",y.items.length]}):null})]})})]})]}):e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>y.items.length&&V(0),children:e.jsxs("div",{className:"h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:ie,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:"Snow City"})})]})})})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),e.jsx("div",{className:"absolute bottom-6 left-0 right-0 px-4",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur px-3 py-1 rounded-full text-xs uppercase tracking-wide text-gray-100 mb-2",children:[e.jsx("span",{children:"Combo Deal"}),X>0?e.jsxs("span",{children:["Save ",X,"%"]}):null]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-white drop-shadow",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:B}),_e?e.jsx("p",{className:"text-gray-200 text-sm md:text-base max-w-2xl mt-2",style:{fontFamily:"Inter, sans-serif"},children:_e}):null,!ie&&ve?e.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-gray-200 mt-3 line-clamp-2",children:ve}):null]})})]}),y.items.length>0?e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"Photo Gallery"}),y.status==="loading"?e.jsx("div",{className:"py-8 text-center",children:e.jsx(te,{})}):y.status==="failed"?e.jsx("div",{className:"py-8 text-center",children:e.jsx(q,{message:y.error})}):e.jsx(jt,{items:y.items})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif"},children:"Gallery Preview"}),e.jsx("div",{className:"space-y-3",children:y.items.slice(0,3).map((s,r)=>{const i=String(s.media_type||"").toLowerCase()==="video",x=i?P(s.media_url||s.url||s):P(s.image_url||s.url||s);return e.jsxs("div",{className:"relative group",children:[i?e.jsx("video",{className:"w-full h-32 object-cover rounded-lg",src:x,muted:!0,preload:"metadata"}):e.jsx("img",{src:x,alt:s.title||"Gallery item",className:"w-full h-32 object-cover rounded-lg transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-sm font-medium",children:["+",y.items.length-3," more"]})})]},s.gallery_item_id||s.id||r)})})]})})]})}):null,e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8 md:py-12",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10 md:gap-12",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[k.length>0&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map((s,r)=>e.jsxs("figure",{className:"relative rounded-2xl overflow-hidden shadow-sm bg-white",children:[e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-60 md:h-64 object-cover",loading:"lazy"}),e.jsxs("figcaption",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/75 to-transparent p-4 text-white",children:[e.jsxs("p",{className:"text-[11px] uppercase tracking-wide text-gray-300",children:["Experience ",r+1]}),e.jsx("h2",{className:"text-lg font-semibold line-clamp-2",style:{fontFamily:"Inter, sans-serif"},children:s.title}),s.price?e.jsxs("p",{className:"text-xs text-gray-200 mt-1",children:["Base price: ",w(s.price)]}):null]})]},`included-${r}`))}),Ne?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"About this combo"}),e.jsx("div",{className:"prose prose-sm md:prose max-w-none text-gray-700 leading-relaxed",style:{textAlign:"left",fontFamily:"Inter, sans-serif"},dangerouslySetInnerHTML:{__html:Ne}})]}):null,e.jsxs("div",{id:"availability",className:"rounded-2xl border shadow-sm p-4 md:p-5 bg-white",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-3",children:[e.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"All time slots"}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:e.jsxs("span",{children:[j(p).format("DD MMM YYYY")," • ",D," ticket",D>1?"s":""]})})]}),C.status==="loading"?e.jsx("div",{className:"py-3",children:e.jsx(te,{size:"sm"})}):null,C.status==="failed"?e.jsx("div",{className:"py-3",children:e.jsx(q,{message:pe||"Failed to load slots"})}):null,C.status==="loaded"&&e.jsx(e.Fragment,{children:L.length?e.jsx("div",{className:"space-y-2",children:L.filter(s=>me(s,p)).map(s=>{const r=oe(s),i=J(s),x=i.finalPrice,_=i.originalPrice,S=_>0&&x>=0&&x<_,E=S&&_?Math.max(0,Math.round((_-x)/_*100)):null,v=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0;return e.jsxs("div",{className:`flex items-center justify-between rounded-xl border px-4 py-3 shadow-sm ${v?"opacity-50 bg-gray-100 border-gray-200":"bg-white border-gray-200 hover:border-blue-300 hover:shadow-md transition-all"}`,children:[e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("span",{className:"font-semibold text-base text-gray-900",children:r||"Time slot"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Capacity: ",s.capacity," •"," ",s.available?"Available":"Unavailable"]}),S?e.jsxs("span",{className:"text-sm text-emerald-600 font-medium mt-1",children:[w(x)," ",e.jsx("span",{className:"line-through text-gray-400 ml-1",children:w(_)})]}):e.jsx("span",{className:"text-sm text-gray-700 mt-1",children:w(x)}),S&&e.jsxs("span",{className:"text-[11px] font-semibold text-emerald-600 mt-0.5",children:["Save ",E,"%"]})]}),e.jsx("button",{type:"button",disabled:v,onClick:()=>de(s,i),className:`px-4 py-2 rounded-full border text-sm font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${v?"opacity-50 cursor-not-allowed bg-gray-100 border-gray-200 text-gray-400":"bg-blue-600 text-white border-blue-600 hover:bg-blue-700"}`,children:"Book this slot"})]},s.combo_slot_id||`${s.combo_id}-${s.start_time}-${s.end_time}`)})}):e.jsxs("div",{className:"text-sm text-gray-500",children:["No slots available for"," ",j(p).format("DD MMM YYYY"),"."]})})]})]}),e.jsx("aside",{className:"lg:col-span-1",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 sticky top-24 space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Combo price"}),e.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[e.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:w(Y)}),e.jsx("span",{className:"text-sm text-gray-500",children:"per combo"})]}),le&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"line-through mr-2",children:w($)}),X>0?e.jsxs("span",{className:"text-emerald-600 font-medium",children:["Save ",X,"% (",w(st),")"]}):e.jsxs("span",{children:["Special pricing across"," ",k.length||2," experiences"]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:We,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${p===j().format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:Qe,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${p===j().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:Xe,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${p&&p!==""&&p!==j().format("YYYY-MM-DD")&&p!==j().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:p&&p!==""&&p!==j().format("YYYY-MM-DD")&&p!==j().add(1,"day").format("YYYY-MM-DD")?j(p).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),C.status==="loading"?e.jsx("div",{className:"py-2",children:e.jsx(te,{size:"sm"})}):C.status==="failed"?e.jsx(q,{message:pe||"Failed to load slots"}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:C.selectedKey,onChange:s=>H(r=>({...r,selectedKey:s.target.value})),disabled:!L.length,style:{fontFamily:"Inter, sans-serif"},children:L.length?e.jsxs(e.Fragment,{children:[!C.selectedKey&&e.jsx("option",{value:"",children:"Select slot"}),L.filter(s=>me(s,p)).map(s=>{const r=se(s),i=J(s),x=oe(s)||"Slot",_=(i==null?void 0:i.finalPrice)!=null?` • ${w(i.finalPrice)}`:"";return e.jsxs("option",{value:r,children:[x,_]},r)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>re(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:D,onChange:s=>re(Math.max(1,Number(s.target.value)||1)),className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>re(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[D," × ",w((b==null?void 0:b.finalPrice)||Y||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:w(((b==null?void 0:b.finalPrice)||Y||0)*D)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!A||C.status==="loading",onClick:()=>{A&&de(A,b)},style:{fontFamily:"Inter, sans-serif"},children:b!=null&&b.finalPrice?`Book Now • ${w(b.finalPrice*D)}`:"Book Now"})]}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("p",{children:["Includes admission for"," ",k.length||2," attraction(s). Book together to lock in bundled savings."]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:k.map((s,r)=>e.jsx("li",{children:s.title},`sidebar-attr-${r}`))})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("a",{href:"#availability",className:"inline-flex items-center justify-center rounded-full bg-blue-600 text-white px-6 py-3 text-sm font-medium hover:bg-blue-700",children:"View all time slots"}),e.jsx(mt,{to:"/combos",className:"inline-flex items-center justify-center rounded-full border border-blue-100 text-blue-600 px-6 py-3 text-sm font-medium hover:bg-blue-50",children:"Explore other combos"})]})]})})]})}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-[70] border-t border-gray-200 bg-white/95 backdrop-blur",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3 pb-[calc(env(safe-area-inset-bottom)+12px)]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",children:K?"Offer price":"Base price"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 rupee",children:w(K?(b==null?void 0:b.finalPrice)||0:O||(b==null?void 0:b.finalPrice)||0)}),K?e.jsx("div",{className:"text-sm text-gray-400 line-through rupee",children:w(O||0)}):null,K?e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",at,"%"]}):null]}),e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[D," ticket",D>1?"s":""," • Total"," ",e.jsx("span",{className:"rupee font-semibold text-gray-800",children:w(rt||0)})]})]}),e.jsx("button",{type:"button",className:"inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!A||C.status==="loading",onClick:()=>{A&&de(A,b)},children:Ye?e.jsxs(e.Fragment,{children:["Book •"," ",e.jsx("span",{className:"ml-1 rupee",children:w(Ye)})]}):"Book Now"})]})})}),ge&&e.jsxs("div",{className:"fixed inset-0 z-[80] flex",onClick:()=>Q(!1),children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"absolute bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 w-80 max-h-[70vh] overflow-y-auto",style:{top:G?`${G.top}px`:"50%",left:G?`${G.left-160}px`:"50%",transform:G?"none":"translate(-50%, -50%)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Select Date"}),e.jsx("button",{type:"button",onClick:()=>Q(!1),className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors",children:e.jsx(bt,{size:18})})]}),e.jsx("div",{className:"space-y-3",children:[0,1,2].map(s=>{const r=j().add(s,"month"),i=r.startOf("month"),x=r.endOf("month"),_=i.day(),S=x.date(),E=j();return e.jsxs("div",{className:"border border-gray-100 rounded-xl p-3 bg-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:r.format("MMMM YYYY")})}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center text-xs text-gray-500 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(v=>e.jsx("div",{className:"py-1 font-medium",children:v},v))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-sm",children:[Array.from({length:_}).map((v,T)=>e.jsx("div",{},`pad-${T}`)),Array.from({length:S}).map((v,T)=>{const U=T+1,R=i.date(U).format("YYYY-MM-DD"),it=!1,nt=E.format("YYYY-MM-DD")===R;return e.jsx("button",{type:"button",onClick:()=>{Je(R)},disabled:it,className:`w-full h-8 rounded-lg flex items-center justify-center transition-colors ${nt?"bg-sky-100 text-sky-700 font-semibold":"hover:bg-gray-100"}`,children:U},R)})]})]},s)})})]})]}),xe!==null&&y.items.length>0?e.jsx(Oe,{items:y.items,initialIndex:xe,onClose:()=>V(null)}):null]})}export{zt as default};
