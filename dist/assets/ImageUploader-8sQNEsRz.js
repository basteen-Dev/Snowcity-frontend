import{R as s,j as t}from"./index-DpUnVvi7.js";import{a as V}from"./AdminApp-DElutmvv.js";import{i as W}from"./media-CQLQFIy8.js";const y={},D="/api/admin/uploads",R=(y==null?void 0:y.VITE_CLOUDINARY_UPLOAD_PRESET)||"";function ee({label:I="Image",value:u,onChange:d,onUploadComplete:m,fieldName:O="file",extra:U={},accept:F="image/*,video/*,.pdf",requiredPerm:$=null,folder:h="",multiple:q=!1,onMultipleChange:Y,altText:x="",onAltChange:c}){const j=s.useId(),[_,A]=s.useState([]),[B,G]=s.useState([]),[H,J]=s.useState([]),[K,Q]=s.useState([]),[v,o]=s.useState(""),[l,p]=s.useState(null),[f,N]=s.useState(""),[k,w]=s.useState(""),[S,b]=s.useState("idle"),n=s.useMemo(()=>W(u||""),[u]);s.useEffect(()=>{if(!l)return;const e=URL.createObjectURL(l);return N(e),w(l.name||""),()=>URL.revokeObjectURL(e)},[l]);const E=e=>e?e.type.startsWith("image/")?"image":e.type.startsWith("video/")?"video":e.type==="application/pdf"?"pdf":"unknown":"unknown",L=e=>{var i;const a=((i=e.target.files)==null?void 0:i[0])||null;o(""),p(a)},T=e=>{var i,r;e.preventDefault(),e.stopPropagation();const a=((r=(i=e.dataTransfer)==null?void 0:i.files)==null?void 0:r[0])||null;a&&(o(""),p(a))},M=e=>{e.preventDefault(),e.stopPropagation()},P=()=>{p(null),N(""),w("")},z=async()=>{var e;if(l){b("loading"),o("");try{const a=/cloudinary\.com/i.test(D),i={...U||{}};a&&R&&!i.upload_preset&&(i.upload_preset=R),h&&!a&&(i.folder=h);const r=await V.upload(D,l,{fieldName:O,data:i}),g=(r==null?void 0:r.url)||(r==null?void 0:r.url_path)||(r==null?void 0:r.secure_url)||(r==null?void 0:r.location)||((e=r==null?void 0:r.data)==null?void 0:e.url)||"";if(!g)throw new Error((r==null?void 0:r.message)||"Upload response missing URL");d==null||d(g),m==null||m(g),b("done"),P()}catch(a){b("error"),o((a==null?void 0:a.message)||"Upload failed")}}};return t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:I}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsx("input",{type:"text",className:"flex-1 rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",placeholder:"https://...",value:u||"",onChange:e=>d==null?void 0:d(e.target.value)})}),c&&t.jsxs("div",{className:"mt-2",children:[t.jsxs("label",{className:"block text-xs text-gray-500 dark:text-neutral-400 mb-1",children:["Image Alt Text ",t.jsx("span",{className:"text-gray-400",children:"(SEO & Accessibility)"})]}),t.jsx("input",{type:"text",className:"w-full rounded-md border px-3 py-2 text-sm dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",placeholder:"Describe the image for SEO and accessibility...",value:x||"",onChange:e=>c==null?void 0:c(e.target.value)})]}),t.jsxs("div",{className:"mt-2 rounded-md border border-dashed px-3 py-3 text-sm text-gray-600 dark:text-neutral-300 dark:border-neutral-700",onDrop:T,onDragOver:M,children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("input",{id:j,type:"file",accept:F,onChange:L,className:"sr-only"}),t.jsx("label",{htmlFor:j,className:"inline-flex items-center rounded-md border px-3 py-2 text-sm cursor-pointer dark:border-neutral-700 dark:text-neutral-200",role:"button",children:"Choose"}),t.jsx("button",{className:"inline-flex items-center rounded-md bg-gray-900 text-white px-3 py-2 text-sm disabled:opacity-50",onClick:z,disabled:!l||S==="loading",type:"button",children:S==="loading"?"Uploadingâ€¦":"Upload"}),k?t.jsxs("span",{className:"text-xs text-gray-500 dark:text-neutral-400",children:["Selected: ",k]}):null,l?t.jsx("button",{className:"inline-flex items-center rounded-md border px-2 py-1 text-xs dark:border-neutral-700 dark:text-neutral-200",onClick:P,type:"button",children:"Clear"}):null]}),t.jsx("div",{className:"mt-2 text-xs text-gray-500 dark:text-neutral-400",children:"Drag a file here, or click Choose to select."})]}),t.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[f?t.jsx("div",{className:"w-16 h-16 rounded-md border dark:border-neutral-800 overflow-hidden bg-gray-100",children:E(l)==="video"?t.jsx("video",{src:f,className:"w-full h-full object-cover",muted:!0}):E(l)==="pdf"?t.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-500",children:"PDF"}):t.jsx("img",{src:f,alt:x||"Preview",loading:"lazy",className:"w-full h-full object-cover"})}):null,n?t.jsx("div",{className:"w-16 h-16 rounded-md border dark:border-neutral-800 overflow-hidden bg-gray-100",children:n.match(/\.(mp4|webm|ogg)$/i)?t.jsx("video",{src:n,className:"w-full h-full object-cover",muted:!0}):n.match(/\.pdf$/i)?t.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-500",children:"PDF"}):t.jsx("img",{src:n,alt:x||"Current media",loading:"lazy",className:"w-full h-full object-cover",onError:e=>{e.target.onerror=null,e.target.src="/placeholder-image.png"}})}):null]}),v?t.jsx("div",{className:"text-xs text-red-600 mt-2",children:v}):null]})}export{ee as I};
