import{C as ze,B as He,h as Ke,u as pe,R as u,t as qe,p as Ue,i as R,k as z,D as h,j as a,A as he,L as Ge,E as Qe,F as Ve}from"./index-CNdOvwUA.js";import{E as J}from"./ErrorState-CuVT3_I5.js";import{f as Y}from"./formatters-CmiLqhJj.js";import{g as We,a as Je,b as Xe,d as ye,c as Ze}from"./pricing-CIeFTiJd.js";import{i as Me}from"./media-Ct2xuz47.js";const se="https://picsum.photos/seed/combo-hero/1920/800",be="https://picsum.photos/seed/combo-hero/800/600",_e=se,Ne=(e,i=!1)=>i?`https://picsum.photos/seed/${e}/1920/800`:`https://picsum.photos/seed/${e}/640/400`,et=e=>h(e).format("YYYY-MM-DD"),tt=e=>(e==null?void 0:e.id)??(e==null?void 0:e._id)??(e==null?void 0:e.attraction_id)??null,je=e=>{if(!e)return"";const[i="0",l="0"]=String(e).split(":"),d=Number(i),o=Number(l);if(!Number.isFinite(d)||!Number.isFinite(o))return"";const m=d>=12?"PM":"AM",c=d%12||12,g=o.toString().padStart(2,"0");return`${c}:${g} ${m}`},ve=e=>e?String(e).slice(0,5):"",X=e=>{const i=je(e==null?void 0:e.start_time),l=je(e==null?void 0:e.end_time);if(i&&l)return`${i} → ${l}`;const d=ve(e==null?void 0:e.start_time),o=ve(e==null?void 0:e.end_time);return d&&o?`${d} → ${o}`:""},Z=e=>{if(!e||typeof e!="string")return null;const[i="0",l="0"]=e.split(":"),d=Number(i),o=Number(l);return!Number.isFinite(d)||!Number.isFinite(o)?null:d*60+o},st=(e={},i)=>{if(!e.day_type)return!0;const l=h(i).day(),d=String(e.day_type).toLowerCase();return d==="weekday"?l>=1&&l<=5:d==="weekend"?l===0||l===6:d==="custom"&&Array.isArray(e.specific_days)?e.specific_days.map(Number).includes(l):!0},we=e=>String(e||"").toLowerCase(),Ye=(e,i)=>e==null||i==null?!1:String(e)===String(i),at=e=>{if(typeof e=="boolean")return e;if(e==null)return!1;if(typeof e=="number")return e!==0;const i=String(e).trim().toLowerCase();return i?["true","1","yes","y"].includes(i)?!0:["false","0","no","n"].includes(i)?!1:!!e:!1},rt=(e={},i=null)=>{if(!i)return!(e.slot_id!=null||Array.isArray(e.slot_ids)&&e.slot_ids.length||e.specific_time||e.time_from&&e.time_to);const l=[];if(e.slot_id!=null&&l.push(e.slot_id),Array.isArray(e.slot_ids)&&l.push(...e.slot_ids),e.target_slot_id!=null&&l.push(e.target_slot_id),l.length){const o=[i.slot_id,i.id,i._id,i.combo_slot_id].filter(c=>c!=null);if(!l.some(c=>o.some(g=>Ye(c,g))))return!1}const d=i.start_time||i.time||i.startTime||null;if(e.specific_time&&d&&d.slice(0,5)!==String(e.specific_time).slice(0,5))return!1;if(e.time_from&&e.time_to&&d){const o=Z(d),m=Z(e.time_from),c=Z(e.time_to);if(o==null||m==null||c==null||o<m||o>c)return!1}return!0},it=(e,{targetType:i,targetId:l,date:d,slot:o})=>{if(!e||!i||!l)return!1;const m=h(d).format("YYYY-MM-DD"),c=we(e.target_type),g=we(i);if(c&&g&&c!==g)return!1;if(!at(e.applies_to_all)){const f=[];if(e.target_id!=null&&f.push(e.target_id),Array.isArray(e.target_ids)&&f.push(...e.target_ids),!f.length||!f.some(j=>Ye(j,l)))return!1}return!(e.specific_date&&m!==e.specific_date||Array.isArray(e.specific_dates)&&e.specific_dates.length&&!e.specific_dates.some(f=>h(f).format("YYYY-MM-DD")===m)||e.date_from&&m<e.date_from||e.date_to&&m>e.date_to||!st(e,m)||!rt(e,o))},nt=(e={},i=null,l=0)=>{const d=Number(l);if(!d||d<=0)return 0;let o=(i==null?void 0:i.rule_discount_type)||e.discount_type||(e.discount_percent?"percent":null),m=(i==null?void 0:i.rule_discount_value)??e.discount_value??e.discount_percent??0;if(!o||!m)return 0;o=String(o).toLowerCase();let c=o==="amount"?Number(m):Number(m)/100*d;return Number.isFinite(Number(e.max_discount))&&(c=Math.min(c,Number(e.max_discount))),c=Math.min(c,d),Math.max(0,c)},lt=(e=[],{targetType:i,targetId:l,date:d,slot:o,basePrice:m})=>{if(!Array.isArray(e)||!e.length||!m||!l)return null;let c=null;return e.forEach(g=>{(Array.isArray(g.rules)&&g.rules.length?g.rules:[null]).forEach(f=>{if(f&&!it(f,{targetType:i,targetId:l,date:d,slot:o}))return;const j=nt(g,f,m);if(!j)return;const _=Math.max(0,m-j);(!c||_<c.price)&&(c={offer:g,rule:f,price:_,discount:j})})}),c},ee=(e,i,l)=>{if(!e||typeof e!="object")return{title:i,image_url:Ne(l),slug:null,price:0,attraction_id:null};const d=e.title||e.name||i,o=e.desktop_image_url??e.hero_desktop_image??e.hero_image??e.image_media_id??e.media_id??e.cover_media_id??e.banner_media_id??e.url_path??e.image_url??e.cover_image??e.web_image??e.mobile_image??e.image??null,m=Me(o,Ne(l)),c=e.slug||e.id||e.attraction_id||null,g=Number(e.base_price||e.price||e.amount||0),y=e.attraction_id??e.id??c;return{title:d,image_url:m,slug:c,price:g,attraction_id:y}};function dt(e,i,l,d=!1){if(i!=null&&i.image_url)return i.image_url;const m=(e==null?void 0:e.banner_media_id)??(e==null?void 0:e.image_media_id)??(e==null?void 0:e.cover_media_id)??(e==null?void 0:e.banner_image)??(e==null?void 0:e.hero_image)??(e==null?void 0:e.image_web)??(e==null?void 0:e.image_url)??(e==null?void 0:e.image)??null,c=Me(m,d?se:be);return c||(i==null?void 0:i.image_url)||(l==null?void 0:l.image_url)||(d?se:be)}const te=(e,i)=>{if(!e)return!1;const l=h().format("YYYY-MM-DD");if(i===l){const d=h(),o=e.start_time||e.time||null;if(!o)return!0;const[m,c]=o.split(":").map(Number),g=(m||0)*60+(c||0),y=d.hour()*60+d.minute();return g>=y+60}return!0},H=e=>e?String(e.combo_slot_id??e.id??e._id??e.slot_id??`${e.start_time||""}-${e.end_time||""}`):"";function pt(){const{id:e}=ze(),i=He(),l=Ke(),{items:d=[],status:o}=pe(t=>t.combos||{items:[],status:"idle"}),{items:m=[],status:c}=pe(t=>t.attractions||{items:[],status:"idle"});u.useEffect(()=>{o==="idle"&&l(qe({active:!0,limit:100})),c==="idle"&&l(Ue({active:!0,limit:200}))},[c,o,l]);const g=u.useMemo(()=>{if(!e)return null;const t=Number(e);return Number.isFinite(t)?t:null},[e]),y=u.useMemo(()=>!e||!d.length?null:d.find(t=>String((t==null?void 0:t.combo_id)??(t==null?void 0:t.id)??"")===e)||d.find(t=>e&&(t==null?void 0:t.slug)&&String(t.slug)===e)||null,[d,e]),f=u.useMemo(()=>g??(y!=null&&y.combo_id?Number(y.combo_id):y!=null&&y.id?Number(y.id):null),[y,g]),[j,_]=u.useState({status:"idle",data:null,error:null}),[ot,K]=u.useState({status:"idle",items:[],error:null}),[ae,L]=u.useState({status:"idle",items:[],error:null}),[De,ke]=u.useState(typeof window<"u"?window.innerWidth>=1024:!1);u.useEffect(()=>{if(typeof window>"u")return;const t=()=>ke(window.innerWidth>=1024);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),u.useEffect(()=>{e?f==null&&(g==null&&(o==="loading"||o==="idle")?_(t=>t.status==="loading"?t:{status:"loading",data:null,error:null}):g==null&&o==="failed"&&_({status:"failed",data:null,error:"Combo not found"})):_({status:"failed",data:null,error:"Combo not found"})},[e,f,g,o]),u.useEffect(()=>{let t=!0;const r=new AbortController;return e?f==null?g==null&&(o==="loading"||o==="idle")?_(n=>n.status==="loading"?n:{status:"loading",data:null,error:null}):g==null&&o==="failed"&&_({status:"failed",data:null,error:"Combo not found"}):(_({status:"loading",data:null,error:null}),(async()=>{try{const n=await R.get(z.combos.byId(f),{signal:r.signal});if(!t)return;_({status:"succeeded",data:n,error:null})}catch(n){if(n!=null&&n.canceled||!t)return;_(y?{status:"succeeded",data:y,error:null}:{status:"failed",data:null,error:(n==null?void 0:n.message)||"Failed to load combo"})}})()):_({status:"failed",data:null,error:"Combo not found"}),()=>{t=!1,r.abort()}},[e,f,g,o,y]);const[x,Se]=u.useState(h().format("YYYY-MM-DD")),[$,q]=u.useState(1),[E,Ce]=u.useState([]),[Ae,re]=u.useState(!1),[Ee,ie]=u.useState(null);u.useMemo(()=>null,[Ee,Ae]);const D=u.useCallback(t=>{Se(t),P(r=>({...r,selectedKey:""}))},[]),$e=u.useCallback(()=>{D(h().format("YYYY-MM-DD"))},[D]),Pe=u.useCallback(()=>{D(h().add(1,"day").format("YYYY-MM-DD"))},[D]),Te=u.useCallback(()=>{D("")},[D]),Be=u.useCallback(t=>{t.preventDefault(),t.stopPropagation(),ie(t.currentTarget),re(!0)},[]);u.useCallback(t=>{D(t),re(!1)},[D]);const Le=u.useMemo(()=>{const t=h().format("YYYY-MM-DD"),r=h().add(1,"day").format("YYYY-MM-DD");return n=>!n||n===t||n===r?"All Days":h(n).format("D MMM")},[]),[v,P]=u.useState({status:"idle",selectedKey:""}),[Ie,ne]=u.useState(""),le=u.useCallback(async()=>{if(f)try{P(p=>({...p,status:"loading"})),ne("");const t=await R.get(z.combos.slots(f),{params:x?{date:x}:{}}),r=Array.isArray(t)?t:Array.isArray(t==null?void 0:t.data)?t.data:[];Ce(r);const n=r.find(p=>te(p,x))||r[0]||null;P({status:"loaded",selectedKey:n?H(n):""})}catch(t){ne((t==null?void 0:t.message)||"Failed to load slots"),P(r=>({...r,status:"failed",selectedKey:""}))}},[f,x]);u.useEffect(()=>{f&&x&&le()},[f,x,le]),u.useEffect(()=>{if(!f)return L({status:"idle",items:[],error:null}),()=>{};let t=!1;return L(r=>({...r,status:"loading",error:null})),(async()=>{try{const r=await R.get(z.offers.list(),{params:{active:!0,target_type:"combo",target_id:f}});if(t)return;const n=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];L({status:"succeeded",items:n,error:null})}catch(r){if(t)return;L({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load offers"})}})(),()=>{t=!0}},[f]),u.useEffect(()=>{if(!f)return;let t=!1;return K(r=>({...r,status:"loading",error:null})),(async()=>{try{const r=await R.get(z.gallery.list(),{params:{active:!0,target_type:"combo",target_ref_id:f,limit:12}});if(t)return;const n=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];K({status:"succeeded",items:n,error:null})}catch(r){if(t)return;K({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load gallery"})}})(),()=>{t=!0}},[f]);const s=j.data||y,de=u.useMemo(()=>{if(!s)return[];const t=[s.attraction_1||{title:s==null?void 0:s.attraction_1_title,image_url:s==null?void 0:s.attraction_1_image,slug:s==null?void 0:s.attraction_1_slug,base_price:s==null?void 0:s.attraction_1_price,attraction_id:s==null?void 0:s.attraction_1_id},s.attraction_2||{title:s==null?void 0:s.attraction_2_title,image_url:s==null?void 0:s.attraction_2_image,slug:s==null?void 0:s.attraction_2_slug,base_price:s==null?void 0:s.attraction_2_price,attraction_id:s==null?void 0:s.attraction_2_id}];return Array.isArray(t)?t.filter(Boolean):[]},[s]),N=u.useMemo(()=>{if(!s)return[];if(Array.isArray(s==null?void 0:s.attractions)&&s.attractions.length)return s.attractions.map((r,n)=>ee(r,`Experience ${n+1}`,`combo-${n}`));const t=Array.isArray(s==null?void 0:s.attraction_ids)?s.attraction_ids.filter(Boolean):[];return t.length&&m.length?t.map((r,n)=>{const p=m.find(b=>String(tt(b))===String(r));return ee(p||{title:`Experience ${n+1}`},`combo-${n}`)}).filter(Boolean):de.map((r,n)=>ee(r,`Experience ${n+1}`,`combo-${n}`)).filter(Boolean)},[s,m,de]),[Fe,Oe]=[N[0],N[1]];if(j.status==="loading"&&!s)return a.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white",children:a.jsx(he,{})});if(j.status==="failed")return a.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:a.jsx("div",{className:"max-w-lg w-full",children:a.jsx(J,{message:j.error||"Combo not found"})})});if(!s)return a.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:a.jsx("div",{className:"max-w-lg w-full",children:a.jsx(J,{message:"Combo not found"})})});const k=(s==null?void 0:s.combo_id)||(s==null?void 0:s.id)||f||null,U=(s==null?void 0:s.name)||(s==null?void 0:s.title)||"Combo Deal",oe=(s==null?void 0:s.short_description)||(s==null?void 0:s.subtitle)||"",ce=(s==null?void 0:s.description)||(s==null?void 0:s.long_description)||"",G=dt(s,Fe,Oe,De),Q=(N.length?N:[{title:U,image_url:_e}]).slice(0,Math.max(2,Math.min(3,N.length||2))),ue=Q.map(t=>t.title).join(" + "),me=We(s),M=me>0?me:Number((s==null?void 0:s.combo_price)||(s==null?void 0:s.total_price)||0),V=Je(s),S=V||N.reduce((t,r)=>t+Number((r==null?void 0:r.price)||0),0),W=S>0,Re=W&&M>0?S-M:0,I=W&&M>0&&M<S?Math.max(0,Math.round(Xe(s)||(S-M)/S*100)):Number((s==null?void 0:s.discount_percent)||0),F=u.useCallback(t=>{const r=Number(M||0),n=Number(V||S||r),p=ye(t,r),b=Ze(t,n),C=p||b||0,A=k?lt(ae.items,{targetType:"combo",targetId:k,date:x,slot:t,basePrice:C}):null,w=A?A.price:p,O=b>w?b-w:0;return{finalPrice:w,originalPrice:b,savings:O,bestOffer:A}},[M,V,S,ae.items,k,x]),fe=(t,r)=>{var w,O,xe,ge;const n=Math.max(1,Number($)||1),p=r||F(t),b=(p==null?void 0:p.finalPrice)??ye(t,M),C=(t==null?void 0:t.combo_slot_id)??(t==null?void 0:t.id)??(t==null?void 0:t._id)??null;if(!C)return;l(Qe({itemType:"combo",comboId:Number(k)||k,combo:s,date:x,booking_date:et(x),booking_time:(t==null?void 0:t.start_time)||(t==null?void 0:t.startTime)||(t==null?void 0:t.slot_start_time)||null,comboSlotId:C,slot:t,qty:n,unitPrice:b,title:(s==null?void 0:s.title)||(s==null?void 0:s.name)||(s==null?void 0:s.combo_name)||`Combo #${k}`,slotLabel:X(t),dateLabel:h(x).format("DD MMM YYYY"),meta:{title:(s==null?void 0:s.title)||(s==null?void 0:s.name)||(s==null?void 0:s.combo_name)||`Combo #${k}`,start_time:t==null?void 0:t.start_time,end_time:t==null?void 0:t.end_time,capacity:t==null?void 0:t.capacity,available:t==null?void 0:t.available},offer_id:(O=(w=p==null?void 0:p.bestOffer)==null?void 0:w.offer)==null?void 0:O.offer_id,offer_rule_id:(ge=(xe=p==null?void 0:p.bestOffer)==null?void 0:xe.rule)==null?void 0:ge.rule_id})),l(Ve(1));const A=new URLSearchParams({type:"combo",combo_id:String(k),date:x,slot:H(t),qty:String(n)});i(`/booking?${A.toString()}`)},T=E.find(t=>H(t)===v.selectedKey)||null,B=T?F(T):null;return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#e0f2fe] via-[#bae6fd] to-white font-sans",children:[a.jsxs("section",{className:"relative h-[42vh] md:h-[56vh] bg-gray-200",children:[G?a.jsx("img",{src:G,alt:U,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}):a.jsx("div",{className:"absolute inset-0 grid gap-1",style:{gridTemplateColumns:`repeat(${Q.length}, minmax(0, 1fr))`},children:Q.map((t,r)=>a.jsxs("div",{className:"relative overflow-hidden",children:[a.jsx("img",{src:t.image_url||_e,alt:t.title,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"})]},`hero-attr-${r}`))}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),a.jsx("div",{className:"absolute bottom-6 left-0 right-0 px-4",children:a.jsxs("div",{className:"max-w-6xl mx-auto",children:[a.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/20 backdrop-blur px-3 py-1 rounded-full text-xs uppercase tracking-wide text-gray-100 mb-2",children:[a.jsx("span",{children:"Combo Deal"}),I>0?a.jsxs("span",{children:["Save ",I,"%"]}):null]}),a.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-white drop-shadow",children:U}),oe?a.jsx("p",{className:"text-gray-200 text-sm md:text-base max-w-2xl mt-2",children:oe}):null,!G&&ue?a.jsx("p",{className:"text-xs uppercase tracking-[0.25em] text-gray-200 mt-3 line-clamp-2",children:ue}):null]})})]}),a.jsx("section",{className:"bg-white/90 backdrop-blur border-b border-gray-100 shadow-sm",children:a.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4 md:py-5",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3 md:gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-[11px] font-semibold uppercase tracking-wide text-gray-500 mb-1",children:"Book this combo"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Choose your date, time slot & tickets to continue to checkout."})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 md:gap-4 md:flex-none",children:[a.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-xl px-3 py-2 sm:px-4 sm:py-2.5 flex-wrap",children:[a.jsx("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:"Date"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{type:"button",onClick:Te,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${!x||x===""?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,children:"All Days"}),a.jsx("button",{type:"button",onClick:$e,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${x===h().format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,children:"Today"}),a.jsx("button",{type:"button",onClick:Pe,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${x===h().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,children:"Tomorrow"}),a.jsx("button",{type:"button",onClick:Be,ref:ie,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${x&&x!==""&&x!==h().format("YYYY-MM-DD")&&x!==h().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,children:x&&x!==""&&x!==h().format("YYYY-MM-DD")&&x!==h().add(1,"day").format("YYYY-MM-DD")?Le(x):"All Days"})]})]}),a.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-xl px-3 py-2 sm:px-4 sm:py-2.5 min-w-[180px]",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Slot"}),a.jsxs("select",{className:"flex-1 bg-transparent border-none outline-none text-sm font-medium text-gray-900 truncate",value:v.selectedKey,onChange:t=>P(r=>({...r,selectedKey:t.target.value})),disabled:v.status==="loading"||!E.length,children:[v.status==="loading"&&a.jsx("option",{children:"Loading slots…"}),v.status!=="loading"&&!E.length&&a.jsx("option",{children:"No slots"}),v.status!=="loading"&&E.filter(t=>te(t,x)).map(t=>{const r=H(t),n=F(t),p=X(t)||"Slot",b=(n==null?void 0:n.finalPrice)!=null?` • ${Y(n.finalPrice)}`:"";return a.jsxs("option",{value:r,children:[p,b]},r)})]})]}),a.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 border border-gray-200 rounded-xl px-3 py-2 sm:px-4 sm:py-2.5",children:[a.jsx("span",{className:"text-xs text-gray-500",children:"Qty"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>q(t=>Math.max(1,Number(t||1)-1)),children:"-"}),a.jsx("input",{type:"number",min:1,value:$,onChange:t=>q(Math.max(1,Number(t.target.value)||1)),className:"w-12 bg-transparent border-none text-center text-sm font-semibold outline-none"}),a.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>q(t=>Math.max(1,Number(t||1)+1)),children:"+"})]})]}),a.jsx("button",{type:"button",className:"w-full sm:w-auto inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!T||v.status==="loading",onClick:()=>{T&&fe(T,B)},children:B!=null&&B.finalPrice?`Book Now • ${Y(B.finalPrice*$)}`:"Book Now"})]})]})})}),a.jsxs("section",{className:"max-w-6xl mx-auto px-4 py-8 md:py-12 grid grid-cols-1 lg:grid-cols-3 gap-10 md:gap-12",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[N.length>0&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map((t,r)=>a.jsxs("figure",{className:"relative rounded-2xl overflow-hidden shadow-sm bg-white",children:[a.jsx("img",{src:t.image_url,alt:t.title,className:"w-full h-60 md:h-64 object-cover",loading:"lazy"}),a.jsxs("figcaption",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/75 to-transparent p-4 text-white",children:[a.jsxs("p",{className:"text-[11px] uppercase tracking-wide text-gray-300",children:["Experience ",r+1]}),a.jsx("h2",{className:"text-lg font-semibold line-clamp-2",children:t.title}),t.price?a.jsxs("p",{className:"text-xs text-gray-200 mt-1",children:["Base price: ",Y(t.price)]}):null]})]},`included-${r}`))}),ce?a.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[a.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"About this combo"}),a.jsx("div",{className:"prose prose-sm md:prose max-w-none text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:ce}})]}):null,a.jsxs("div",{id:"availability",className:"rounded-2xl border shadow-sm p-4 md:p-5 bg-white",children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-3",children:[a.jsx("h2",{className:"text-lg md:text-xl font-semibold text-gray-900",children:"All time slots"}),a.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:a.jsxs("span",{children:[h(x).format("DD MMM YYYY")," • ",$," ticket",$>1?"s":""]})})]}),v.status==="loading"?a.jsx("div",{className:"py-3",children:a.jsx(he,{size:"sm"})}):null,v.status==="failed"?a.jsx("div",{className:"py-3",children:a.jsx(J,{message:Ie||"Failed to load slots"})}):null,v.status==="loaded"&&a.jsx(a.Fragment,{children:E.length?a.jsx("div",{className:"space-y-2",children:E.filter(t=>te(t,x)).map(t=>{const r=X(t),n=F(t),p=n.finalPrice,b=n.originalPrice,C=b>0&&p>=0&&p<b,A=C&&b?Math.max(0,Math.round((b-p)/b*100)):null,w=(t==null?void 0:t.available)===0||(t==null?void 0:t.capacity)===0;return a.jsxs("div",{className:`flex items-center justify-between rounded-xl border px-4 py-3 shadow-sm ${w?"opacity-50 bg-gray-100 border-gray-200":"bg-white border-gray-200 hover:border-blue-300 hover:shadow-md transition-all"}`,children:[a.jsxs("div",{className:"flex flex-col gap-0.5",children:[a.jsx("span",{className:"font-semibold text-base text-gray-900",children:r||"Time slot"}),a.jsxs("span",{className:"text-xs text-gray-500",children:["Capacity: ",t.capacity," •"," ",t.available?"Available":"Unavailable"]}),C?a.jsxs("span",{className:"text-sm text-emerald-600 font-medium mt-1",children:[Y(p)," ",a.jsx("span",{className:"line-through text-gray-400 ml-1",children:Y(b)})]}):a.jsx("span",{className:"text-sm text-gray-700 mt-1",children:Y(p)}),C&&a.jsxs("span",{className:"text-[11px] font-semibold text-emerald-600 mt-0.5",children:["Save ",A,"%"]})]}),a.jsx("button",{type:"button",disabled:w,onClick:()=>fe(t,n),className:`px-4 py-2 rounded-full border text-sm font-medium shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${w?"opacity-50 cursor-not-allowed bg-gray-100 border-gray-200 text-gray-400":"bg-blue-600 text-white border-blue-600 hover:bg-blue-700"}`,children:"Book this slot"})]},t.combo_slot_id||`${t.combo_id}-${t.start_time}-${t.end_time}`)})}):a.jsxs("div",{className:"text-sm text-gray-500",children:["No slots available for"," ",h(x).format("DD MMM YYYY"),"."]})})]})]}),a.jsx("aside",{className:"lg:col-span-1",children:a.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 sticky top-24 space-y-6",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Combo price"}),a.jsxs("div",{className:"flex items-baseline gap-2 mt-1",children:[a.jsx("span",{className:"text-3xl font-semibold text-gray-900",children:Y(M)}),a.jsx("span",{className:"text-sm text-gray-500",children:"per combo"})]}),W&&a.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[a.jsx("span",{className:"line-through mr-2",children:Y(S)}),I>0?a.jsxs("span",{className:"text-emerald-600 font-medium",children:["Save ",I,"% (",Y(Re),")"]}):a.jsxs("span",{children:["Special pricing across"," ",N.length||2," experiences"]})]})]}),a.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[a.jsxs("p",{children:["Includes admission for"," ",N.length||2," attraction(s). Book together to lock in bundled savings."]}),a.jsx("ul",{className:"list-disc list-inside space-y-1",children:N.map((t,r)=>a.jsx("li",{children:t.title},`sidebar-attr-${r}`))})]}),a.jsxs("div",{className:"flex flex-col gap-3",children:[a.jsx("a",{href:"#availability",className:"inline-flex items-center justify-center rounded-full bg-blue-600 text-white px-6 py-3 text-sm font-medium hover:bg-blue-700",children:"View all time slots"}),a.jsx(Ge,{to:"/combos",className:"inline-flex items-center justify-center rounded-full border border-blue-100 text-blue-600 px-6 py-3 text-sm font-medium hover:bg-blue-50",children:"Explore other combos"})]})]})})]})]})}export{pt as default};
