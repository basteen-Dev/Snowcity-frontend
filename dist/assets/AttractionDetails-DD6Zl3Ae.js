import{C as rt,B as at,h as nt,R as d,D as y,i as ae,k as ne,j as e,A as fe,L as Pe,E as lt,F as it}from"./index-D_x0VcQ4.js";import{E as X}from"./ErrorState-DHcBIx00.js";import{G as ot}from"./GalleryViewer-YHF7dM0M.js";import{g as Ee}from"./ids-YExsbyMi.js";import{i as H}from"./media-DZA-bGGk.js";import{g as ct,a as dt,c as mt,d as ye,b as ut}from"./pricing-CIeFTiJd.js";import{f as k}from"./formatters-CmiLqhJj.js";import{X as xt}from"./x-C3wzXSpj.js";import"./createLucideIcon-CDLCmtzs.js";const le=t=>y(t).format("YYYY-MM-DD"),T=()=>y().format("YYYY-MM-DD"),ie=(t,i)=>String((t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.slot_id)??`${(t==null?void 0:t.start_time)||""}-${(t==null?void 0:t.end_time)||""}-${i}`),ze=t=>{if(!t)return"";const[i,c]=t.split(":"),o=parseInt(i,10),m=o>=12?"PM":"AM";return`${o%12||12}:${c} ${m}`},ge=t=>{if(t!=null&&t.label)return t.label;const i=ze(t==null?void 0:t.start_time),c=ze(t==null?void 0:t.end_time);return i&&c?`${i} - ${c}`:i||`Slot #${(t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.slot_id)??"?"}`},he=t=>{if(!t||typeof t!="string")return null;const[i="0",c="0"]=t.split(":"),o=Number(i),m=Number(c);return!Number.isFinite(o)||!Number.isFinite(m)?null:o*60+m},ft=(t={},i)=>{if(!t.day_type)return!0;const c=y(i).day(),o=String(t.day_type).toLowerCase();return o==="weekday"?c>=1&&c<=5:o==="weekend"?c===0||c===6:o==="custom"&&Array.isArray(t.specific_days)?t.specific_days.map(Number).includes(c):!0},Ge=t=>String(t||"").toLowerCase(),Re=(t,i)=>t==null||i==null?!1:String(t)===String(i),yt=t=>{if(typeof t=="boolean")return t;if(t==null)return!1;if(typeof t=="number")return t!==0;const i=String(t).trim().toLowerCase();return i?["true","1","yes","y"].includes(i)?!0:["false","0","no","n"].includes(i)?!1:!!t:!1},gt=(t={},i=null)=>{if(!i)return!(t.slot_id!=null||Array.isArray(t.slot_ids)&&t.slot_ids.length||t.specific_time||t.time_from&&t.time_to);const c=[];if(t.slot_id!=null&&c.push(t.slot_id),Array.isArray(t.slot_ids)&&c.push(...t.slot_ids),t.target_slot_id!=null&&c.push(t.target_slot_id),c.length){const m=[i.slot_id,i.id,i._id,i.combo_slot_id].filter(n=>n!=null);if(!c.some(n=>m.some(M=>Re(n,M))))return!1}const o=i.start_time||i.time||i.startTime||null;if(t.specific_time&&o&&o.slice(0,5)!==String(t.specific_time).slice(0,5))return!1;if(t.time_from&&t.time_to&&o){const m=he(o),f=he(t.time_from),n=he(t.time_to);if(m==null||f==null||n==null||m<f||m>n)return!1}return!0},ht=(t,{targetType:i,targetId:c,date:o,slot:m})=>{if(!t||!i||!c)return!1;const f=y(o).format("YYYY-MM-DD"),n=Ge(t.target_type),M=Ge(i);if(n&&M&&n!==M)return!1;if(!yt(t.applies_to_all)){const N=[];if(t.target_id!=null&&N.push(t.target_id),Array.isArray(t.target_ids)&&N.push(...t.target_ids),!N.length||!N.some(v=>Re(v,c)))return!1}return!(t.specific_date&&f!==t.specific_date||Array.isArray(t.specific_dates)&&t.specific_dates.length&&!t.specific_dates.some(N=>y(N).format("YYYY-MM-DD")===f)||t.date_from&&f<t.date_from||t.date_to&&f>t.date_to||!ft(t,f)||!gt(t,m))},pt=(t={},i=null,c=0)=>{const o=Number(c);if(!o||o<=0)return 0;let m=(i==null?void 0:i.rule_discount_type)||t.discount_type||(t.discount_percent?"percent":null),f=(i==null?void 0:i.rule_discount_value)??t.discount_value??t.discount_percent??0;if(!m||!f)return 0;m=String(m).toLowerCase();let n=m==="amount"?Number(f):Number(f)/100*o;return Number.isFinite(Number(t.max_discount))&&(n=Math.min(n,Number(t.max_discount))),n=Math.min(n,o),Math.max(0,n)},bt=(t=[],{targetType:i,targetId:c,date:o,slot:m,basePrice:f})=>{if(!Array.isArray(t)||!t.length||!f||!c)return null;let n=null;return t.forEach(M=>{(Array.isArray(M.rules)&&M.rules.length?M.rules:[null]).forEach(N=>{if(N&&!ht(N,{targetType:i,targetId:c,date:o,slot:m}))return;const v=pt(M,N,f);if(!v)return;const C=Math.max(0,f-v);(!n||C<n.price)&&(n={offer:M,rule:N,price:C,discount:v})})}),n},pe=(t,i)=>{if(!t||!i)return!0;const c=y().format("YYYY-MM-DD"),o=y(i).format("YYYY-MM-DD");if(o>c)return!0;if(o===c){const m=y(),f=t.start_time||t.time||null;if(!f)return!0;const[n,M]=f.split(":").map(Number),g=(n||0)*60+(M||0),v=m.hour()*60+m.minute()+60;return g>=v}return!1},Ue=(t,i="")=>t?typeof t=="string"?H(t,i):H(t.url||t.image_url,i):i;function Ft(){var Ce,Ae,Se,Te,$e,Be,Le;const{id:t}=rt(),i=at(),c=nt(),o=d.useMemo(()=>!t||t==="undefined"||t==="null"?null:t,[t]),[m,f]=d.useState({status:"idle",data:null,error:null}),[n,M]=d.useState(T()),[g,N]=d.useState({status:"idle",items:[],error:null}),[v,C]=d.useState(""),[J,V]=d.useState(1),[be,Z]=d.useState(!1),[He,Ve]=d.useState(null),W=d.useMemo(()=>null,[He,be]),U=d.useCallback(s=>{M(s),C("")},[]),je=d.useCallback(()=>{U(T())},[U]),Ne=d.useCallback(()=>{U(y().add(1,"day").format("YYYY-MM-DD"))},[U]),ve=d.useCallback(s=>{s.preventDefault(),s.stopPropagation(),Ve(s.currentTarget),Z(!0)},[]),We=d.useCallback(s=>{U(s),Z(!1)},[U]),[we,q]=d.useState(null),[Y,O]=d.useState({status:"idle",items:[],error:null}),[K,oe]=d.useState({status:"idle",items:[],error:null});d.useEffect(()=>{o||f({status:"failed",data:null,error:"Invalid attraction id"})},[o]);const $=d.useMemo(()=>Number(o)||null,[o]),_e=d.useCallback(s=>{if(!s)return()=>{};let r=!1;return O({status:"loading",items:[],error:null}),console.log("Debug - Loading gallery for attraction ID:",s),(async()=>{var u;try{const x=await ae.get(ne.gallery.list(),{params:{active:!0,target_type:"attraction",target_ref_id:s,limit:12}});if(r)return;const _=((u=x==null?void 0:x.data)==null?void 0:u.data)||(Array.isArray(x==null?void 0:x.data)?x.data:Array.isArray(x)?x:[]);console.log("Debug - Raw gallery response:",x),console.log("Debug - Processed gallery items:",_),console.log("Debug - Expected target ID:",s);const re=_.filter(p=>{const D=String((p==null?void 0:p.target_type)||"").toLowerCase(),F=p==null?void 0:p.target_ref_id,z=D==="attraction",G=F&&(F===s||String(F)===String(s)||Number(F)===Number(s));return(!z||!G)&&console.warn("Debug - Filtering out invalid gallery item:",{item:p,itemTargetType:D,itemTargetId:F,targetId:s,typeMatches:z,idMatches:G}),z&&G});console.log("Debug - Validated gallery items for attraction",s,":",re);const Q=re.sort((p,D)=>p.created_at&&D.created_at?new Date(p.created_at)-new Date(D.created_at):p.id&&D.id?p.id-D.id:p.gallery_item_id&&D.gallery_item_id?p.gallery_item_id-D.gallery_item_id:0);console.log("Debug - Final sorted gallery items:",Q),O({status:"succeeded",items:Q,error:null})}catch(x){if(r)return;console.log("Debug - Gallery loading error:",x),O({status:"failed",items:[],error:(x==null?void 0:x.message)||"Failed to load gallery"})}})(),()=>{r=!0}},[]);d.useEffect(()=>{if(console.log("Debug - Gallery loading effect triggered. numericAttrId:",$),O({status:"loading",items:[],error:null}),!$)return console.log("Debug - No numericAttrId, setting gallery to idle"),O({status:"idle",items:[],error:null}),()=>{};const s=setTimeout(()=>_e($),100);return()=>{clearTimeout(s)}},[$,_e]),d.useEffect(()=>{if(!o)return;f({status:"loading",data:null,error:null});const s=new AbortController;return(async()=>{try{const r=await ae.get(ne.attractions.byId(o),{signal:s.signal}),u=(r==null?void 0:r.attraction)||r||null;f({status:"succeeded",data:u,error:null})}catch(r){if(r!=null&&r.canceled)return;f({status:"failed",data:null,error:(r==null?void 0:r.message)||"Failed to load attraction"})}})(),()=>s.abort()},[o]);const ke=d.useCallback(async()=>{if(!o||!n)return;N(r=>({...r,status:"loading",error:null,items:[]}));const s=new AbortController;try{const r=await ae.get(ne.slots.list(),{params:{attraction_id:o,date:le(n)},signal:s.signal}),u=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];N({status:"succeeded",items:u,error:null});const x=u.find(_=>pe(_,n))||u[0]||null;C(x?ie(x,0):"")}catch(r){if(r!=null&&r.canceled)return;N({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load slots"})}return()=>s.abort()},[o,n]);d.useEffect(()=>{o&&n?(C(""),ke()):N({status:"idle",items:[],error:null})},[o,n,ke]),d.useEffect(()=>{if(!o||K.status==="loading")return;let s=!1;return oe(r=>({...r,status:"loading",error:null})),(async()=>{try{const r=await ae.get(ne.offers.list(),{params:{active:!0,target_type:"attraction",target_id:o}});if(s)return;const u=Array.isArray(r==null?void 0:r.data)?r.data:Array.isArray(r)?r:[];oe({status:"succeeded",items:u,error:null})}catch(r){if(s)return;oe({status:"failed",items:[],error:(r==null?void 0:r.message)||"Failed to load offers"})}})(),()=>{s=!0}},[o,K.status]);const a=m.data,B=(a==null?void 0:a.name)||(a==null?void 0:a.title)||"Attraction",qe=`https://picsum.photos/seed/attr${o}/1920/800`,Oe=`https://picsum.photos/seed/attr${o}/800/600`,[Ke,Qe]=d.useState(typeof window<"u"?window.innerWidth>=1024:!1);d.useEffect(()=>{if(typeof window>"u")return;const s=()=>Qe(window.innerWidth>=1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const Xe=H((a==null?void 0:a.desktop_image_url)||(a==null?void 0:a.hero_image)||(a==null?void 0:a.banner_image)||(a==null?void 0:a.image_web)||(a==null?void 0:a.image_url)||a,qe),Je=H((a==null?void 0:a.mobile_image)||(a==null?void 0:a.image_mobile)||(a==null?void 0:a.image_url)||a,Oe),A=Ke?Xe:Je,Me=d.useMemo(()=>{const r=(Y.items||[]).map(u=>({...u,image_url:Ue(u)||H(u.image_url||u.url||u,"")}));return A?[{image_url:A,isCover:!0},...r]:r},[Y.items,A]),h=d.useMemo(()=>(Y.items||[]).map(r=>({...r,image_url:Ue(r)||H(r.image_url||r.url||r,"")})),[Y.items]);d.useEffect(()=>{console.log("Debug - Attraction ID:",$),console.log("Debug - Attraction Data:",a),console.log("Debug - Cover URL:",A),console.log("Debug - Gallery Items:",Y.items),console.log("Debug - Hero Gallery Items:",Me),console.log("Debug - Gallery Viewer Items:",h)},[$,a,A,Y.items,Me,h]);const De=A||((Ce=h[0])==null?void 0:Ce.image_url)||null;(Ae=h[0])!=null&&Ae.image_url,(Se=h[1])!=null&&Se.image_url||(Te=h[0])!=null&&Te.image_url,h.length;const l=d.useMemo(()=>{for(let s=0;s<g.items.length;s+=1){const r=g.items[s];if(ie(r,s)===v)return r}return null},[g.items,v]),L=Number(ct(a)||0),Ye=Number(dt(a)||L),ce=(l==null?void 0:l.pricing)||{},Ie=(l==null?void 0:l.offer)||null,Ze=l?mt(l,Ye):Ye,et=l?ye(l,L):L,b=Number(ce.base_price??Ze??0),P=Number(ce.final_price??et??0),R=!!Ie||b>0&&P>0&&P<b&&ce.final_price!=null,tt=R&&b>0?Math.round((b-P)/b*100):0,E=Math.max(1,Number(J)||1),I=d.useMemo(()=>{if(!l||!a||!K.items.length||R)return null;const s=P||b||0;if(!s)return null;const r=Ee(a);return bt(K.items,{targetType:"attraction",targetId:r,date:n,slot:l,basePrice:s})},[a,l,K.items,P,b,n,R]),j=R?P||b:I?I.price:P,w=R?Ie:(I==null?void 0:I.offer)||null,ee=(w==null?void 0:w.description)||"",de=R?tt:I&&b>0?Math.round((b-j)/b*100):ut(a)||0,S=b>0&&j>0&&j<b,me=Number(j||0)*E,ue=()=>{var _;if(!a||!n||!l||!J)return;const s=(l==null?void 0:l.id)??(l==null?void 0:l._id)??(l==null?void 0:l.slot_id);if(!s)return;const r=Ee(a),u=E;c(lt({itemType:"attraction",attractionId:r,attraction:a,date:le(n),booking_date:le(n),booking_time:(l==null?void 0:l.start_time)||(l==null?void 0:l.startTime)||(l==null?void 0:l.slot_start_time)||null,slotId:s,slot:l,qty:u,unitPrice:Number(j??(l==null?void 0:l.price)??b),title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||`Attraction #${r}`,slotLabel:ge(l),dateLabel:y(n).format("DD MMM YYYY"),meta:{title:(a==null?void 0:a.title)||(a==null?void 0:a.name)||`Attraction #${r}`,start_time:l==null?void 0:l.start_time,end_time:l==null?void 0:l.end_time,capacity:l==null?void 0:l.capacity,available:l==null?void 0:l.available},offer_id:w==null?void 0:w.offer_id,offer_rule_id:(w==null?void 0:w.rule_id)||((_=I==null?void 0:I.rule)==null?void 0:_.rule_id)})),c(it(1));const x=new URLSearchParams({type:"attraction",attraction_id:String(r),date:le(n),slot:v,qty:String(u)});i(`/booking?${x.toString()}`)};if(m.status==="loading"&&!a)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white",children:e.jsx(fe,{})});if(m.status==="failed")return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(X,{message:m.error||"Attraction not found"})})});if(!a)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(X,{message:"Attraction not found"})})});const Fe=(a==null?void 0:a.short_description)||(a==null?void 0:a.subtitle)||"",te=l,se=te&&j?j*E:null;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#e0f2fe] via-[#bae6fd] to-white font-sans pb-24 lg:pb-0",children:[e.jsx("section",{className:"mt-0 bg-transparent",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-6 space-y-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",style:{fontFamily:"Inter, sans-serif"},children:B}),e.jsx("div",{className:"overflow-hidden shadow-lg bg-gray-100",children:h.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr] gap-[2px] bg-white",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length&&q(0),children:e.jsxs("div",{className:"md:h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:A,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:B})})]})}),e.jsxs("div",{className:"hidden md:grid grid-rows-2 gap-[2px] h-[420px]",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length>0&&q(0),children:e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:(($e=h[0])==null?void 0:$e.image_url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"})})}),e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length>1&&q(1),children:e.jsxs("div",{className:"w-full h-full overflow-hidden",children:[e.jsx("img",{src:((Be=h[1])==null?void 0:Be.image_url)||((Le=h[0])==null?void 0:Le.image_url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full",children:h.length>1?e.jsxs(e.Fragment,{children:["1 / ",h.length]}):null})]})})]})]}):e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length&&q(0),children:e.jsxs("div",{className:"h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:A,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:B})})]})})})]})}),e.jsx("div",{className:"lg:hidden max-w-6xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",style:{fontFamily:"Inter, sans-serif"},children:"Base price"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 rupee",style:{fontFamily:"Inter, sans-serif"},children:k(b||j||0)})]}),S?e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500",style:{fontFamily:"Inter, sans-serif"},children:"Offer price"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 rupee",style:{fontFamily:"Inter, sans-serif"},children:k(j||0)}),ee?e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:ee}):null]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Per person • taxes included"}),w?e.jsxs("span",{className:"mt-1 text-xs font-semibold text-emerald-600 flex items-center gap-1",children:[e.jsxs("span",{children:[w.rule_type==="happy_hour"?"Happy Hour":"Offer"," ","applied:"]}),e.jsx("span",{children:w.title||"Special offer"})]}):null]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"per ticket"}),S&&e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:je,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===T()?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:Ne,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:ve,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n&&n!==T()&&n!==y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:n&&n!==T()&&n!==y().add(1,"day").format("YYYY-MM-DD")?y(n).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),g.status==="loading"?e.jsx("div",{className:"py-3",children:e.jsx(fe,{size:"sm"})}):g.status==="failed"?e.jsx("div",{className:"py-3",children:e.jsx(X,{message:g.error||"Failed to load slots"})}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:v,onChange:s=>C(s.target.value),disabled:!g.items.length,style:{fontFamily:"Inter, sans-serif"},children:g.items.length?e.jsxs(e.Fragment,{children:[!v&&e.jsx("option",{value:"",children:"Select slot"}),g.items.filter(s=>pe(s,n)).map((s,r)=>{const u=ie(s,r),x=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0,_=ye(s,L)||L||0;return e.jsxs("option",{value:u,disabled:x,children:[ge(s),_?` • ${k(_)}`:"",x?" — Unavailable":""]},u)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:J,readOnly:!0,className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm bg-gray-50",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[E," × ",k(j||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:k(me||0)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:se?e.jsxs(e.Fragment,{children:["Book Now •"," ",e.jsx("span",{className:"ml-1 rupee",children:k(se)})]}):"Book Now"})]})}),e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8 md:py-12 mt-0",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10 md:gap-12",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:m.status==="failed"?e.jsx(X,{message:m.error}):e.jsxs(e.Fragment,{children:[Fe?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:e.jsx("p",{className:"text-gray-700 text-base md:text-lg",style:{fontFamily:"Inter, sans-serif"},children:Fe})}):null,a!=null&&a.description?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"About this attraction"}),e.jsx("div",{className:"prose prose-sm md:prose max-w-none text-gray-700 leading-relaxed text-left",style:{fontFamily:"Inter, sans-serif"},dangerouslySetInnerHTML:{__html:a.description}})]}):null,Y.items&&Y.items.length>0?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:e.jsxs(Pe,{to:`/gallery?attraction=${$}`,className:"inline-flex items-center gap-2 text-sky-600 hover:text-sky-700 font-medium transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"View ",Y.items.length," Gallery ",Y.items.length===1?"Image":"Images"]})}):null]})}),e.jsx("aside",{className:"hidden lg:block lg:col-span-1",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 sticky top-24 space-y-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",style:{fontFamily:"Inter, sans-serif"},children:"Base price"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 rupee",style:{fontFamily:"Inter, sans-serif"},children:k(b||j||0)})]}),S?e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500",style:{fontFamily:"Inter, sans-serif"},children:"Offer price"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 rupee",style:{fontFamily:"Inter, sans-serif"},children:k(j||0)}),ee?e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:ee}):null]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Per person • taxes included"}),w?e.jsxs("span",{className:"mt-1 text-xs font-semibold text-emerald-600 flex items-center gap-1",children:[e.jsxs("span",{children:[w.rule_type==="happy_hour"?"Happy Hour":"Offer"," ","applied:"]}),e.jsx("span",{children:w.title||"Special offer"})]}):null]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"per ticket"}),S&&e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:je,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===T()?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:Ne,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:ve,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n&&n!==T()&&n!==y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:n&&n!==T()&&n!==y().add(1,"day").format("YYYY-MM-DD")?y(n).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),g.status==="loading"?e.jsx("div",{className:"py-2",children:e.jsx(fe,{size:"sm"})}):g.status==="failed"?e.jsx(X,{message:g.error||"Failed to load slots"}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:v,onChange:s=>C(s.target.value),disabled:!g.items.length,style:{fontFamily:"Inter, sans-serif"},children:g.items.length?e.jsxs(e.Fragment,{children:[!v&&e.jsx("option",{value:"",children:"Select slot"}),g.items.filter(s=>pe(s,n)).map((s,r)=>{const u=ie(s,r),x=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0,_=ye(s,L)||L||0;return e.jsxs("option",{value:u,disabled:x,children:[ge(s),_?` • ${k(_)}`:"",x?" — Unavailable":""]},u)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:J,onChange:s=>V(Math.max(1,Number(s.target.value)||1)),className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[E," × ",k(j||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:k(me||0)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:se?e.jsxs(e.Fragment,{children:["Book Now •"," ",e.jsx("span",{className:"ml-1 rupee",children:k(se)})]}):"Book Now"})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsx("p",{className:"text-gray-600",style:{fontFamily:"Inter, sans-serif"},children:"Slots and pricing may vary by date and time. Use the options above to choose your preferred session."}),e.jsx(Pe,{to:"/attractions",className:"inline-flex items-center justify-center rounded-full border border-blue-100 text-blue-600 px-5 py-2.5 text-sm font-medium hover:bg-blue-50",style:{fontFamily:"Inter, sans-serif"},children:"Explore other attractions"})]}),e.jsx("p",{className:"text-[11px] text-gray-400 text-center",children:"We'll add this to your cart so you can add more attractions before checkout."})]})})]})}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-[70] border-t border-gray-200 bg-white/95 backdrop-blur",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3 pb-[calc(env(safe-area-inset-bottom)+12px)]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",children:S?"Offer price":"Base price"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 rupee",children:k(S?j||0:b||j||0)}),S?e.jsx("div",{className:"text-sm text-gray-400 line-through rupee",children:k(b||0)}):null,S?e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]}):null]}),e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[E," ticket",E>1?"s":""," • Total"," ",e.jsx("span",{className:"rupee font-semibold text-gray-800",children:k(me||0)})]})]}),e.jsx("button",{type:"button",className:"shrink-0 inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-5 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:"Book Now"})]})})})]}),be&&e.jsxs("div",{className:"fixed inset-0 z-[80] flex",onClick:()=>Z(!1),children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"absolute bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 w-80 max-h-[70vh] overflow-y-auto",style:{top:W?`${W.top}px`:"50%",left:W?`${W.left-160}px`:"50%",transform:W?"none":"translate(-50%, -50%)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Select Date"}),e.jsx("button",{type:"button",onClick:()=>Z(!1),className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors",children:e.jsx(xt,{size:18})})]}),e.jsx("div",{className:"space-y-3",children:[0,1,2].map(s=>{const r=y().add(s,"month"),u=r.startOf("month"),x=r.endOf("month"),_=u.day(),re=x.date(),Q=y();return e.jsxs("div",{className:"border border-gray-100 rounded-xl p-3 bg-white",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:r.format("MMMM YYYY")}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-xs",children:[["S","M","T","W","T","F","S"].map(p=>e.jsx("div",{className:"text-center text-gray-400 font-medium py-2",children:p},p)),Array.from({length:_}).map((p,D)=>e.jsx("div",{className:"p-2"},`empty-${D}`)),Array.from({length:re}).map((p,D)=>{const F=u.date(D+1),z=F.format("YYYY-MM-DD"),G=F.isBefore(Q,"day"),xe=n===z,st=F.isSame(Q,"day");return e.jsx("button",{type:"button",onClick:()=>We(z),disabled:G,className:`
                              p-2 rounded-lg text-sm font-medium transition-all duration-200
                              ${G?"text-gray-300 cursor-not-allowed bg-gray-50":""}
                              ${xe?"bg-sky-600 text-white shadow-sm scale-105":""}
                              ${!G&&!xe?"hover:bg-sky-50 text-gray-700 hover:text-sky-700":""}
                              ${st&&!xe?"bg-sky-100 text-sky-700 font-semibold border border-sky-200":""}
                            `,children:D+1},z)})]})]},s)})})]})]}),we!==null&&h.length>0&&e.jsx(ot,{items:h,initialIndex:we,onClose:()=>q(null)})]})}export{Ft as default};
