import{D as j,C as f,R as n,j as a}from"./index-C5Mz9dTM.js";import{a as p}from"./AdminApp-C7IcGGGV.js";import"./createLucideIcon-DQ6FqzLt.js";import"./file-text-CQ7rExmv.js";import"./ticket-C3bgGsni.js";function v(r){if(!r)return"";const[s,l]=String(r).split(":");return`${s==null?void 0:s.padStart(2,"0")}:${l==null?void 0:l.padStart(2,"0")}`}function _(r){if(!r)return"";const[s,l]=String(r).split(":");let c=Number(s);const t=Number(l),m=c>=12?"pm":"am";let o=c%12;return o===0&&(o=12),`${String(o).padStart(2,"0")}.${String(t).padStart(2,"0")}${m}`}function E(){const{id:r}=j(),s=f(),[l,c]=n.useState([]),[t,m]=n.useState({combo_id:"",start_date:"",end_date:"",start_time:"",end_time:"",capacity:"",price:"",available:!0}),[o,g]=n.useState(!!r),[h,u]=n.useState(""),b=!!r;n.useEffect(()=>{(async()=>{const e=await p.get("/api/admin/combos",{active:!0}),i=Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e)?e:[];c(i)})()},[]),n.useEffect(()=>{r&&(async()=>{try{g(!0),u("");const e=await p.get(`/api/admin/combo-slots/${r}`);m({combo_id:e.combo_id||"",start_date:e.start_date||"",end_date:e.end_date||e.start_date||"",start_time:v(e.start_time),end_time:v(e.end_time),capacity:e.capacity??"",price:e.price??"",available:!!e.available})}catch(e){u(e.message||"Failed to load")}finally{g(!1)}})()},[r]);const d=(e,i)=>m(x=>({...x,[e]:i})),y=async e=>{e.preventDefault(),u("");const i={combo_id:Number(t.combo_id),start_date:t.start_date,end_date:t.end_date||t.start_date,start_time:_(t.start_time),end_time:_(t.end_time),capacity:Number(t.capacity),price:t.price===""||t.price==null?null:Number(t.price),available:!!t.available};try{b?await p.put(`/api/admin/combo-slots/${r}`,i):await p.post("/api/admin/combo-slots",i),s("/admin/catalog/combo-slots")}catch(x){u(x.message||"Save failed")}};return o?a.jsx("div",{className:"p-3 text-sm",children:"Loadingâ€¦"}):a.jsxs("form",{onSubmit:y,className:"max-w-xl space-y-3",children:[a.jsx("div",{className:"text-lg font-semibold",children:b?"Edit Combo Slot":"Create Combo Slot"}),h?a.jsx("div",{className:"text-sm text-red-600",children:h}):null,a.jsx("label",{className:"block text-sm",children:"Combo"}),a.jsxs("select",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.combo_id,onChange:e=>d("combo_id",e.target.value),required:!0,children:[a.jsx("option",{value:"",children:"Select combo"}),l.map(e=>a.jsx("option",{value:e.combo_id,children:e.title||`Combo #${e.combo_id}`},e.combo_id))]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Start date"}),a.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.start_date,onChange:e=>d("start_date",e.target.value),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"End date"}),a.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.end_date,onChange:e=>d("end_date",e.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Start time"}),a.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.start_time,onChange:e=>d("start_time",e.target.value),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"End time"}),a.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.end_time,onChange:e=>d("end_time",e.target.value),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Capacity"}),a.jsx("input",{type:"number",min:"1",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.capacity,onChange:e=>d("capacity",e.target.value),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm",children:"Price (optional)"}),a.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:t.price,onChange:e=>d("price",e.target.value)})]}),a.jsx("div",{className:"flex items-end",children:a.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[a.jsx("input",{type:"checkbox",checked:!!t.available,onChange:e=>d("available",e.target.checked)}),"Available"]})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"px-3 py-2 rounded-md bg-gray-900 text-white",type:"submit",children:b?"Update":"Create"}),a.jsx("button",{className:"px-3 py-2 rounded-md border",type:"button",onClick:()=>s("/admin/catalog/combo-slots"),children:"Cancel"})]})]})}export{E as default};
