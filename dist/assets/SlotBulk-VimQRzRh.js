import{B as v,R as d,j as e}from"./index-D_x0VcQ4.js";import{a as x,A as b}from"./AdminApp-Ct7HyYhZ.js";import"./createLucideIcon-CDLCmtzs.js";import"./file-text-B8djhIpu.js";import"./ticket-5vjBYnJB.js";function S(){const p=v(),[a,g]=d.useState({attraction_id:"",start_date:"",end_date:"",start_time:"",end_time:"",duration_minutes:60,capacity:0,price:"",available:!0}),[c,n]=d.useState("idle"),[u,o]=d.useState(null),[s,m]=d.useState(null),[h,k]=d.useState([]),l=(t,r)=>g(i=>({...i,[t]:r}));d.useEffect(()=>{(async()=>{try{const t=await x.get(b.attractions()),r=Array.isArray(t==null?void 0:t.data)?t.data:Array.isArray(t)?t:[];k(r)}catch{}})()},[]);const y=async t=>{t.preventDefault(),n("loading"),o(null),m(null);try{const r={attraction_id:a.attraction_id,start_date:a.start_date,end_date:a.end_date,start_time:a.start_time,end_time:a.end_time,duration_minutes:Number(a.duration_minutes||0),capacity:Number(a.capacity||0),price:a.price===""?null:Number(a.price),available:!!a.available},i=await x.post(b.slotsBulk(),r);m(i),n("succeeded")}catch(r){o((r==null?void 0:r.message)||"Bulk creation failed"),n("failed")}};return e.jsxs("form",{onSubmit:y,className:"max-w-2xl bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-xl p-4",children:[e.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Bulk Create Slots"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Attraction"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.attraction_id,onChange:t=>l("attraction_id",t.target.value),required:!0,children:[e.jsx("option",{value:"",children:"— Select attraction —"}),h.map(t=>e.jsx("option",{value:t.attraction_id,children:t.title},t.attraction_id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Capacity"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.capacity,onChange:t=>l("capacity",Number(t.target.value||0))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.start_date,onChange:t=>l("start_date",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.end_date,onChange:t=>l("end_date",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Start Time"}),e.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.start_time,onChange:t=>l("start_time",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"End Time"}),e.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.end_time,onChange:t=>l("end_time",t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Duration Minutes"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.duration_minutes,onChange:t=>l("duration_minutes",Number(t.target.value||0))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Price (optional)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:a.price,onChange:t=>l("price",t.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 md:col-span-2",children:[e.jsx("input",{id:"available",type:"checkbox",checked:!!a.available,onChange:t=>l("available",t.target.checked)}),e.jsx("label",{htmlFor:"available",className:"text-sm text-gray-700 dark:text-neutral-200",children:"Available"})]})]}),u?e.jsx("div",{className:"mt-3 text-sm text-red-600",children:u}):null,s?e.jsxs("div",{className:"mt-3 text-sm text-gray-700 dark:text-neutral-200",children:[e.jsxs("div",{children:["Created: ",s.created||0]}),e.jsxs("div",{children:["Skipped: ",s.skipped||0]}),Array.isArray(s.conflicts)&&s.conflicts.length?e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"font-medium",children:"Conflicts"}),e.jsx("ul",{className:"list-disc pl-5",children:s.conflicts.slice(0,100).map((t,r)=>e.jsxs("li",{children:[t.date," ",t.start_time," - ",t.end_time]},r))})]}):null]}):null,e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{type:"submit",className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm",disabled:c==="loading",children:c==="loading"?"Creating…":"Create Slots"}),e.jsx("button",{type:"button",className:"rounded-md border px-4 py-2 text-sm",onClick:()=>p(-1),children:"Cancel"})]})]})}export{S as default};
