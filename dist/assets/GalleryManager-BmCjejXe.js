import{B as p,R as n,j as a}from"./index-Buz5vlJT.js";import{a as x,A as g}from"./AdminApp-DjyjDDmt.js";import{A as f}from"./AdminTable-BEVjuUza.js";import{i as h}from"./media-DTTax9V0.js";import"./createLucideIcon-BEwYts5j.js";import"./file-text-CuRCFKVY.js";import"./ticket-B65mU2v0.js";const j=t=>Array.isArray(t)?t:[],b=t=>t?Array.isArray(t)?{items:t,meta:null}:Array.isArray(t==null?void 0:t.data)?{items:t.data,meta:t.meta||null}:t!=null&&t.data&&typeof t.data=="object"&&Array.isArray(t.data.data)?{items:t.data.data,meta:t.data.meta||t.meta||null}:{items:j(t.items||t.list),meta:t.meta||null}:{items:[],meta:null};function R(){var o;const t=p(),[s,m]=n.useState({status:"idle",items:[],error:null}),[i,c]=n.useState({q:"",type:""}),r=n.useCallback(async(e=i)=>{m(l=>({...l,status:"loading",error:null}));try{const l={q:e.q||void 0,type:e.type||void 0},d=await x.get(g.gallery(),{params:l}),{items:y}=b(d);m({status:"succeeded",items:y,error:null})}catch(l){m(d=>({...d,status:"failed",error:l}))}},[i]);n.useEffect(()=>{r(i)},[r,i]);const u=[{key:"preview",title:"Preview",render:e=>{const l=e.media_type==="video"||e.url&&e.url.match(/\.(mp4|webm|ogg)$/i),d=e.media_type==="pdf"||e.url&&e.url.match(/\.pdf$/i);return a.jsx("div",{className:"w-20 h-14 rounded-md overflow-hidden bg-gray-100",children:l?a.jsx("video",{src:e.url,className:"w-full h-full object-cover",muted:!0}):d?a.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-gray-500",children:"PDF"}):a.jsx("img",{src:h(e)||e.url,alt:e.title||"Gallery media",className:"w-full h-full object-cover",loading:"lazy"})})}},{key:"title",title:"Title"},{key:"media_type",title:"Type"},{key:"status",title:"Status"},{key:"priority",title:"Priority"},{key:"created_at",title:"Created"},{key:"updated_at",title:"Updated"}];return a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Gallery"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Manage homepage and gallery media assets."})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{className:"rounded-md border px-3 py-2 text-sm",onClick:()=>t("/admin/catalog/banners"),children:"Manage Banners"}),a.jsx("button",{className:"rounded-md bg-gray-900 text-white px-3 py-2 text-sm",onClick:()=>t("/admin/catalog/gallery/new"),children:"Add Media"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-4",children:[a.jsx("input",{className:"rounded-md border px-3 py-2",placeholder:"Search title",value:i.q,onChange:e=>c(l=>({...l,q:e.target.value}))}),a.jsxs("select",{className:"rounded-md border px-3 py-2",value:i.type,onChange:e=>c(l=>({...l,type:e.target.value})),children:[a.jsx("option",{value:"",children:"Type: All"}),a.jsx("option",{value:"image",children:"Images"}),a.jsx("option",{value:"video",children:"Videos"}),a.jsx("option",{value:"pdf",children:"PDFs"})]}),a.jsx("button",{className:"rounded-md border px-3 py-2 text-sm",onClick:()=>r(i),disabled:s.status==="loading",children:"Apply"}),a.jsx("button",{className:"rounded-md border px-3 py-2 text-sm",onClick:()=>{c({q:"",type:""}),r({q:"",type:""})},children:"Reset"})]}),s.status==="failed"&&a.jsxs("div",{className:"mb-4 rounded-md border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-600",children:["Failed to load gallery items. ",((o=s.error)==null?void 0:o.message)||""]}),a.jsx(f,{keyField:"gallery_item_id",columns:u,rows:s.items,onRowClick:e=>{const l=(e==null?void 0:e.gallery_item_id)??(e==null?void 0:e.gallery_id)??(e==null?void 0:e.id);l!=null&&t(`/admin/catalog/gallery/${l}`)},empty:s.status==="loading"?"Loadingâ€¦":"No media found"})]})}export{R as default};
