import{C as j,A as f,R as n,j as t}from"./index-CmreT6x1.js";import{a as p}from"./AdminApp-BV7zANWg.js";import"./createLucideIcon-CgZNF2TE.js";import"./file-text-ButRzfWA.js";import"./newspaper-yOb_4zvd.js";import"./ticket-hq6RMmhb.js";import"./chevron-down-bqKWLlrR.js";function v(r){if(!r)return"";const[s,l]=String(r).split(":");return`${s==null?void 0:s.padStart(2,"0")}:${l==null?void 0:l.padStart(2,"0")}`}function _(r){if(!r)return"";const[s,l]=String(r).split(":");let c=Number(s);const a=Number(l),m=c>=12?"pm":"am";let o=c%12;return o===0&&(o=12),`${String(o).padStart(2,"0")}.${String(a).padStart(2,"0")}${m}`}function A(){const{id:r}=j(),s=f(),[l,c]=n.useState([]),[a,m]=n.useState({combo_id:"",start_date:"",end_date:"",start_time:"",end_time:"",capacity:"",price:"",available:!0}),[o,g]=n.useState(!!r),[h,u]=n.useState(""),b=!!r;n.useEffect(()=>{(async()=>{const e=await p.get("/api/admin/combos",{active:!0}),i=Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e)?e:[];c(i)})()},[]),n.useEffect(()=>{r&&(async()=>{try{g(!0),u("");const e=await p.get(`/api/admin/combo-slots/${r}`);m({combo_id:e.combo_id||"",start_date:e.start_date||"",end_date:e.end_date||e.start_date||"",start_time:v(e.start_time),end_time:v(e.end_time),capacity:e.capacity??"",price:e.price??"",available:!!e.available})}catch(e){u(e.message||"Failed to load")}finally{g(!1)}})()},[r]);const d=(e,i)=>m(x=>({...x,[e]:i})),y=async e=>{e.preventDefault(),u("");const i={combo_id:Number(a.combo_id),start_date:a.start_date,end_date:a.end_date||a.start_date,start_time:_(a.start_time),end_time:_(a.end_time),capacity:Number(a.capacity),price:a.price===""||a.price==null?null:Number(a.price),available:!!a.available};try{b?await p.put(`/api/admin/combo-slots/${r}`,i):await p.post("/api/admin/combo-slots",i),s("/admin/catalog/combo-slots")}catch(x){u(x.message||"Save failed")}};return o?t.jsx("div",{className:"p-3 text-sm",children:"Loadingâ€¦"}):t.jsxs("form",{onSubmit:y,className:"max-w-xl space-y-3",children:[t.jsx("div",{className:"text-lg font-semibold",children:b?"Edit Combo Slot":"Create Combo Slot"}),h?t.jsx("div",{className:"text-sm text-red-600",children:h}):null,t.jsx("label",{className:"block text-sm",children:"Combo"}),t.jsxs("select",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.combo_id,onChange:e=>d("combo_id",e.target.value),required:!0,children:[t.jsx("option",{value:"",children:"Select combo"}),l.map(e=>t.jsx("option",{value:e.combo_id,children:e.title||`Combo #${e.combo_id}`},e.combo_id))]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"Start date"}),t.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.start_date,onChange:e=>d("start_date",e.target.value),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"End date"}),t.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.end_date,onChange:e=>d("end_date",e.target.value)})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"Start time"}),t.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.start_time,onChange:e=>d("start_time",e.target.value),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"End time"}),t.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.end_time,onChange:e=>d("end_time",e.target.value),required:!0})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"Capacity"}),t.jsx("input",{type:"number",min:"1",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.capacity,onChange:e=>d("capacity",e.target.value),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm",children:"Price (optional)"}),t.jsx("input",{type:"number",step:"0.01",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700",value:a.price,onChange:e=>d("price",e.target.value)})]}),t.jsx("div",{className:"flex items-end",children:t.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[t.jsx("input",{type:"checkbox",checked:!!a.available,onChange:e=>d("available",e.target.checked)}),"Available"]})})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"px-3 py-2 rounded-md bg-gray-900 text-white",type:"submit",children:b?"Update":"Create"}),t.jsx("button",{className:"px-3 py-2 rounded-md border",type:"button",onClick:()=>s("/admin/catalog/combo-slots"),children:"Cancel"})]})]})}export{A as default};
