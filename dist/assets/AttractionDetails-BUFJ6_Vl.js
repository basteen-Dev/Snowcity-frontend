import{C as rt,B as at,h as nt,R as u,D as y,i as ae,k as ne,j as e,A as fe,L as Pe,E as lt,F as it}from"./index-uOjPOlE7.js";import{E as X}from"./ErrorState-Cdb-EBN8.js";import{G as ot}from"./GalleryViewer-BqX71pDm.js";import{g as Ee}from"./ids-YExsbyMi.js";import{i as H}from"./media-D2Wlcy5m.js";import{g as ct,a as dt,c as mt,d as ye,b as ut}from"./pricing-CIeFTiJd.js";import{f as M}from"./formatters-CmiLqhJj.js";import{X as xt}from"./x-fQl7BoGX.js";import"./createLucideIcon-2KnKMZCN.js";const le=t=>y(t).format("YYYY-MM-DD"),$=()=>y().format("YYYY-MM-DD"),ie=(t,l)=>String((t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.slot_id)??`${(t==null?void 0:t.start_time)||""}-${(t==null?void 0:t.end_time)||""}-${l}`),ze=t=>{if(!t)return"";const[l,m]=t.split(":"),d=parseInt(l,10),x=d>=12?"PM":"AM";return`${d%12||12}:${m} ${x}`},ge=t=>{if(t!=null&&t.label)return t.label;const l=ze(t==null?void 0:t.start_time),m=ze(t==null?void 0:t.end_time);return l&&m?`${l} - ${m}`:l||`Slot #${(t==null?void 0:t.id)??(t==null?void 0:t._id)??(t==null?void 0:t.slot_id)??"?"}`},he=t=>{if(!t||typeof t!="string")return null;const[l="0",m="0"]=t.split(":"),d=Number(l),x=Number(m);return!Number.isFinite(d)||!Number.isFinite(x)?null:d*60+x},ft=(t={},l)=>{if(!t.day_type)return!0;const m=y(l).day(),d=String(t.day_type).toLowerCase();return d==="weekday"?m>=1&&m<=5:d==="weekend"?m===0||m===6:d==="custom"&&Array.isArray(t.specific_days)?t.specific_days.map(Number).includes(m):!0},Ge=t=>String(t||"").toLowerCase(),Re=(t,l)=>t==null||l==null?!1:String(t)===String(l),yt=t=>{if(typeof t=="boolean")return t;if(t==null)return!1;if(typeof t=="number")return t!==0;const l=String(t).trim().toLowerCase();return l?["true","1","yes","y"].includes(l)?!0:["false","0","no","n"].includes(l)?!1:!!t:!1},gt=(t={},l=null)=>{if(!l)return!(t.slot_id!=null||Array.isArray(t.slot_ids)&&t.slot_ids.length||t.specific_time||t.time_from&&t.time_to);const m=[];if(t.slot_id!=null&&m.push(t.slot_id),Array.isArray(t.slot_ids)&&m.push(...t.slot_ids),t.target_slot_id!=null&&m.push(t.target_slot_id),m.length){const x=[l.slot_id,l.id,l._id,l.combo_slot_id].filter(n=>n!=null);if(!m.some(n=>x.some(D=>Re(n,D))))return!1}const d=l.start_time||l.time||l.startTime||null;if(t.specific_time&&d&&d.slice(0,5)!==String(t.specific_time).slice(0,5))return!1;if(t.time_from&&t.time_to&&d){const x=he(d),f=he(t.time_from),n=he(t.time_to);if(x==null||f==null||n==null||x<f||x>n)return!1}return!0},ht=(t,{targetType:l,targetId:m,date:d,slot:x})=>{if(!t||!l||!m)return!1;const f=y(d).format("YYYY-MM-DD"),n=Ge(t.target_type),D=Ge(l);if(n&&D&&n!==D)return!1;if(!yt(t.applies_to_all)){const N=[];if(t.target_id!=null&&N.push(t.target_id),Array.isArray(t.target_ids)&&N.push(...t.target_ids),!N.length||!N.some(w=>Re(w,m)))return!1}return!(t.specific_date&&f!==t.specific_date||Array.isArray(t.specific_dates)&&t.specific_dates.length&&!t.specific_dates.some(N=>y(N).format("YYYY-MM-DD")===f)||t.date_from&&f<t.date_from||t.date_to&&f>t.date_to||!ft(t,f)||!gt(t,x))},pt=(t={},l=null,m=0)=>{const d=Number(m);if(!d||d<=0)return 0;let x=(l==null?void 0:l.rule_discount_type)||t.discount_type||(t.discount_percent?"percent":null),f=(l==null?void 0:l.rule_discount_value)??t.discount_value??t.discount_percent??0;if(!x||!f)return 0;x=String(x).toLowerCase();let n=x==="amount"?Number(f):Number(f)/100*d;return Number.isFinite(Number(t.max_discount))&&(n=Math.min(n,Number(t.max_discount))),n=Math.min(n,d),Math.max(0,n)},bt=(t=[],{targetType:l,targetId:m,date:d,slot:x,basePrice:f})=>{if(!Array.isArray(t)||!t.length||!f||!m)return null;let n=null;return t.forEach(D=>{(Array.isArray(D.rules)&&D.rules.length?D.rules:[null]).forEach(N=>{if(N&&!ht(N,{targetType:l,targetId:m,date:d,slot:x}))return;const w=pt(D,N,f);if(!w)return;const A=Math.max(0,f-w);(!n||A<n.price)&&(n={offer:D,rule:N,price:A,discount:w})})}),n},pe=(t,l)=>{if(!t||!l)return!0;const m=y().format("YYYY-MM-DD"),d=y(l).format("YYYY-MM-DD");if(d>m)return!0;if(d===m){const x=y(),f=t.start_time||t.time||null;if(!f)return!0;const[n,D]=f.split(":").map(Number),g=(n||0)*60+(D||0),w=x.hour()*60+x.minute()+60;return g>=w}return!1},Ue=(t,l="")=>t?typeof t=="string"?H(t,l):H(t.url||t.image_url,l):l;function Ft(){var Ce,Ae,Se,Te,$e,Be,Le;const{slug:t}=rt(),l=at(),m=nt(),d=u.useMemo(()=>!t||t==="undefined"||t==="null"?null:t,[t]),[x,f]=u.useState({status:"idle",data:null,error:null}),[n,D]=u.useState($()),[g,N]=u.useState({status:"idle",items:[],error:null}),[w,A]=u.useState(""),[J,V]=u.useState(1),[be,Z]=u.useState(!1),[He,Ve]=u.useState(null),W=u.useMemo(()=>null,[He,be]),U=u.useCallback(s=>{D(s),A("")},[]),je=u.useCallback(()=>{U($())},[U]),Ne=u.useCallback(()=>{U(y().add(1,"day").format("YYYY-MM-DD"))},[U]),ve=u.useCallback(s=>{s.preventDefault(),s.stopPropagation(),Ve(s.currentTarget),Z(!0)},[]),We=u.useCallback(s=>{U(s),Z(!1)},[U]),[we,q]=u.useState(null),[I,O]=u.useState({status:"idle",items:[],error:null}),[K,oe]=u.useState({status:"idle",items:[],error:null});u.useEffect(()=>{d||f({status:"failed",data:null,error:"Invalid attraction slug"})},[d]);const v=u.useMemo(()=>{var s;return((s=x.data)==null?void 0:s.attraction_id)||null},[x.data]),_e=u.useCallback(s=>{if(!s)return()=>{};let a=!1;return O({status:"loading",items:[],error:null}),console.log("Debug - Loading gallery for attraction ID:",s),(async()=>{var o;try{const c=await ae.get(ne.gallery.list(),{params:{active:!0,target_type:"attraction",target_ref_id:s,limit:12}});if(a)return;const k=((o=c==null?void 0:c.data)==null?void 0:o.data)||(Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[]);console.log("Debug - Raw gallery response:",c),console.log("Debug - Processed gallery items:",k),console.log("Debug - Expected target ID:",s);const re=k.filter(p=>{const Y=String((p==null?void 0:p.target_type)||"").toLowerCase(),C=p==null?void 0:p.target_ref_id,z=Y==="attraction",G=C&&(C===s||String(C)===String(s)||Number(C)===Number(s));return(!z||!G)&&console.warn("Debug - Filtering out invalid gallery item:",{item:p,itemTargetType:Y,itemTargetId:C,targetId:s,typeMatches:z,idMatches:G}),z&&G});console.log("Debug - Validated gallery items for attraction",s,":",re);const Q=re.sort((p,Y)=>p.created_at&&Y.created_at?new Date(p.created_at)-new Date(Y.created_at):p.id&&Y.id?p.id-Y.id:p.gallery_item_id&&Y.gallery_item_id?p.gallery_item_id-Y.gallery_item_id:0);console.log("Debug - Final sorted gallery items:",Q),O({status:"succeeded",items:Q,error:null})}catch(c){if(a)return;console.log("Debug - Gallery loading error:",c),O({status:"failed",items:[],error:(c==null?void 0:c.message)||"Failed to load gallery"})}})(),()=>{a=!0}},[]);u.useEffect(()=>{if(console.log("Debug - Gallery loading effect triggered. numericAttrId:",v),O({status:"loading",items:[],error:null}),!v)return console.log("Debug - No numericAttrId, setting gallery to idle"),O({status:"idle",items:[],error:null}),()=>{};const s=setTimeout(()=>_e(v),100);return()=>{clearTimeout(s)}},[v,_e]),u.useEffect(()=>{if(!d)return;f({status:"loading",data:null,error:null});const s=new AbortController;return(async()=>{var a;try{const o=await ae.get(ne.attractions.bySlug(d),{signal:s.signal}),c=(o==null?void 0:o.attraction)||o||null;f({status:"succeeded",data:c,error:null}),document.title=(c==null?void 0:c.meta_title)||(c==null?void 0:c.title)||(c==null?void 0:c.name)||"Attraction Details"}catch(o){if(o!=null&&o.canceled)return;if((o==null?void 0:o.status)===404||((a=o==null?void 0:o.response)==null?void 0:a.status)===404){l("/404",{replace:!0});return}f({status:"failed",data:null,error:(o==null?void 0:o.message)||"Failed to load attraction"})}})(),()=>s.abort()},[d]);const ke=u.useCallback(async()=>{if(!v||!n)return;N(a=>({...a,status:"loading",error:null,items:[]}));const s=new AbortController;try{const a=await ae.get(ne.slots.list(),{params:{attraction_id:v,date:le(n)},signal:s.signal}),o=Array.isArray(a==null?void 0:a.data)?a.data:Array.isArray(a)?a:[];N({status:"succeeded",items:o,error:null});const c=o.find(k=>pe(k,n))||o[0]||null;A(c?ie(c,0):"")}catch(a){if(a!=null&&a.canceled)return;N({status:"failed",items:[],error:(a==null?void 0:a.message)||"Failed to load slots"})}return()=>s.abort()},[v,n]);u.useEffect(()=>{v&&n?(A(""),ke()):N({status:"idle",items:[],error:null})},[v,n,ke]),u.useEffect(()=>{if(!v||K.status==="loading")return;let s=!1;return oe(a=>({...a,status:"loading",error:null})),(async()=>{try{const a=await ae.get(ne.offers.list(),{params:{active:!0,target_type:"attraction",target_id:v}});if(s)return;const o=Array.isArray(a==null?void 0:a.data)?a.data:Array.isArray(a)?a:[];oe({status:"succeeded",items:o,error:null})}catch(a){if(s)return;oe({status:"failed",items:[],error:(a==null?void 0:a.message)||"Failed to load offers"})}})(),()=>{s=!0}},[v,K.status]);const r=x.data,B=(r==null?void 0:r.name)||(r==null?void 0:r.title)||"Attraction",qe=`https://picsum.photos/seed/attr${v}/1920/800`,Oe=`https://picsum.photos/seed/attr${v}/800/600`,[Ke,Qe]=u.useState(typeof window<"u"?window.innerWidth>=1024:!1);u.useEffect(()=>{if(typeof window>"u")return;const s=()=>Qe(window.innerWidth>=1024);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const Xe=H((r==null?void 0:r.desktop_image_url)||(r==null?void 0:r.hero_image)||(r==null?void 0:r.banner_image)||(r==null?void 0:r.image_web)||(r==null?void 0:r.image_url)||r,qe),Je=H((r==null?void 0:r.mobile_image)||(r==null?void 0:r.image_mobile)||(r==null?void 0:r.image_url)||r,Oe),S=Ke?Xe:Je,Me=u.useMemo(()=>{const a=(I.items||[]).map(o=>({...o,image_url:Ue(o)||H(o.image_url||o.url||o,"")}));return S?[{image_url:S,isCover:!0},...a]:a},[I.items,S]),h=u.useMemo(()=>(I.items||[]).map(a=>({...a,image_url:Ue(a)||H(a.image_url||a.url||a,"")})),[I.items]);u.useEffect(()=>{console.log("Debug - Attraction ID:",v),console.log("Debug - Attraction Data:",r),console.log("Debug - Cover URL:",S),console.log("Debug - Gallery Items:",I.items),console.log("Debug - Hero Gallery Items:",Me),console.log("Debug - Gallery Viewer Items:",h)},[v,r,S,I.items,Me,h]);const De=S||((Ce=h[0])==null?void 0:Ce.image_url)||null;(Ae=h[0])!=null&&Ae.image_url,(Se=h[1])!=null&&Se.image_url||(Te=h[0])!=null&&Te.image_url,h.length;const i=u.useMemo(()=>{for(let s=0;s<g.items.length;s+=1){const a=g.items[s];if(ie(a,s)===w)return a}return null},[g.items,w]),L=Number(ct(r)||0),Ye=Number(dt(r)||L),ce=(i==null?void 0:i.pricing)||{},Ie=(i==null?void 0:i.offer)||null,Ze=i?mt(i,Ye):Ye,et=i?ye(i,L):L,b=Number(ce.base_price??Ze??0),P=Number(ce.final_price??et??0),R=!!Ie||b>0&&P>0&&P<b&&ce.final_price!=null,tt=R&&b>0?Math.round((b-P)/b*100):0,E=Math.max(1,Number(J)||1),F=u.useMemo(()=>{if(!i||!r||!K.items.length||R)return null;const s=P||b||0;if(!s)return null;const a=Ee(r);return bt(K.items,{targetType:"attraction",targetId:a,date:n,slot:i,basePrice:s})},[r,i,K.items,P,b,n,R]),j=R?P||b:F?F.price:P,_=R?Ie:(F==null?void 0:F.offer)||null,ee=(_==null?void 0:_.description)||"",de=R?tt:F&&b>0?Math.round((b-j)/b*100):ut(r)||0,T=b>0&&j>0&&j<b,me=Number(j||0)*E,ue=()=>{var k;if(!r||!n||!i||!J)return;const s=(i==null?void 0:i.id)??(i==null?void 0:i._id)??(i==null?void 0:i.slot_id);if(!s)return;const a=Ee(r),o=E;m(lt({itemType:"attraction",attractionId:a,attraction:r,date:le(n),booking_date:le(n),booking_time:(i==null?void 0:i.start_time)||(i==null?void 0:i.startTime)||(i==null?void 0:i.slot_start_time)||null,slotId:s,slot:i,qty:o,unitPrice:Number(j??(i==null?void 0:i.price)??b),title:(r==null?void 0:r.title)||(r==null?void 0:r.name)||`Attraction #${a}`,slotLabel:ge(i),dateLabel:y(n).format("DD MMM YYYY"),meta:{title:(r==null?void 0:r.title)||(r==null?void 0:r.name)||`Attraction #${a}`,start_time:i==null?void 0:i.start_time,end_time:i==null?void 0:i.end_time,capacity:i==null?void 0:i.capacity,available:i==null?void 0:i.available},offer_id:_==null?void 0:_.offer_id,offer_rule_id:(_==null?void 0:_.rule_id)||((k=F==null?void 0:F.rule)==null?void 0:k.rule_id)})),m(it(1));const c=new URLSearchParams({type:"attraction",attraction_id:String(a),date:le(n),slot:w,qty:String(o)});l(`/booking?${c.toString()}`)};if(x.status==="loading"&&!r)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white",children:e.jsx(fe,{})});if(x.status==="failed")return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(X,{message:x.error||"Attraction not found"})})});if(!r)return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center bg-white px-4",children:e.jsx("div",{className:"max-w-lg w-full",children:e.jsx(X,{message:"Attraction not found"})})});const Fe=(r==null?void 0:r.short_description)||(r==null?void 0:r.subtitle)||"",te=i,se=te&&j?j*E:null;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-[#e0f2fe] via-[#bae6fd] to-white font-sans pb-24 lg:pb-0",children:[e.jsx("section",{className:"mt-0 bg-transparent",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 pt-6 space-y-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",style:{fontFamily:"Inter, sans-serif"},children:B}),e.jsx("div",{className:"overflow-hidden shadow-lg bg-gray-100",children:h.length>0?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr] gap-[2px] bg-white",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length&&q(0),children:e.jsxs("div",{className:"md:h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:S,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:B})})]})}),e.jsxs("div",{className:"hidden md:grid grid-rows-2 gap-[2px] h-[420px]",children:[e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length>0&&q(0),children:e.jsx("div",{className:"w-full h-full overflow-hidden",children:e.jsx("img",{src:(($e=h[0])==null?void 0:$e.image_url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"})})}),e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length>1&&q(1),children:e.jsxs("div",{className:"w-full h-full overflow-hidden",children:[e.jsx("img",{src:((Be=h[1])==null?void 0:Be.image_url)||((Le=h[0])==null?void 0:Le.image_url)||"",alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute bottom-3 right-3 bg-black/60 text-white text-xs px-2 py-1 rounded-full",children:h.length>1?e.jsxs(e.Fragment,{children:["1 / ",h.length]}):null})]})})]})]}):e.jsx("button",{type:"button",className:"relative w-full group",onClick:()=>h.length&&q(0),children:e.jsxs("div",{className:"h-[420px] w-full overflow-hidden",children:[e.jsx("img",{src:S,alt:B,className:"w-full h-full object-cover",loading:"lazy",draggable:"false"}),e.jsx("div",{className:"absolute inset-0 flex items-start justify-start p-6",children:e.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white drop-shadow-lg",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB",textShadow:"2px 2px 4px rgba(0,0,0,0.8)"},children:B})})]})})})]})}),e.jsx("div",{className:"lg:hidden max-w-6xl mx-auto px-4 py-6",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",style:{fontFamily:"Inter, sans-serif"},children:"Base price"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 rupee",style:{fontFamily:"Inter, sans-serif"},children:M(b||j||0)})]}),T?e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500",style:{fontFamily:"Inter, sans-serif"},children:"Offer price"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 rupee",style:{fontFamily:"Inter, sans-serif"},children:M(j||0)}),ee?e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:ee}):null]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Per person • taxes included"}),_?e.jsxs("span",{className:"mt-1 text-xs font-semibold text-emerald-600 flex items-center gap-1",children:[e.jsxs("span",{children:[_.rule_type==="happy_hour"?"Happy Hour":"Offer"," ","applied:"]}),e.jsx("span",{children:_.title||"Special offer"})]}):null]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"per ticket"}),T&&e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:je,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===$()?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:Ne,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:ve,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n&&n!==$()&&n!==y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:n&&n!==$()&&n!==y().add(1,"day").format("YYYY-MM-DD")?y(n).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),g.status==="loading"?e.jsx("div",{className:"py-3",children:e.jsx(fe,{size:"sm"})}):g.status==="failed"?e.jsx("div",{className:"py-3",children:e.jsx(X,{message:g.error||"Failed to load slots"})}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:w,onChange:s=>A(s.target.value),disabled:!g.items.length,style:{fontFamily:"Inter, sans-serif"},children:g.items.length?e.jsxs(e.Fragment,{children:[!w&&e.jsx("option",{value:"",children:"Select slot"}),g.items.filter(s=>pe(s,n)).map((s,a)=>{const o=ie(s,a),c=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0,k=ye(s,L)||L||0;return e.jsxs("option",{value:o,disabled:c,children:[ge(s),k?` • ${M(k)}`:"",c?" — Unavailable":""]},o)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:J,readOnly:!0,className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm bg-gray-50",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-7 h-7 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[E," × ",M(j||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:M(me||0)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:se?e.jsxs(e.Fragment,{children:["Book Now •"," ",e.jsx("span",{className:"ml-1 rupee",children:M(se)})]}):"Book Now"})]})}),e.jsx("section",{className:"max-w-6xl mx-auto px-4 py-8 md:py-12 mt-0",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10 md:gap-12",children:[e.jsx("div",{className:"lg:col-span-2 space-y-8",children:x.status==="failed"?e.jsx(X,{message:x.error}):e.jsxs(e.Fragment,{children:[Fe?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:e.jsx("p",{className:"text-gray-700 text-base md:text-lg",style:{fontFamily:"Inter, sans-serif"},children:Fe})}):null,r!=null&&r.description?e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",style:{fontFamily:"Inter, sans-serif",color:"#87CEEB"},children:"About this attraction"}),e.jsx("div",{className:"prose prose-sm md:prose max-w-none text-gray-700 leading-relaxed text-left",style:{fontFamily:"Inter, sans-serif"},dangerouslySetInnerHTML:{__html:r.description}})]}):null,I.items&&I.items.length>0?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 md:p-6",children:e.jsxs(Pe,{to:`/gallery?attraction=${v}`,className:"inline-flex items-center gap-2 text-sky-600 hover:text-sky-700 font-medium transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"View ",I.items.length," Gallery ",I.items.length===1?"Image":"Images"]})}):null]})}),e.jsx("aside",{className:"hidden lg:block lg:col-span-1",children:e.jsxs("div",{className:"rounded-3xl border shadow-lg bg-white p-6 sticky top-24 space-y-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",style:{fontFamily:"Inter, sans-serif"},children:"Base price"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900 rupee",style:{fontFamily:"Inter, sans-serif"},children:M(b||j||0)})]}),T?e.jsxs("div",{children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500",style:{fontFamily:"Inter, sans-serif"},children:"Offer price"}),e.jsx("div",{className:"text-2xl font-bold text-emerald-600 rupee",style:{fontFamily:"Inter, sans-serif"},children:M(j||0)}),ee?e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:ee}):null]}):e.jsx("p",{className:"text-xs text-gray-500",children:"Per person • taxes included"}),_?e.jsxs("span",{className:"mt-1 text-xs font-semibold text-emerald-600 flex items-center gap-1",children:[e.jsxs("span",{children:[_.rule_type==="happy_hour"?"Happy Hour":"Offer"," ","applied:"]}),e.jsx("span",{children:_.title||"Special offer"})]}):null]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"per ticket"}),T&&e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]})]})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Date"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:je,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===$()?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Today"}),e.jsx("button",{type:"button",onClick:Ne,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n===y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:"Tomorrow"}),e.jsx("button",{type:"button",onClick:ve,className:`px-3 py-1.5 rounded-full text-xs font-medium border transition-colors ${n&&n!==$()&&n!==y().add(1,"day").format("YYYY-MM-DD")?"bg-sky-600 text-white border-sky-600":"bg-white text-gray-800 border-gray-200 hover:border-sky-300"}`,style:{fontFamily:"Inter, sans-serif"},children:n&&n!==$()&&n!==y().add(1,"day").format("YYYY-MM-DD")?y(n).format("D MMM"):"All Days"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Select Time Slot"}),g.status==="loading"?e.jsx("div",{className:"py-2",children:e.jsx(fe,{size:"sm"})}):g.status==="failed"?e.jsx(X,{message:g.error||"Failed to load slots"}):e.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-3 py-2.5 text-sm font-medium text-gray-900 outline-none",value:w,onChange:s=>A(s.target.value),disabled:!g.items.length,style:{fontFamily:"Inter, sans-serif"},children:g.items.length?e.jsxs(e.Fragment,{children:[!w&&e.jsx("option",{value:"",children:"Select slot"}),g.items.filter(s=>pe(s,n)).map((s,a)=>{const o=ie(s,a),c=(s==null?void 0:s.available)===0||(s==null?void 0:s.capacity)===0,k=ye(s,L)||L||0;return e.jsxs("option",{value:o,disabled:c,children:[ge(s),k?` • ${M(k)}`:"",c?" — Unavailable":""]},o)})]}):e.jsx("option",{children:"No slots"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",style:{fontFamily:"Inter, sans-serif"},children:"Number of Tickets"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)-1)),children:"-"}),e.jsx("input",{type:"number",min:1,value:J,onChange:s=>V(Math.max(1,Number(s.target.value)||1)),className:"w-16 text-center border border-gray-300 rounded-lg px-2 py-1 text-sm",style:{fontFamily:"Inter, sans-serif"}}),e.jsx("button",{type:"button",className:"w-8 h-8 text-sm rounded-full border border-gray-300 flex items-center justify-center",onClick:()=>V(s=>Math.max(1,Number(s||1)+1)),children:"+"})]})]}),e.jsxs("div",{className:"mt-3 rounded-2xl border bg-gray-50 px-3 py-2 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-gray-600",children:[e.jsx("span",{children:"Subtotal"}),e.jsxs("span",{className:"rupee",children:[E," × ",M(j||0)]})]}),e.jsxs("div",{className:"mt-1 flex items-center justify-between text-gray-900 font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"rupee",children:M(me||0)})]})]}),e.jsx("button",{type:"button",className:"w-full inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-6 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:se?e.jsxs(e.Fragment,{children:["Book Now •"," ",e.jsx("span",{className:"ml-1 rupee",children:M(se)})]}):"Book Now"})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsx("p",{className:"text-gray-600",style:{fontFamily:"Inter, sans-serif"},children:"Slots and pricing may vary by date and time. Use the options above to choose your preferred session."}),e.jsx(Pe,{to:"/attractions",className:"inline-flex items-center justify-center rounded-full border border-blue-100 text-blue-600 px-5 py-2.5 text-sm font-medium hover:bg-blue-50",style:{fontFamily:"Inter, sans-serif"},children:"Explore other attractions"})]}),e.jsx("p",{className:"text-[11px] text-gray-400 text-center",children:"We'll add this to your cart so you can add more attractions before checkout."})]})})]})}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-[70] border-t border-gray-200 bg-white/95 backdrop-blur",children:e.jsx("div",{className:"max-w-6xl mx-auto px-4 py-3 pb-[calc(env(safe-area-inset-bottom)+12px)]",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-[11px] uppercase tracking-wide text-gray-500 font-semibold",children:T?"Offer price":"Base price"}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("div",{className:"text-lg font-bold text-gray-900 rupee",children:M(T?j||0:b||j||0)}),T?e.jsx("div",{className:"text-sm text-gray-400 line-through rupee",children:M(b||0)}):null,T?e.jsxs("div",{className:"text-xs font-semibold text-emerald-600",children:["Save ",de,"%"]}):null]}),e.jsxs("div",{className:"text-xs text-gray-500 truncate",children:[E," ticket",E>1?"s":""," • Total"," ",e.jsx("span",{className:"rupee font-semibold text-gray-800",children:M(me||0)})]})]}),e.jsx("button",{type:"button",className:"shrink-0 inline-flex items-center justify-center rounded-xl bg-blue-600 text-white px-5 py-2.5 text-sm font-semibold shadow-md hover:bg-blue-700 disabled:opacity-60 disabled:cursor-not-allowed",disabled:!te||!j,onClick:ue,style:{fontFamily:"Inter, sans-serif"},children:"Book Now"})]})})})]}),be&&e.jsxs("div",{className:"fixed inset-0 z-[80] flex",onClick:()=>Z(!1),children:[e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"absolute bg-white rounded-2xl shadow-2xl border border-gray-200 p-4 w-80 max-h-[70vh] overflow-y-auto",style:{top:W?`${W.top}px`:"50%",left:W?`${W.left-160}px`:"50%",transform:W?"none":"translate(-50%, -50%)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Select Date"}),e.jsx("button",{type:"button",onClick:()=>Z(!1),className:"p-1.5 rounded-lg hover:bg-gray-100 text-gray-400 transition-colors",children:e.jsx(xt,{size:18})})]}),e.jsx("div",{className:"space-y-3",children:[0,1,2].map(s=>{const a=y().add(s,"month"),o=a.startOf("month"),c=a.endOf("month"),k=o.day(),re=c.date(),Q=y();return e.jsxs("div",{className:"border border-gray-100 rounded-xl p-3 bg-white",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:a.format("MMMM YYYY")}),e.jsxs("div",{className:"grid grid-cols-7 gap-1 text-xs",children:[["S","M","T","W","T","F","S"].map(p=>e.jsx("div",{className:"text-center text-gray-400 font-medium py-2",children:p},p)),Array.from({length:k}).map((p,Y)=>e.jsx("div",{className:"p-2"},`empty-${Y}`)),Array.from({length:re}).map((p,Y)=>{const C=o.date(Y+1),z=C.format("YYYY-MM-DD"),G=C.isBefore(Q,"day"),xe=n===z,st=C.isSame(Q,"day");return e.jsx("button",{type:"button",onClick:()=>We(z),disabled:G,className:`
                              p-2 rounded-lg text-sm font-medium transition-all duration-200
                              ${G?"text-gray-300 cursor-not-allowed bg-gray-50":""}
                              ${xe?"bg-sky-600 text-white shadow-sm scale-105":""}
                              ${!G&&!xe?"hover:bg-sky-50 text-gray-700 hover:text-sky-700":""}
                              ${st&&!xe?"bg-sky-100 text-sky-700 font-semibold border border-sky-200":""}
                            `,children:Y+1},z)})]})]},s)})})]})]}),we!==null&&h.length>0&&e.jsx(ot,{items:h,initialIndex:we,onClose:()=>q(null)})]})}export{Ft as default};
