import{B as b,R as v,j as a}from"./index-Buz5vlJT.js";import{a as m,A as p}from"./AdminApp-DjyjDDmt.js";import{A as j}from"./AdminTable-BEVjuUza.js";import"./createLucideIcon-BEwYts5j.js";import"./file-text-CuRCFKVY.js";import"./ticket-B65mU2v0.js";function $(){const x=b(),[s,n]=v.useState({status:"idle",items:[],error:null,q:"",active:"",page:1,limit:20,meta:null}),r=async(t=1)=>{n(e=>({...e,status:"loading",error:null,page:t}));try{const e=await m.get(p.addons(),{params:{q:s.q||void 0,active:s.active||void 0,page:t,limit:s.limit}}),d=Array.isArray(e==null?void 0:e.data)?e.data:Array.isArray(e)?e:[];n(i=>({...i,status:"succeeded",items:d,meta:(e==null?void 0:e.meta)||null,page:t}))}catch(e){n(d=>({...d,status:"failed",error:e}))}};v.useEffect(()=>{r(1)},[]);const h=async(t,e)=>{var d;(d=e==null?void 0:e.stopPropagation)==null||d.call(e);try{const i=t.addon_id||t.id;await m.put(`${p.addons()}/${i}`,{active:!t.active}),n(o=>({...o,items:o.items.map(l=>(l.addon_id||l.id)===i?{...l,active:!t.active}:l)}))}catch(i){alert((i==null?void 0:i.message)||"Failed to update")}},y=async(t,e)=>{var d;if((d=e==null?void 0:e.stopPropagation)==null||d.call(e),!!window.confirm(`Delete addon "${t.title}"? This cannot be undone.`))try{const i=t.addon_id||t.id;await m.delete(`${p.addons()}/${i}`),n(o=>({...o,items:o.items.filter(l=>(l.addon_id||l.id)!==i)}))}catch(i){alert((i==null?void 0:i.message)||"Delete failed")}},c=s.meta||{},u=s.page>1,g=c.page?c.page<(c.totalPages||c.total_pages||1):!1;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"Addons"}),a.jsx("button",{className:"rounded-md bg-gray-900 text-white px-3 py-2 text-sm",onClick:()=>x("/admin/catalog/addons/new"),children:"New Addon"})]}),a.jsxs("div",{className:"mb-3 grid grid-cols-1 md:grid-cols-4 gap-2",children:[a.jsx("input",{className:"rounded-md border px-3 py-2",placeholder:"Search title",value:s.q,onChange:t=>n(e=>({...e,q:t.target.value}))}),a.jsxs("select",{className:"rounded-md border px-3 py-2",value:s.active,onChange:t=>n(e=>({...e,active:t.target.value})),children:[a.jsx("option",{value:"",children:"Active: All"}),a.jsx("option",{value:"true",children:"Active"}),a.jsx("option",{value:"false",children:"Inactive"})]}),a.jsx("button",{className:"rounded-md border px-3 py-2 text-sm",onClick:()=>r(1),children:"Filter"})]}),a.jsx(j,{keyField:"addon_id",columns:[{key:"title",title:"Title"},{key:"price",title:"Price",render:t=>`â‚¹${(t==null?void 0:t.price)??0}`},{key:"active",title:"Active",render:t=>String(t==null?void 0:t.active)},{key:"__actions",title:"Actions",render:t=>a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{className:`rounded-md px-2 py-1 text-xs ${t.active?"border text-red-600":"bg-blue-600 text-white"}`,onClick:e=>h(t,e),children:t.active?"Deactivate":"Activate"}),a.jsx("button",{className:"rounded-md border px-2 py-1 text-xs text-red-600",onClick:e=>y(t,e),children:"Delete"})]})}],rows:s.items,onRowClick:t=>x(`/admin/catalog/addons/${t.addon_id||t.id}`),empty:s.status==="loading"?"Loadingâ€¦":"No addons found"}),a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("button",{className:"rounded-md border px-3 py-1 text-sm",onClick:()=>u&&r(s.page-1),disabled:!u||s.status==="loading",children:"Prev"}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",c.page||s.page]}),a.jsx("button",{className:"rounded-md border px-3 py-1 text-sm",onClick:()=>g&&r(s.page+1),disabled:!g||s.status==="loading",children:"Next"})]})]})}export{$ as default};
