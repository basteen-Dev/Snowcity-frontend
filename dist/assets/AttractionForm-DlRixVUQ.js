import{C as v,A as k,R as m,j as t}from"./index-DpUnVvi7.js";import{a as c,A as u}from"./AdminApp-DElutmvv.js";import{I as f}from"./ImageUploader-8sQNEsRz.js";import{S as _}from"./SaveOverlay-YW_4J3BF.js";import"./createLucideIcon-DlloiUI2.js";import"./file-text-BcxeLTgw.js";import"./users-Dj4zQjFo.js";import"./newspaper-D6LH_a5a.js";import"./ticket-DJwTfedz.js";import"./chevron-down-BM4ufvPU.js";import"./media-CQLQFIy8.js";function L(){var p,b;const{id:o}=v(),x=k(),i=!!o,[s,r]=m.useState({status:i?"loading":"idle",error:null,form:{title:"",slug:"",image_url:"",image_alt:"",desktop_image_url:"",desktop_image_alt:"",base_price:0,active:!0,description:"",meta_title:"",short_description:""}}),[d,g]=m.useState(!1);m.useEffect(()=>{i&&(async()=>{try{const a=await c.get(u.attractionById(o)),e=(a==null?void 0:a.attraction)||a||{};r(n=>({...n,status:"idle",form:{title:e.title||"",slug:e.slug||"",image_url:e.image_url||"",image_alt:e.image_alt||"",desktop_image_url:e.desktop_image_url||"",desktop_image_alt:e.desktop_image_alt||"",base_price:e.base_price||0,active:!!e.active,description:e.description||"",meta_title:e.meta_title||"",short_description:e.short_description||""}}))}catch(a){r(e=>({...e,status:"failed",error:a}))}})()},[o,i]);const h=async a=>{a.preventDefault(),g(!0),r(e=>({...e,error:null}));try{i?await c.put(u.attractionById(o),s.form):await c.post(u.attractions(),s.form),x("/admin/catalog/attractions")}catch(e){r(n=>({...n,error:e}))}finally{g(!1)}};if(s.status==="loading")return t.jsx("div",{children:"Loading…"});if(s.status==="failed")return t.jsx("div",{className:"text-red-600",children:((p=s.error)==null?void 0:p.message)||"Failed to load"});const l=s.form;return t.jsxs("div",{className:"relative",children:[t.jsx(_,{visible:d,label:i?"Updating attraction…":"Saving attraction…"}),t.jsxs("form",{onSubmit:h,className:"max-w-2xl bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-xl p-4",children:[t.jsxs("h1",{className:"text-xl font-semibold mb-4",children:[i?"Edit":"New"," Attraction"]}),s.error?t.jsx("div",{className:"mb-3 text-sm text-red-600",children:((b=s.error)==null?void 0:b.message)||"Save failed"}):null,t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Title"}),t.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.title,onChange:a=>r(e=>({...e,form:{...e.form,title:a.target.value}}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Slug (URL-friendly identifier)"}),t.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.slug,onChange:a=>r(e=>({...e,form:{...e.form,slug:a.target.value}})),placeholder:"auto-generated-from-title"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Short Description (for lists/previews)"}),t.jsx("textarea",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",rows:2,value:l.short_description,onChange:a=>r(e=>({...e,form:{...e.form,short_description:a.target.value}}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Meta Title (SEO title)"}),t.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.meta_title,onChange:a=>r(e=>({...e,form:{...e.form,meta_title:a.target.value}})),placeholder:"Custom page title for SEO"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Base Price"}),t.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.base_price,onChange:a=>r(e=>({...e,form:{...e.form,base_price:Number(a.target.value||0)}}))})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsx(f,{label:"Image",value:l.image_url,onChange:a=>r(e=>({...e,form:{...e.form,image_url:a}})),altText:l.image_alt,onAltChange:a=>r(e=>({...e,form:{...e.form,image_alt:a}})),folder:"attractions",requiredPerm:"uploads:write"})}),t.jsx("div",{className:"md:col-span-2",children:t.jsx(f,{label:"Desktop Image (optional)",value:l.desktop_image_url,onChange:a=>r(e=>({...e,form:{...e.form,desktop_image_url:a}})),altText:l.desktop_image_alt,onAltChange:a=>r(e=>({...e,form:{...e.form,desktop_image_alt:a}})),folder:"attractions",requiredPerm:"uploads:write"})}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Long Description (HTML content)"}),t.jsx("textarea",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",rows:6,value:l.description,onChange:a=>r(e=>({...e,form:{...e.form,description:a.target.value}}))})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{id:"active",type:"checkbox",checked:!!l.active,onChange:a=>r(e=>({...e,form:{...e.form,active:a.target.checked}}))}),t.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700 dark:text-neutral-200",children:"Active"})]})]}),t.jsxs("div",{className:"mt-4 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:d,className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm disabled:opacity-60 disabled:cursor-not-allowed",children:d?"Saving…":"Save"}),t.jsx("button",{type:"button",className:"rounded-md border px-4 py-2 text-sm",onClick:()=>x(-1),children:"Cancel"})]})]})]})}export{L as default};
