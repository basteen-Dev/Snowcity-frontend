import{R as s,D as a,j as e}from"./index-LUC8W6HM.js";import{a as b}from"./AdminApp-BAIHpeWj.js";import{R as g,T as j}from"./CategoricalChart-Ct6we7W-.js";import{B as k,a as d}from"./BarChart-V62ciLmm.js";import{C as f,X as N,Y as v,L as S}from"./CartesianChart-C10HTeXy.js";import"./createLucideIcon-BY9DOx5Q.js";import"./file-text-Bc3jcJvJ.js";import"./ticket-xkTq38T-.js";import"./clsx-B-dksMZM.js";import"./index-CgmsNRzu.js";import"./tooltipContext-o6GB5qD6.js";const m=[{key:"payment_status",label:"Payment Status"},{key:"booking_status",label:"Booking Status"},{key:"payment_mode",label:"Payment Mode"}];function M(){var i;const[n,p]=s.useState(a().subtract(30,"day").startOf("day").toISOString()),[o,c]=s.useState(a().endOf("day").toISOString()),[r,x]=s.useState("payment_status"),[l,y]=s.useState([]);s.useEffect(()=>{(async()=>{const t=await b.get("/api/admin/analytics/split",{from:n,to:o,group_by:r});y(Array.isArray(t==null?void 0:t.data)?t.data:Array.isArray(t)?t:[])})()},[n,o,r]);const u=`/api/admin/analytics/report.csv?type=split&group_by=${encodeURIComponent(r)}&from=${encodeURIComponent(n)}&to=${encodeURIComponent(o)}`;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("input",{type:"datetime-local",className:"rounded-md border px-2 py-1 text-sm dark:bg-neutral-900 dark:border-neutral-700",value:a(n).format("YYYY-MM-DDTHH:mm"),onChange:t=>p(a(t.target.value).toISOString())}),e.jsx("input",{type:"datetime-local",className:"rounded-md border px-2 py-1 text-sm dark:bg-neutral-900 dark:border-neutral-700",value:a(o).format("YYYY-MM-DDTHH:mm"),onChange:t=>c(a(t.target.value).toISOString())}),e.jsx("select",{className:"rounded-md border px-2 py-1 text-sm dark:bg-neutral-900 dark:border-neutral-700",value:r,onChange:t=>x(t.target.value),children:m.map(t=>e.jsx("option",{value:t.key,children:t.label},t.key))}),e.jsx("a",{href:u,className:"ml-auto px-3 py-1 rounded-md border text-sm",children:"Download CSV"})]}),e.jsxs("div",{className:"rounded-xl border bg-white dark:bg-neutral-900 border-gray-200 dark:border-neutral-800 p-3",children:[e.jsxs("div",{className:"text-sm font-medium mb-2",children:["Split by ",(i=m.find(t=>t.key===r))==null?void 0:i.label]}),e.jsx("div",{style:{height:320},children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(k,{data:l,children:[e.jsx(f,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(N,{dataKey:"key"}),e.jsx(v,{}),e.jsx(j,{}),e.jsx(S,{}),e.jsx(d,{dataKey:"bookings",name:"Bookings",fill:"#2563eb"}),e.jsx(d,{dataKey:"people",name:"People",fill:"#10b981"}),e.jsx(d,{dataKey:"revenue",name:"Revenue",fill:"#f59e0b"})]})})})]}),e.jsx("div",{className:"rounded-xl border bg-white dark:bg-neutral-900 border-gray-200 dark:border-neutral-800 p-3 overflow-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-neutral-800",children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Key"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Bookings"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"People"}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Revenue"})]})}),e.jsxs("tbody",{children:[l.map((t,h)=>e.jsxs("tr",{className:"border-t dark:border-neutral-800",children:[e.jsx("td",{className:"px-3 py-2",children:t.key}),e.jsx("td",{className:"px-3 py-2 text-right",children:t.bookings}),e.jsx("td",{className:"px-3 py-2 text-right",children:t.people??0}),e.jsxs("td",{className:"px-3 py-2 text-right",children:["â‚¹ ",Number(t.revenue||0).toLocaleString()]})]},h)),!l.length&&e.jsx("tr",{children:e.jsx("td",{className:"px-3 py-6 text-center text-gray-500 dark:text-neutral-400",colSpan:4,children:"No data"})})]})]})})]})}export{M as default};
