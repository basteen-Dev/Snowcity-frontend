import{C as f,A as v,R as c,j as r}from"./index-CmreT6x1.js";import{a as m,A as u}from"./AdminApp-BV7zANWg.js";import{I as h}from"./ImageUploader-BX4irtyE.js";import{S as j}from"./SaveOverlay-BxSWHQi1.js";import"./createLucideIcon-CgZNF2TE.js";import"./file-text-ButRzfWA.js";import"./newspaper-yOb_4zvd.js";import"./ticket-hq6RMmhb.js";import"./chevron-down-bqKWLlrR.js";import"./media-DcknJ8BL.js";function D(){var b;const{id:i}=f(),p=v(),d=!!i,[s,a]=c.useState({status:d?"loading":"idle",error:null,form:{title:"",description:"",price:0,discount_percent:0,image_url:"",active:!0}}),[n,x]=c.useState(!1);c.useEffect(()=>{d&&(async()=>{try{const t=await m.get(`${u.addons()}/${i}`),e=(t==null?void 0:t.addon)||t||{};a(o=>({...o,status:"idle",form:{title:e.title||"",description:e.description||"",price:e.price||0,discount_percent:e.discount_percent||0,image_url:e.image_url||"",active:!!e.active}}))}catch(t){a(e=>({...e,status:"failed",error:t}))}})()},[i,d]);const g=async t=>{t.preventDefault(),x(!0),a(e=>({...e,error:null}));try{const e={...s.form,price:Number(s.form.price||0),discount_percent:Number(s.form.discount_percent||0)};d?await m.put(`${u.addons()}/${i}`,e):await m.post(u.addons(),e),p("/admin/catalog/addons")}catch(e){a(o=>({...o,error:e}))}finally{x(!1)}};if(s.status==="loading")return r.jsx("div",{children:"Loading…"});if(s.status==="failed")return r.jsx("div",{className:"text-red-600",children:((b=s.error)==null?void 0:b.message)||"Failed to load"});const l=s.form;return r.jsxs("div",{className:"relative",children:[r.jsx(j,{visible:n,label:d?"Updating addon…":"Saving addon…"}),r.jsxs("form",{onSubmit:g,className:"max-w-2xl bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-xl p-4",children:[r.jsxs("h1",{className:"text-xl font-semibold mb-4",children:[d?"Edit":"New"," Addon"]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Title"}),r.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.title,onChange:t=>a(e=>({...e,form:{...e.form,title:t.target.value}}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Price"}),r.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.price,onChange:t=>a(e=>({...e,form:{...e.form,price:Number(t.target.value||0)}}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Discount %"}),r.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.discount_percent,onChange:t=>a(e=>({...e,form:{...e.form,discount_percent:Number(t.target.value||0)}}))})]}),r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Description"}),r.jsx("textarea",{rows:4,className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.description,onChange:t=>a(e=>({...e,form:{...e.form,description:t.target.value}}))})]}),r.jsx("div",{className:"md:col-span-2",children:r.jsx(h,{label:"Image",value:l.image_url,onChange:t=>a(e=>({...e,form:{...e.form,image_url:t}})),folder:"addons",requiredPerm:"uploads:write"})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{id:"active",type:"checkbox",checked:!!l.active,onChange:t=>a(e=>({...e,form:{...e.form,active:t.target.checked}}))}),r.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700 dark:text-neutral-200",children:"Active"})]})]}),r.jsxs("div",{className:"mt-4 flex gap-2",children:[r.jsx("button",{type:"submit",disabled:n,className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm disabled:opacity-60 disabled:cursor-not-allowed",children:n?"Saving…":"Save"}),r.jsx("button",{type:"button",className:"rounded-md border px-4 py-2 text-sm",onClick:()=>p(-1),children:"Cancel"})]})]})]})}export{D as default};
