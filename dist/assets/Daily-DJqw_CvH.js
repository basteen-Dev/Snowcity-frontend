import{R as l,D as a,j as e}from"./index-Buz5vlJT.js";import{a as k}from"./AdminApp-DjyjDDmt.js";import{R as v,T as S}from"./CategoricalChart-hAUv2vPj.js";import{L as N,a as m}from"./LineChart-bJFXiFr0.js";import{C as D,X as Y,Y as R,L as O}from"./CartesianChart-DlQcQi6Y.js";import"./createLucideIcon-BEwYts5j.js";import"./file-text-CuRCFKVY.js";import"./ticket-B65mU2v0.js";import"./clsx-B-dksMZM.js";import"./index-6DYJ-02T.js";const x=[{key:"7d",label:"7 days",from:()=>a().subtract(7,"day"),to:()=>a()},{key:"30d",label:"30 days",from:()=>a().subtract(30,"day"),to:()=>a()},{key:"thisMonth",label:"Month to date",from:()=>a().startOf("month"),to:()=>a()},{key:"year",label:"Year to date",from:()=>a().startOf("year"),to:()=>a()}],y=({title:s,subtitle:o,children:n})=>e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5 shadow-sm dark:bg-neutral-900 dark:border-neutral-800",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-neutral-100",children:s}),o?e.jsx("p",{className:"text-xs text-gray-500",children:o}):null]}),n]}),c=({label:s,value:o})=>e.jsxs("div",{className:"rounded-xl border border-gray-100 bg-gray-50 px-4 py-3",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:s}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:o})]});function $(){const[s,o]=l.useState(a().subtract(30,"day").startOf("day").toISOString()),[n,p]=l.useState(a().endOf("day").toISOString()),[i,g]=l.useState([]),[u,b]=l.useState("30d");l.useEffect(()=>{(async()=>{const t=await k.get("/api/admin/analytics/daily",{from:s,to:n});g(Array.isArray(t)?t:[])})()},[s,n]);const f=`/api/admin/analytics/report.csv?type=daily&from=${encodeURIComponent(s)}&to=${encodeURIComponent(n)}`,d=l.useMemo(()=>i.reduce((t,r)=>(t.bookings+=Number(r.bookings||0),t.people+=Number(r.people||0),t.revenue+=Number(r.revenue||0),t),{bookings:0,people:0,revenue:0}),[i]),h=t=>{const r=x.find(j=>j.key===t);r&&(b(t),o(r.from().startOf("day").toISOString()),p(r.to().endOf("day").toISOString()))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(y,{title:"Daily Filters",subtitle:"Slice bookings and people per day",children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:x.map(t=>e.jsx("button",{onClick:()=>h(t.key),className:`rounded-full border px-3 py-1 text-xs font-semibold ${u===t.key?"bg-gray-900 text-white border-gray-900":"border-gray-200 text-gray-600"}`,children:t.label},t.key))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx("input",{type:"datetime-local",className:"rounded-lg border px-3 py-2 text-sm",value:a(s).format("YYYY-MM-DDTHH:mm"),onChange:t=>o(a(t.target.value).toISOString())}),e.jsx("input",{type:"datetime-local",className:"rounded-lg border px-3 py-2 text-sm",value:a(n).format("YYYY-MM-DDTHH:mm"),onChange:t=>p(a(t.target.value).toISOString())}),e.jsx("a",{href:f,className:"rounded-lg border px-3 py-2 text-sm text-center",children:"Download CSV"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsx(c,{label:"Total Bookings",value:d.bookings.toLocaleString()}),e.jsx(c,{label:"People",value:d.people.toLocaleString()}),e.jsx(c,{label:"Revenue",value:`â‚¹${d.revenue.toLocaleString()}`})]}),e.jsx(y,{title:"Daily Bookings, People, Revenue",subtitle:"Stacked trend per metric",children:e.jsx("div",{style:{height:360},children:e.jsx(v,{width:"100%",height:"100%",children:e.jsxs(N,{data:i,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(Y,{dataKey:"bucket",tickFormatter:t=>a(t).format("MM-DD")}),e.jsx(R,{}),e.jsx(S,{labelFormatter:t=>a(t).format("YYYY-MM-DD")}),e.jsx(O,{}),e.jsx(m,{type:"monotone",dataKey:"bookings",stroke:"#2563eb",name:"Bookings",strokeWidth:2,dot:!1}),e.jsx(m,{type:"monotone",dataKey:"people",stroke:"#10b981",name:"People",strokeWidth:2,dot:!1}),e.jsx(m,{type:"monotone",dataKey:"revenue",stroke:"#f59e0b",name:"Revenue",strokeWidth:2,dot:!1})]})})})})]})}export{$ as default};
