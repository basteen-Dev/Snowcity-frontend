import{C as f,A as v,R as c,j as t}from"./index-DpUnVvi7.js";import{a as m,A as u}from"./AdminApp-DElutmvv.js";import{I as h}from"./ImageUploader-8sQNEsRz.js";import{S as j}from"./SaveOverlay-YW_4J3BF.js";import"./createLucideIcon-DlloiUI2.js";import"./file-text-BcxeLTgw.js";import"./users-Dj4zQjFo.js";import"./newspaper-D6LH_a5a.js";import"./ticket-DJwTfedz.js";import"./chevron-down-BM4ufvPU.js";import"./media-CQLQFIy8.js";function F(){var g;const{id:i}=f(),p=v(),d=!!i,[s,r]=c.useState({status:d?"loading":"idle",error:null,form:{title:"",description:"",price:0,discount_percent:0,image_url:"",image_alt:"",active:!0}}),[n,x]=c.useState(!1);c.useEffect(()=>{d&&(async()=>{try{const a=await m.get(`${u.addons()}/${i}`),e=(a==null?void 0:a.addon)||a||{};r(o=>({...o,status:"idle",form:{title:e.title||"",description:e.description||"",price:e.price||0,discount_percent:e.discount_percent||0,image_url:e.image_url||"",image_alt:e.image_alt||"",active:!!e.active}}))}catch(a){r(e=>({...e,status:"failed",error:a}))}})()},[i,d]);const b=async a=>{a.preventDefault(),x(!0),r(e=>({...e,error:null}));try{const e={...s.form,price:Number(s.form.price||0),discount_percent:Number(s.form.discount_percent||0)};d?await m.put(`${u.addons()}/${i}`,e):await m.post(u.addons(),e),p("/admin/catalog/addons")}catch(e){r(o=>({...o,error:e}))}finally{x(!1)}};if(s.status==="loading")return t.jsx("div",{children:"Loading…"});if(s.status==="failed")return t.jsx("div",{className:"text-red-600",children:((g=s.error)==null?void 0:g.message)||"Failed to load"});const l=s.form;return t.jsxs("div",{className:"relative",children:[t.jsx(j,{visible:n,label:d?"Updating addon…":"Saving addon…"}),t.jsxs("form",{onSubmit:b,className:"max-w-2xl bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-xl p-4",children:[t.jsxs("h1",{className:"text-xl font-semibold mb-4",children:[d?"Edit":"New"," Addon"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Title"}),t.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.title,onChange:a=>r(e=>({...e,form:{...e.form,title:a.target.value}}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Price"}),t.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.price,onChange:a=>r(e=>({...e,form:{...e.form,price:Number(a.target.value||0)}}))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Discount %"}),t.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.discount_percent,onChange:a=>r(e=>({...e,form:{...e.form,discount_percent:Number(a.target.value||0)}}))})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Description"}),t.jsx("textarea",{rows:4,className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:l.description,onChange:a=>r(e=>({...e,form:{...e.form,description:a.target.value}}))})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsx(h,{label:"Image",value:l.image_url,onChange:a=>r(e=>({...e,form:{...e.form,image_url:a}})),altText:l.image_alt,onAltChange:a=>r(e=>({...e,form:{...e.form,image_alt:a}})),folder:"addons",requiredPerm:"uploads:write"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{id:"active",type:"checkbox",checked:!!l.active,onChange:a=>r(e=>({...e,form:{...e.form,active:a.target.checked}}))}),t.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700 dark:text-neutral-200",children:"Active"})]})]}),t.jsxs("div",{className:"mt-4 flex gap-2",children:[t.jsx("button",{type:"submit",disabled:n,className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm disabled:opacity-60 disabled:cursor-not-allowed",children:n?"Saving…":"Save"}),t.jsx("button",{type:"button",className:"rounded-md border px-4 py-2 text-sm",onClick:()=>p(-1),children:"Cancel"})]})]})]})}export{F as default};
