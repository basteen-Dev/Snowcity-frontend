import{C as L,A as V,R as y,j as e}from"./index-CmreT6x1.js";import{a as j,A as N}from"./AdminApp-BV7zANWg.js";import{I as q}from"./ImageUploader-BX4irtyE.js";import{u as B}from"./useCatalogTargets-CpY6AfID.js";import"./createLucideIcon-CgZNF2TE.js";import"./file-text-ButRzfWA.js";import"./newspaper-yOb_4zvd.js";import"./ticket-hq6RMmhb.js";import"./chevron-down-bqKWLlrR.js";import"./media-DcknJ8BL.js";const G=["holiday","happy_hour","weekday_special","dynamic_pricing","date_slot_pricing","buy_x_get_y"],D=[{value:"percent",label:"Percentage (%)"},{value:"amount",label:"Flat Amount"}],R=[{value:"attraction",label:"Attraction"},{value:"combo",label:"Combo"}],H={target_type:"attraction",target_id:"",applies_to_all:!1,buy_qty:1,get_qty:1,get_target_type:"attraction",get_target_id:"",get_discount_type:"",get_discount_value:"",date_from:"",date_to:"",time_from:"",time_to:"",slot_type:"",slot_id:"",rule_discount_type:"",rule_discount_value:"",priority:100,day_type:"",specific_days:[],is_holiday:!1,specific_date:"",specific_time:"",specific_dates:[],next_specific_date:""},M=[{key:"happy-hour",label:"Happy Hour Window",badge:"Time-based",description:"Reward mid-day visitors with an automatic discount window.",ruleType:"happy_hour",defaults:{day_type:"weekday",time_from:"14:00",time_to:"17:00",rule_discount_type:"percent",rule_discount_value:20}},{key:"weekend-boost",label:"Weekend Boost",badge:"Day-based",description:"Highlight premium or discounted pricing for weekends.",ruleType:"weekday_special",defaults:{day_type:"weekend",rule_discount_type:"percent",rule_discount_value:10}},{key:"date-slot",label:"Specific Date Slot",badge:"Slot",description:"Target a single date or slot for campaigns and events.",ruleType:"date_slot_pricing",defaults:{specific_date:"",specific_time:"",rule_discount_type:"amount",rule_discount_value:200}},{key:"date-price-increase",label:"Date Price Increase",badge:"Price Increase",description:"Increase prices for specific dates (use negative discount values).",ruleType:"date_slot_pricing",defaults:{specific_date:"",rule_discount_type:"amount",rule_discount_value:-500}}],U=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],k=(r={})=>({...H,...r}),W=(r,_)=>{const c=Number(r||0);if(!c)return"Inherit offer discount";if(c<0){const o=Math.abs(c);return _==="amount"?`+₹${o.toFixed(2)}`:`+${o}%`}return _==="amount"?`₹${c.toFixed(2)}`:`${c}%`},z=(r,_)=>{const c=[];if(r.applies_to_all)c.push(`All ${r.target_type}s`);else if(r.target_id){const o=_?_(r):"";c.push(o||`${r.target_type} #${r.target_id}`)}else c.push("Target pending");if(r.day_type==="custom"&&Array.isArray(r.specific_days)&&r.specific_days.length){const o=r.specific_days.map(g=>U[g]).filter(Boolean);c.push(o.length?o.join(", "):"Custom days")}else r.day_type?c.push(r.day_type.replace("_"," ")):r.is_holiday?c.push("Holiday only"):c.push("All days");return r.time_from||r.time_to?c.push(`${r.time_from||"00:00"}–${r.time_to||"23:59"}`):c.push("All day"),Array.isArray(r.specific_dates)&&r.specific_dates.length&&c.push(`${r.specific_dates.length} date${r.specific_dates.length>1?"s":""}`),c.push(W(r.rule_discount_value,r.rule_discount_type)),c.join(" · ")};function ie(){var C,S;const{id:r}=L(),_=V(),c=!!r,{attractions:o,combos:g,status:w}=B(),[n,x]=y.useState({status:c?"loading":"idle",error:null,form:{title:"",description:"",image_url:"",rule_type:"",discount_type:"percent",discount_value:0,max_discount:"",valid_from:"",valid_to:"",active:!0,rules:[]}});y.useEffect(()=>{c&&(async()=>{try{const t=await j.get(`${N.offers()}/${r}`),s=(t==null?void 0:t.offer)||t||{};x(a=>({...a,status:"idle",form:{title:s.title||"",description:s.description||"",image_url:s.image_url||"",rule_type:s.rule_type||"",discount_type:s.discount_type||"percent",discount_value:Number(s.discount_value??s.discount_percent??0),max_discount:s.max_discount??"",valid_from:s.valid_from?new Date(s.valid_from).toISOString().split("T")[0]:"",valid_to:s.valid_to?new Date(s.valid_to).toISOString().split("T")[0]:"",active:!!s.active,rules:Array.isArray(s.rules)?s.rules.map(l=>k({target_type:l.target_type||"attraction",target_id:l.target_id??"",applies_to_all:!!l.applies_to_all,date_from:l.date_from?new Date(l.date_from).toISOString().split("T")[0]:"",date_to:l.date_to?new Date(l.date_to).toISOString().split("T")[0]:"",time_from:l.time_from||"",time_to:l.time_to||"",slot_type:l.slot_type||"",slot_id:l.slot_id??"",rule_discount_type:l.rule_discount_type||"",rule_discount_value:l.rule_discount_value??"",priority:l.priority??100,day_type:l.day_type||"",specific_days:l.specific_days||[],is_holiday:!!l.is_holiday,specific_date:l.specific_date?new Date(l.specific_date).toISOString().split("T")[0]:"",specific_dates:l.specific_date?[new Date(l.specific_date).toISOString().split("T")[0]]:[],specific_time:l.specific_time||"",next_specific_date:""})):[]}}))}catch(t){x(s=>({...s,status:"failed",error:t}))}})()},[r,c]);const m=y.useCallback(t=>{x(s=>({...s,form:{...s.form,...t}}))},[]),d=y.useCallback((t,s)=>{x(a=>{const l=[...a.form.rules||[]];return l[t]={...l[t],...s},s.target_type&&l[t].target_id&&((s.target_type==="attraction"?o.some(f=>f.id===Number(l[t].target_id)):g.some(f=>f.id===Number(l[t].target_id)))||(l[t].target_id="")),{...a,form:{...a.form,rules:l}}})},[o,g]),$=y.useCallback(()=>{x(t=>({...t,form:{...t.form,rules:[...t.form.rules||[],k()]}}))},[]),E=y.useCallback(t=>{if(!t||!t.target_id)return"";const s=t.target_type==="combo"?g:o,a=Number(t.target_id),l=s.find(b=>Number(b.id)===a);return l&&(l.title||l.name)||""},[o,g]),F=y.useCallback(t=>{x(s=>({...s,form:{...s.form,rule_type:t.ruleType,rules:[...s.form.rules||[],k({...t.defaults,rule_discount_type:t.defaults.rule_discount_type??"",rule_discount_value:t.defaults.rule_discount_value??""})]}}))},[]),I=y.useCallback(t=>{x(s=>{const a=[...s.form.rules||[]];return a.splice(t,1),{...s,form:{...s.form,rules:a}}})},[]),O=async t=>{t.preventDefault();try{const s=i=>{const u=(i??"").toString().trim();return u||null},a=i=>{const u=(i??"").toString().trim();return u||null},l=i=>{const u=(i??"").toString().trim();return u||null},b=(n.form.rules||[]).map(i=>i.applies_to_all?{...i,target_id:null}:{...i});if(b.filter(i=>!i.applies_to_all&&(i.target_id===null||i.target_id===void 0||i.target_id==="")).length>0){x(i=>({...i,error:{message:'Please select a target from the list or enable "Applies to all".'}}));return}const h=[];b.forEach(i=>{const{specific_dates:u=[],next_specific_date:Y,...v}=i,A=Array.isArray(u)?u.filter(Boolean):[];A.length?A.forEach(P=>{h.push({...v,specific_date:s(P)})}):h.push({...v,specific_date:s(v.specific_date)})});const T={...n.form,discount_type:n.form.discount_type||"percent",discount_value:Number(n.form.discount_value||0),discount_percent:n.form.discount_type==="percent"?Number(n.form.discount_value||0):0,max_discount:n.form.max_discount===""?null:Number(n.form.max_discount),valid_from:s(n.form.valid_from),valid_to:s(n.form.valid_to),rules:h.map(i=>({...i,target_id:i.applies_to_all||i.target_id===""?null:Number(i.target_id),slot_id:i.slot_id===""?null:Number(i.slot_id),rule_discount_value:i.rule_discount_value===""?null:Number(i.rule_discount_value),priority:Number(i.priority??100),date_from:s(i.date_from),date_to:s(i.date_to),time_from:a(i.time_from),time_to:a(i.time_to),specific_date:s(i.specific_date),specific_time:a(i.specific_time),rule_discount_type:l(i.rule_discount_type),slot_type:l(i.slot_type),day_type:l(i.day_type),specific_dates:void 0,next_specific_date:void 0}))};c?await j.put(`${N.offers()}/${r}`,T):await j.post(N.offers(),T),_("/admin/catalog/offers")}catch(s){x(a=>({...a,error:s}))}};if(n.status==="loading")return e.jsx("div",{children:"Loading…"});if(n.status==="failed")return e.jsx("div",{className:"text-red-600",children:((C=n.error)==null?void 0:C.message)||"Failed to load"});const p=n.form;return e.jsxs("form",{onSubmit:O,className:"max-w-2xl bg-white dark:bg-neutral-900 border border-gray-200 dark:border-neutral-800 rounded-xl p-4",children:[e.jsxs("h1",{className:"text-xl font-semibold mb-4",children:[c?"Edit":"New"," Offer"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Title"}),e.jsx("input",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.title,onChange:t=>m({title:t.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Description"}),e.jsx("textarea",{rows:4,className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.description,onChange:t=>m({description:t.target.value})})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(q,{label:"Image",value:p.image_url,onChange:t=>m({image_url:t}),folder:"offers",requiredPerm:"uploads:write"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Rule Type"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.rule_type,onChange:t=>m({rule_type:t.target.value}),children:[e.jsx("option",{value:"",children:"—"},"__default-rule-type__"),G.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Discount Type"}),e.jsx("select",{className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.discount_type,onChange:t=>m({discount_type:t.target.value}),children:D.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Discount Value"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.discount_value,onChange:t=>m({discount_value:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Max Discount (optional)"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.max_discount??"",onChange:t=>m({max_discount:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Valid From"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.valid_from||"",onChange:t=>m({valid_from:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 dark:text-neutral-300 mb-1",children:"Valid To"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2 dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-200",value:p.valid_to||"",onChange:t=>m({valid_to:t.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:col-span-2",children:[e.jsx("input",{id:"active",type:"checkbox",checked:!!p.active,onChange:t=>m({active:t.target.checked})}),e.jsx("label",{htmlFor:"active",className:"text-sm text-gray-700 dark:text-neutral-200",children:"Active"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Rules"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{type:"button",onClick:$,className:"text-sm rounded-md border px-3 py-1",children:"Add Rule"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:M.map(t=>e.jsxs("button",{type:"button",onClick:()=>F(t),className:"rounded-2xl border border-gray-200 hover:border-gray-400 text-left p-3 bg-white/70 dark:bg-neutral-900/60 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs uppercase tracking-wide text-gray-500",children:[e.jsx("span",{children:t.badge}),e.jsx("span",{className:"text-[10px] bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full",children:"Template"})]}),e.jsx("div",{className:"mt-1 text-sm font-semibold text-gray-900 dark:text-neutral-100",children:t.label}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 min-h-[32px]",children:t.description})]},t.key))}),(p.rules||[]).length?null:e.jsx("div",{className:"text-sm text-gray-500",children:"No rules yet. Add one to target specific attractions or combos."}),e.jsx("div",{className:"space-y-4 mt-3",children:(p.rules||[]).map((t,s)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-semibold",children:["Rule #",s+1]}),e.jsx("div",{className:"text-xs text-gray-500",children:z(t,E)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center rounded-full border px-2 py-0.5 text-[11px] text-gray-600",children:t.target_type==="combo"?"Combo":"Attraction"}),e.jsx("button",{type:"button",onClick:()=>I(s),className:"text-xs text-red-600",children:"Remove"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Target Type"}),e.jsx("select",{className:"w-full rounded-md border px-3 py-2",value:t.target_type,onChange:a=>d(s,{target_type:a.target.value}),children:R.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Target"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.target_id??"",disabled:t.applies_to_all||w==="loading",onChange:a=>d(s,{target_id:a.target.value}),children:[e.jsxs("option",{value:"",children:["Select ",t.target_type==="combo"?"Combo":"Attraction"]},`__default-target-${s}__`),(t.target_type==="attraction"?o:g).map(a=>e.jsx("option",{value:a.id,children:a.title||a.name},a.id))]}),!t.applies_to_all&&(!t.target_id||t.target_id==="")?e.jsx("div",{className:"mt-1 text-xs text-red-600",children:"Select a target or enable Applies to all"}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{id:`applies-${s}`,type:"checkbox",checked:!!t.applies_to_all,onChange:a=>d(s,{applies_to_all:a.target.checked})}),e.jsx("label",{htmlFor:`applies-${s}`,className:"text-xs text-gray-600",children:"Applies to all of this type"})]})]}),p.rule_type==="buy_x_get_y"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Buy Quantity (X)"}),e.jsx("input",{type:"number",min:1,className:"w-full rounded-md border px-3 py-2",value:t.buy_qty??1,onChange:a=>d(s,{buy_qty:Number(a.target.value||1)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Get Quantity (Y)"}),e.jsx("input",{type:"number",min:1,className:"w-full rounded-md border px-3 py-2",value:t.get_qty??1,onChange:a=>d(s,{get_qty:Number(a.target.value||1)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Get Target Type"}),e.jsx("select",{className:"w-full rounded-md border px-3 py-2",value:t.get_target_type||"attraction",onChange:a=>d(s,{get_target_type:a.target.value,get_target_id:""}),children:R.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Get Target"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.get_target_id??"",disabled:t.applies_to_all||w==="loading",onChange:a=>d(s,{get_target_id:a.target.value}),children:[e.jsxs("option",{value:"",children:["Select ",t.get_target_type==="combo"?"Combo":"Attraction"]}),(t.get_target_type==="attraction"?o:g).map(a=>e.jsx("option",{value:a.id,children:a.title||a.name},`get-${a.id}`))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Get Discount Type"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.get_discount_type||"",onChange:a=>d(s,{get_discount_type:a.target.value}),children:[e.jsx("option",{value:"",children:"None / Free"}),e.jsx("option",{value:"percent",children:"Percentage (%)"}),e.jsx("option",{value:"amount",children:"Flat Amount"})]})]}),t.get_discount_type?e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Get Discount Value"}),e.jsx("input",{type:"number",min:0,className:"w-full rounded-md border px-3 py-2",value:t.get_discount_value??"",onChange:a=>d(s,{get_discount_value:a.target.value})})]}):null]}):null,e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Date From"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2",value:t.date_from||"",onChange:a=>d(s,{date_from:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Date To"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2",value:t.date_to||"",onChange:a=>d(s,{date_to:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Time From"}),e.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2",value:t.time_from||"",onChange:a=>d(s,{time_from:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Time To"}),e.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2",value:t.time_to||"",onChange:a=>d(s,{time_to:a.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Slot Type"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.slot_type||"",onChange:a=>d(s,{slot_type:a.target.value}),children:[e.jsx("option",{value:"",children:"—"}),e.jsx("option",{value:"attraction",children:"Attraction"}),e.jsx("option",{value:"combo",children:"Combo"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Slot ID"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2",value:t.slot_id??"",onChange:a=>d(s,{slot_id:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Priority"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2",value:t.priority??100,onChange:a=>d(s,{priority:a.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Rule Discount Type"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.rule_discount_type||"",onChange:a=>d(s,{rule_discount_type:a.target.value}),children:[e.jsx("option",{value:"",children:"Use Offer Default"},`__default-rule-discount-type-${s}__`),D.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs text-gray-500 mb-1",children:["Rule Discount Value ",e.jsx("span",{className:"text-xs text-blue-600",children:"(negative for price increase)"})]}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2",value:t.rule_discount_value??"",onChange:a=>d(s,{rule_discount_value:a.target.value}),placeholder:"Optional"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Day Type"}),e.jsxs("select",{className:"w-full rounded-md border px-3 py-2",value:t.day_type||"",onChange:a=>d(s,{day_type:a.target.value,specific_days:a.target.value==="custom"?[]:[],specific_dates:a.target.value==="holiday"?[]:t.specific_dates||[]}),children:[e.jsx("option",{value:"",children:"All Days"}),e.jsx("option",{value:"weekday",children:"Weekdays (Mon-Fri)"}),e.jsx("option",{value:"weekend",children:"Weekends (Sat-Sun)"}),e.jsx("option",{value:"holiday",children:"Holidays Only"}),e.jsx("option",{value:"custom",children:"Custom Days"})]})]}),t.day_type==="custom"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Select Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map((a,l)=>e.jsxs("label",{className:"flex items-center gap-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:(t.specific_days||[]).includes(l),onChange:b=>{const f=t.specific_days||[];b.target.checked?d(s,{specific_days:[...f,l]}):d(s,{specific_days:f.filter(h=>h!==l)})}}),a]},a))})]}),t.day_type==="holiday"&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Holiday Pricing"}),e.jsx("div",{className:"text-xs text-gray-600",children:"This rule will apply only to declared holidays"})]})]}),e.jsxs("div",{className:"border-t pt-3 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Add Specific Date"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2",value:t.next_specific_date||"",onChange:a=>d(s,{next_specific_date:a.target.value})})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{type:"button",className:"px-3 py-2 text-xs rounded-md border",disabled:!t.next_specific_date,onClick:()=>{if(!t.next_specific_date)return;const a=Array.isArray(t.specific_dates)?t.specific_dates:[];a.includes(t.next_specific_date)?d(s,{next_specific_date:""}):d(s,{specific_dates:[...a,t.next_specific_date].sort(),next_specific_date:""})},children:"Add Date"})}),e.jsx("div",{className:"text-xs text-gray-500",children:"Select one or more calendar dates. Rules targeting specific weekdays will still constrain these dates."})]}),Array.isArray(t.specific_dates)&&t.specific_dates.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Selected Dates"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.specific_dates.map(a=>e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-full",children:[new Date(a).toLocaleDateString(),e.jsx("button",{type:"button",className:"text-red-500",onClick:()=>{d(s,{specific_dates:t.specific_dates.filter(l=>l!==a)})},children:"×"})]},`${s}-date-${a}`))})]})]}),p.rule_type==="date_slot_pricing"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 border-t pt-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Specific Date"}),e.jsx("input",{type:"date",className:"w-full rounded-md border px-3 py-2",value:t.specific_date||"",onChange:a=>d(s,{specific_date:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Specific Slot Time"}),e.jsx("input",{type:"time",className:"w-full rounded-md border px-3 py-2",value:t.specific_time||"",onChange:a=>d(s,{specific_time:a.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Slot ID (Optional)"}),e.jsx("input",{type:"number",className:"w-full rounded-md border px-3 py-2",value:t.slot_id??"",onChange:a=>d(s,{slot_id:a.target.value}),placeholder:"Leave empty for all slots on this date/time"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("div",{className:"text-xs text-gray-600",children:"This rule will apply only to the specific date and time slot selected. If slot ID is provided, it will apply only to that specific slot."})})]})]},`rule-${s}`))})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{type:"submit",className:"rounded-md bg-gray-900 text-white px-4 py-2 text-sm",children:"Save"}),e.jsx("button",{type:"button",className:"rounded-md border px-4 py-2 text-sm",onClick:()=>_(-1),children:"Cancel"})]}),n.error?e.jsx("div",{className:"mt-2 text-sm text-red-600",children:((S=n.error)==null?void 0:S.message)||"Error"}):null]})}export{ie as default};
