import{R as n,j as e,A as w,C as N}from"./index-DpUnVvi7.js";import{a as h}from"./AdminApp-DElutmvv.js";import{I as _}from"./ImageUploader-8sQNEsRz.js";import{R as C,a as S,G as U}from"./GalleryField-C6Qb95Re.js";import{i as I}from"./media-CQLQFIy8.js";import{S as E}from"./SaveOverlay-YW_4J3BF.js";import"./createLucideIcon-DlloiUI2.js";import"./file-text-BcxeLTgw.js";import"./users-Dj4zQjFo.js";import"./newspaper-D6LH_a5a.js";import"./ticket-DJwTfedz.js";import"./chevron-down-BM4ufvPU.js";function $({label:y="Bulk Upload Images",value:o=[],onChange:s,folder:a="",maxFiles:u=10}){const j=n.useId(),[c,g]=n.useState([]),[x,r]=n.useState(!1),[m,b]=n.useState(o||[]);n.useEffect(()=>{b(o||[])},[o]);const t=d=>{const i=Array.from(d.target.files||[]);if(i.length+m.length>u){alert(`Maximum ${u} files allowed`);return}g(i)},l=async()=>{if(c.length){r(!0);try{const d=new FormData;c.forEach((v,B)=>{d.append("files",v)}),a&&d.append("folder",a);const k=(await h.post("/api/admin/uploads/bulk",d,{headers:{"Content-Type":"multipart/form-data"}})).urls||[],f=[...m,...k];b(f),s==null||s(f),g([])}catch(d){alert(d.message||"Upload failed")}finally{r(!1)}}},p=d=>{const i=m.filter((k,f)=>f!==d);b(i),s==null||s(i)};return e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm font-medium",children:y}),e.jsxs("div",{className:"rounded-lg border border-dashed dark:border-neutral-700 p-4",children:[e.jsx("input",{id:j,type:"file",accept:"image/*",multiple:!0,onChange:t,className:"sr-only"}),e.jsx("label",{htmlFor:j,className:"cursor-pointer",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-neutral-300",children:"Click to select multiple images or drag & drop"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Max ",u," files • Images only"]})]})}),c.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"text-sm text-gray-700 dark:text-neutral-300 mb-2",children:[c.length," file(s) selected"]}),e.jsx("button",{type:"button",onClick:l,disabled:x,className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm disabled:opacity-50",children:x?"Uploading...":"Upload All"})]})]}),m.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-sm font-medium",children:["Uploaded Images (",m.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:m.map((d,i)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:I(d),alt:`Upload ${i+1}`,className:"w-full h-20 object-cover rounded-md border"}),e.jsx("button",{type:"button",onClick:()=>p(i),className:"absolute top-1 right-1 bg-red-600 text-white rounded-full w-5 h-5 text-xs opacity-0 group-hover:opacity-100 transition-opacity",children:"×"})]},i))})]})]})}function K(){const y=w(),{id:o}=N(),s=!!o,[a,u]=n.useState({title:"",slug:"",author:"",active:!0,image_url:"",image_alt:"",editor_mode:"rich",content:"",raw_html:"",raw_css:"",raw_js:"",meta_title:"",meta_description:"",meta_keywords:"",section_type:"none",section_ref_id:null,gallery:[],bulk_images:[]}),[j,c]=n.useState(""),[g,x]=n.useState(!1);n.useEffect(()=>{s&&(async()=>{try{const t=await h.get(`/api/admin/blogs/${o}`);u(l=>({...l,...t,editor_mode:t.editor_mode||"rich"}))}catch(t){c(t.message||"Failed to load blog")}})()},[o,s]);const r=t=>u(l=>({...l,...t})),m=async t=>{t.preventDefault(),c(""),x(!0);try{const l={...a};s?await h.put(`/api/admin/blogs/${o}`,l):await h.post("/api/admin/blogs",l),y("/admin/catalog/blogs")}catch(l){c(l.message||"Save failed")}finally{x(!1)}},b=async()=>{try{const t=await h.post("/api/admin/blogs/preview",a),l=window.open("","_blank");if(!l)return;let p="";a.editor_mode==="raw"?p=`
<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<style>${a.raw_css||""}</style>
<title>${a.title||""}</title></head><body>
${a.raw_html||""}
<script>${a.raw_js||""}<\/script></body></html>`:p=`
<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>${a.title||""}</title></head><body>${a.content||""}</body></html>`,l.document.open(),l.document.write(p),l.document.close()}catch(t){alert(t.message||"Preview failed")}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-neutral-900 relative",children:[e.jsx(E,{visible:g,label:s?"Updating blog…":"Saving blog…"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsx("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-gray-200 dark:border-neutral-700 p-6 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-neutral-100",children:s?"Edit Blog Post":"Create New Blog Post"}),e.jsx("p",{className:"text-gray-600 dark:text-neutral-400 mt-1",children:s?"Update your blog post content and settings":"Create engaging content for your audience"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:b,className:"px-4 py-2 bg-gray-100 dark:bg-neutral-700 text-gray-700 dark:text-neutral-300 rounded-lg hover:bg-gray-200 dark:hover:bg-neutral-600 transition-colors",children:"Preview"}),e.jsx("button",{type:"button",onClick:()=>y("/admin/catalog/blogs"),className:"px-4 py-2 border border-gray-300 dark:border-neutral-600 text-gray-700 dark:text-neutral-300 rounded-lg hover:bg-gray-50 dark:hover:bg-neutral-700 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",form:"blog-form",disabled:g,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Saving...":"Save Blog"})]})]})}),e.jsxs("form",{id:"blog-form",onSubmit:m,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-gray-200 dark:border-neutral-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-neutral-100 mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Title *"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.title??"",onChange:t=>r({title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Slug *"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.slug??"",onChange:t=>r({slug:t.target.value}),placeholder:"my-awesome-blog-post"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Author"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.author??"",onChange:t=>r({author:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Featured Image"}),e.jsx(_,{value:a.image_url,onChange:t=>r({image_url:t}),altText:a.image_alt,onAltChange:t=>r({image_alt:t}),folder:"blogs"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"checkbox",checked:!!a.active,onChange:t=>r({active:t.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-neutral-300",children:"Publish immediately"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-gray-200 dark:border-neutral-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-neutral-100 mb-4",children:"Content"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:a.editor_mode==="rich",onChange:()=>r({editor_mode:"rich"}),className:"text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-neutral-300",children:"Rich Text Editor"})]}),e.jsxs("label",{className:"inline-flex items-center",children:[e.jsx("input",{type:"radio",checked:a.editor_mode==="raw",onChange:()=>r({editor_mode:"raw"}),className:"text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700 dark:text-neutral-300",children:"HTML/CSS/JS Editor"})]})]})}),a.editor_mode==="raw"?e.jsx(C,{value:{raw_html:a.raw_html,raw_css:a.raw_css,raw_js:a.raw_js},onChange:t=>r(t)}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Content"}),e.jsx(S,{value:a.content||"",onChange:t=>r({content:t}),gallery:a.bulk_images&&a.bulk_images.length?a.bulk_images:a.gallery})]}),e.jsx(U,{label:"Content Gallery",helper:"Upload multiple images to use within your blog post content.",value:a.gallery||[],onChange:t=>r({gallery:t})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-gray-200 dark:border-neutral-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-neutral-100 mb-4",children:"Bulk Image Upload"}),e.jsx($,{label:"Upload Multiple Images",value:a.bulk_images||[],onChange:t=>r({bulk_images:t}),folder:"blogs",maxFiles:20}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-neutral-400 mt-2",children:"Upload multiple images at once. These images will be available for use in your content editor."})]}),e.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-sm border border-gray-200 dark:border-neutral-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-neutral-100 mb-4",children:"SEO Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Meta Title"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.meta_title||"",onChange:t=>r({meta_title:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Meta Description"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.meta_description||"",onChange:t=>r({meta_description:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-neutral-300 mb-2",children:"Meta Keywords"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 dark:border-neutral-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-neutral-700 dark:text-neutral-100",value:a.meta_keywords||"",onChange:t=>r({meta_keywords:t.target.value})})]})]})]})]})]})]})}export{K as default};
